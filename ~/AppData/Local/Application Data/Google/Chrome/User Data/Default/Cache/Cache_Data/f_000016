(function(c){window.CTXS=window.CTXS||{};var f=0,b=[];CTXS.Category=function(a){if(!(this instanceof CTXS.Category))return new CTXS.Category(a);this.name=a;this.apps=[];this.index=f;b.push(this);if(this.name==CTXS.Category.CATEGORY_OTHER)this.pname=this.dname=null,this.fname="(Root)";else if(this.name==CTXS.Category.CATEGORY_FEATURED)this.fname=this.pname=this.dname=c.localization.string(this.name);else if(this.pname=this.name,a=this.name.indexOf("\\"),-1!=a){0===this.name.indexOf("\\")&&(this.name=
this.pname=this.name.replace(/\\/,c.localization.string("BlankFolder")+"\\"));if(-1<this.name.indexOf("\\\\")){var d="\\"+c.localization.string("BlankFolder")+"\\";this.name=this.pname=this.name.replace(/\\\\/g,d).replace(/\\\\/g,d)}this.dname=this.name.substring(0,a);a=this.name.lastIndexOf("\\");this.fname=this.name.substring(a+1)}else this.fname=this.dname=this.pname;f++};CTXS.Category_ByIndex=function(a){return b[a]};CTXS.Category.prototype={sortApps:function(){var a=this;CTXS.ExtensionsHead.sortCategoryAppList(this.apps,
this,function(){a.apps.sort(function(a,b){return a.name.localeCompare(b.name)})})},getDisplayName:function(){if(null==this.dname){var a=CTXS.Store.getCategorizedApps();this.pname=this.dname=null!=a.categories&&1<=a.categories.length?c.localization.string(CTXS.Category.CATEGORY_OTHER):c.localization.string(CTXS.Category.CATEGORY_ALLAPPS)}return this.dname},getDisplayPath:function(){null==this.pname&&this.getDisplayName();return this.pname},getDisplayFolderName:function(){return this.fname}};CTXS.Category.CATEGORY_FEATURED=
"Featured";CTXS.Category.CATEGORY_UPDATED="UpdatedCat";CTXS.Category.CATEGORY_UNCATEGORIZED="Uncategorized";CTXS.Category.CATEGORY_OTHER="Other";CTXS.Category.CATEGORY_ALLAPPS="AllApps"})(jQuery);
(function(c){function f(b){var a=b.path;return a&&"\\"!=a?(b="\\"==a.charAt(0)?a.substring(1,a.length):a,"\\"==b[b.length-1]?b.substring(0,b.length-1):b):b.recommended?CTXS.Category.CATEGORY_FEATURED:CTXS.Category.CATEGORY_OTHER}window.CTXS=window.CTXS||{};CTXS.App=function(b,a){if(!(this instanceof CTXS.App))return new CTXS.App(b,a);c.extend(this,b);this.store=a;this.subscriptionstatus||(this.subscriptionstatus=CTXS.SUBSCRIPTION_STATUS.NOTSUBSCRIBED);this.iconid||(this.iconid=CTXS.getIconId(this.iconurl));
this.encodedName=CTXS.encodeHtmlForAttr(this.name);this.encodedDescription=CTXS.encodeHtmlForAttr(this.description);var d=CTXS.AppSearch.normalizeText((" "+(this.name||"")+" "+(this.description||"")+" "+(this.path||"")).toLowerCase());this.playsfiletypes&&c.each(this.playsfiletypes,function(){d+=" "+this.fileextensions.join(" ").toLowerCase()});this.tag=d;this.category=f(this);this.supportsSubscription=!!this.subscriptionurl||"PNA"==this.store.type;this.supportsStandardInstallation=!!this.mobileinstallurl;
this.supportsItmsInstallation=!!this.mamdownloadurl;this.supportsIcaLaunch=-1!=c.inArray("ica30",this.clienttypes);this.isAndroidApp=this.isiosApp=this.ismobileapp=this.isNewInstall=this.isInstallInProgress=this.isAddInProgress=this.isLaunchInProgress=!1;if(this.clienttypes)for(var e=0;e<this.clienttypes.length;e++)"application/ios"===this.clienttypes[e]?(this.isiosApp=this.ismobileapp=!0,this.isAndroidApp=!1):"application/android"===this.clienttypes[e]&&(this.isAndroidApp=this.ismobileapp=!0,this.isiosApp=
!1);if(this.properties&&this.ismobileapp){var k=this;c.each(this.properties,function(a,b){"MamDownloadURL"===b.name?(k.mamdownloadurl=b.values[0],k.supportsItmsInstallation=!!k.mamdownloadurl):"mobileinstallurl"===b.name&&(k.mobileinstallurl=b.values[0],k.supportsStandardInstallation=!!k.mobileinstallurl)})}if(c.isArray(this.subscriptionproperties)){for(var e={},h=0;h<this.subscriptionproperties.length;h++){var g=this.subscriptionproperties[h].name;if("position"!=g&&"dazzle:position"!=g){var l=this.subscriptionproperties[h].values;
null!=l&&(e[g]=1==l.length?l[0]:1<l.length?l:!0)}}this.subscriptionproperties=e}};CTXS.App.prototype={getState:function(){var b=CTXS.Environment.treatAsAdded(this);return this.upgrade?CTXS.App.State.UPGRADEABLE:b?CTXS.App.State.ADDED:this.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.PENDING?CTXS.App.State.PENDING:this.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.APPROVED?CTXS.App.State.APPROVED:this.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.DENIED?CTXS.App.State.DENIED:this.requiresworkflow?CTXS.App.State.REQUESTABLE:
CTXS.App.State.AVAILABLE},getInstallationState:function(){return this.supportsInstall()?this.installed?CTXS.App.InstallState.INSTALLED:this.isInstallInProgress?CTXS.App.InstallState.INSTALLING:CTXS.App.InstallState.NEEDS_INSTALL:CTXS.App.InstallState.NOT_INSTALLABLE},markAsInstalled:function(){this.supportsInstall()&&(this.installed=this.isNewInstall=!0);this.upgrade&&(this.upgraded=!0);this.isInstallInProgress=this.upgrade=!1},markAsAdded:function(){this.isAddInProgress=!1},supportsInstall:function(){return this.supportsStandardInstallation||
this.supportsItmsInstallation},canOpen:function(){return!0!=this.requiresworkflow||this.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED},canBeRemoved:function(){var b=this.getState();return b!=CTXS.App.State.ADDED&&b!=CTXS.App.State.UPGRADEABLE||!this.supportsSubscription||this.mandatory?!1:!0},canBeRequested:function(){return this.getState()==CTXS.App.State.REQUESTABLE&&this.supportsSubscription&&!this.mandatory?!0:!1},canCancelRequest:function(){var b=this.getState();return b==CTXS.App.State.PENDING||
b==CTXS.App.State.DENIED?!0:!1},canBeAdded:function(){var b=this.getState();return b!=CTXS.App.State.AVAILABLE&&b!=CTXS.App.State.APPROVED&&b!=CTXS.App.State.UPGRADEABLE||!this.supportsSubscription||this.mandatory?!1:!0}};CTXS.App.State={AVAILABLE:"available",PENDING:"pending",APPROVED:"approved",DENIED:"denied",ADDED:"added",UPGRADEABLE:"upgradeable",REQUESTABLE:"requestable"};CTXS.App.InstallState={NOT_INSTALLABLE:"noinstall",NEEDS_INSTALL:"needsinstall",INSTALLING:"installing",INSTALLED:"installed"}})(jQuery);
var html5LaunchData={};
(function(c){function f(a){return a==CTXS.LaunchMethod.HTML5&&("true"==CTXS.Config.getConfigValue("pluginAssistant.html5.singleTabLaunch")||CTXS.AppShortcuts.isAppShortcutLaunch())}function b(a){CTXS.ResourcesClient.preLaunch(a,function(b){var d=b.url;if("success"==b.status&&d){if(b=CTXS.getCSRFToken())d=CTXS.updateQueryString(d,"CsrfToken",b),d=CTXS.updateQueryString(d,"IsUsingHttps",CTXS.isUsingHttps());window.open(d);g(a,CTXS.LAUNCH_SUCCESS)}else g(a,CTXS.LAUNCH_FAILURE)},function(){g(a,CTXS.LAUNCH_FAILURE)})}
function a(b,c){function e(l,k,f){if(f.getResponseHeader(CTXS.CHALLENGE_HEADER))CTXS.trace("prepareLaunch: challenged"),CTXS.Authentication.isUserAuthenticated()&&(h(b,"Unauthorized",!1,c),CTXS.Events.publish(CTXS.Events.resources.challenged));else switch(l.status){case "success":b.delayedLaunchInProgress=!1;k={};CTXS.Device.isIE()&&CTXS.ClientManager.usingNativeClientInInternetZone()?(g(b,CTXS.LAUNCH_SUCCESS),g(b,CTXS.LAUNCH_READY),b.isLaunchReady=!0):(CTXS.ClientManager.getLaunchMethod()==CTXS.LaunchMethod.PROTOCOL_HANDLER&&
(k.ticket=l.fileFetchTicket,k.staTicket=l.fileFetchStaTicket,k.fileFetchUrl=l.fileFetchUrl,k.serverProtocolVersion=l.serverProtocolVersion),d(b,c,k));break;case "retry":b.delayedLaunchInProgress=!0;setTimeout(function(){a(b,c)},1E3*l.pollTimeout);break;default:CTXS.trace("prepareLaunch: unexpected response from launchStatus page"),h(b,l.errorId,l.suggestRestart,c)}}function l(a,d){CTXS.trace("errorHandler: failed to download launchStatus page, HTTP status: "+a.status);a.getResponseHeader(CTXS.CHALLENGE_HEADER)&&
(CTXS.trace("prepareLaunch: challenged"),CTXS.Authentication.isUserAuthenticated()&&(h(b,"Unauthorized",!1,c),CTXS.Events.publish(CTXS.Events.resources.challenged)))}if(CTXS.ResourcesClient){b.launchstatusurl||(b.launchstatusurl=b.launchurl.replace("/LaunchIca/","/GetLaunchStatus/").replace("/Launch/","/GetLaunchStatus/"));var k=CTXS.ClientManager.getLaunchMethod()==CTXS.LaunchMethod.PROTOCOL_HANDLER;CTXS.ResourcesClient.getLaunchStatus(b,k,e,l)}}function d(a,b,d){var h=CTXS.ClientManager.getLaunchMethod(),
u=1E3*CTXS.Config.getConfigValue("userInterface.multiClickTimeout");setTimeout(function(){a.delayedLaunchInProgress||h==CTXS.LaunchMethod.ICA_FILE&&!a.icaFileLaunchInProgress||(a.icaFileLaunchInProgress=!1,g(a,CTXS.LAUNCH_SUCCESS))},u);var u=a.store.baseUrl+a.launchurl,y=CTXS.getCSRFToken(),s=(new Date).getTime();null!=y&&(u=CTXS.updateQueryString(u,"CsrfToken",y),u=CTXS.updateQueryString(u,"IsUsingHttps",CTXS.isUsingHttps()));CTXS.Events.publish(CTXS.Events.session.refreshed);switch(h){case CTXS.LaunchMethod.HTML5:d=
CTXS.primaryStore.baseUrl+CTXS.Config.getConfigValue("pluginAssistant.html5.launchURL")+"?launchid="+s;var r=c.globalization.currentCulture().name,E=null;if(!CTXS.Device.isCitrixChromeApp())if(f(h)){d=d+"#launchurl="+encodeURIComponent(a.store.baseUrl+a.launchurl)+"&iconurl="+encodeURIComponent(CTXS.IconsLoader.getIcon(a).url)+"&clientpreferences="+encodeURIComponent(CTXS.Config.getConfigValue("pluginAssistant.html5.preferences"))+"&resourcename="+encodeURIComponent(a.displayNameDesktopTitle||a.encodedName)+
"&resourcetype="+(a.isdesktop?"desktop":"app")+"&UILocale="+r;window.name=CTXS.getCSRFToken();window.location=d;break}else E=window.open(d);CTXS.ResourcesClient.launchResource(a,!0,function(d){CTXS.trace("success handler for HTML5 launch, ajax launch data="+d);var c=l(d);c.IconUrl=CTXS.IconsLoader.getIcon(a).url;c.clientPreferences=CTXS.Config.getConfigValue("pluginAssistant.html5.preferences");c.UILocale=r;var g=new Image;g.onload=function(){var d=document.createElement("canvas"),e=d.getContext("2d");
d.height=g.height;d.width=g.width;e.drawImage(g,0,0);d=d.toDataURL();c.IconUrl=d;html5LaunchData[s]=c;CTXS.Device.isCitrixChromeApp()?CTXS.Html5Client.postICADataToChromeApp(c,a,b):(E.iconUrl=CTXS.IconsLoader.getIcon(a).url,E.icaDwldComplete=!0)};g.src=CTXS.IconsLoader.getIcon(a).url},E,b);break;case CTXS.LaunchMethod.ICO:CTXS.Application.$hiddenFrame.append('<object id="icaobj_'+s+'" classid="clsid:238f6f83-b8b4-11cf-8771-00a024541ee3"><p>'+c.localization.string("ApplicationLaunchPlugin")+'</p><param name="Launch" value= "true"><param name="Start" value= "true"><param name="IPCLaunch" value="false"><param name="ICAfile"  value="'+
u+'"></object>');break;case CTXS.LaunchMethod.ICA_FILE:a.displayNameDesktopTitle&&(u=CTXS.updateQueryString(u,"displayNameDesktopTitle",encodeURIComponent(a.displayNameDesktopTitle)));CTXS.Environment.launchViaIcaUrl(a,u,e)||(a.icaFileLaunchInProgress=!0,d="launchframe_"+s,CTXS.Application.$hiddenFrame.append('<iframe id="'+d+'" name="'+d+'"></iframe>'),c("#"+d).on("load",function(){var b=c(this).contents().text();b&&k(b,a)}),u=CTXS.updateQueryString(u,"launchId",s),c("#"+d).attr("src",u));break;
case CTXS.LaunchMethod.PROTOCOL_HANDLER:var y=0==d.fileFetchUrl.indexOf("https")?"https":"http",u=d.fileFetchUrl.replace(/^https?:/,"receiver:"),A="";d.staTicket&&(A="&staTicket={0}".format(encodeURIComponent(d.staTicket)));d="action=launch&serverProtocolVersion={0}&transport={1}&ticket={2}{3}".format(encodeURIComponent(d.serverProtocolVersion),encodeURIComponent(y),encodeURIComponent(d.ticket),A);u=u+"/"+CTXS.urlSafeBase64Encode(d);CTXS.trace("Protocol handler parameter block: "+d);CTXS.trace("Invoking protocol handler with url: "+
u);c("#protocolhandler-invoker").attr("href",u);document.getElementById("protocolhandler-invoker").click()}}function e(a,b,d){"unauthorized"==b?CTXS.Events.publish(CTXS.Events.resources.challenged):"failure"==b?h(a,null,null):"json"==b&&k(d,a)}function k(b,d){var c=!1,e=null,l=null,k=!1,f="failure",r;if(r=JSON.parse(b))c=r.unauthorized,f=r.status,l=r.pollTimeout,e=r.errorId,k=r.suggestRestart;c?CTXS.Events.publish(CTXS.Events.resources.challenged):"failure"==f?h(d,e,k):"retry"==f&&(c=1E3*parseInt(l,
10),d.delayedLaunchInProgress=!0,g(d,CTXS.LAUNCH_STARTING),setTimeout(function(){a(d)},c))}function h(a,b,d,c){a.delayedLaunchInProgress=!1;a.icaFileLaunchInProgress=!1;d={errorId:b,suggestRestart:d,chromeAppOptions:c};CTXS.Device.isCitrixChromeApp()&&c&&CTXS.Html5Client.postICADataErrorToChromeApp(b,a,c.uniqueIdentifier);g(a,CTXS.LAUNCH_FAILURE,d)}function g(a,b,d){CTXS.Events.publish(CTXS.Events.resources.launchStatus,{status:b,res:a,details:d})}function l(a){a=a.split(/\r?\n/);for(var b={},d={},
c,g,e=new RegExp(/^\s*(\[.*\])\s*$/),l=0;l<a.length;l++){var h=e.exec(a[l]);h&&(c=h[1]);var h=a[l].split("="),k=a[l].indexOf("=");2<h.length&&(k=a[l].substr(k+1),h[1]=k,h=h.slice(0,2));2===h.length&&(k=h[0],h=h[1],"[ApplicationServers]"===c&&(g="["+k+"]"),d[k]&&c!=g||(b[k]=h,d[k]=1))}return b}window.CTXS=c.extend(window.CTXS||{},{LAUNCH_STARTING:0,LAUNCH_SUCCESS:1,LAUNCH_READY:2,LAUNCH_FAILURE:3});CTXS.Events.subscribe(CTXS.Events.resources.launchStatus,function(a,b){if(b.status==CTXS.LAUNCH_FAILURE){var d,
g=b.res.displayNameDesktopTitle||b.res.encodedName;d=b.res.isdesktop?b.details&&"true"==b.details.suggestRestart&&b.res.poweroffurl?"CannotStartDesktopSuggestRestart":b.details&&"WorkstationInMaintenance"==b.details.errorId?"DesktopInMaintenance":"CannotStartDesktop":b.res.issession?"SessionsListFailure":b.details&&"WorkstationInMaintenance"==b.details.errorId?"AppInMaintenance":"CannotStartApp";b.details&&b.details.chromeAppOptions||CTXS.Environment.showDialog({messageText:c.localization.string(d,
g),id:d,resource:b.res})}});CTXS.canBrowserLaunchDocument=function(){return!0};CTXS.launchResource=function(c,e,h){g(c,CTXS.LAUNCH_STARTING);c.isLaunchInProgress=!0;c.isLaunchReady=!1;if(c.content&&CTXS.canBrowserLaunchDocument(c.content))c.prelaunchurl?b(c):(CTXS.Environment.openUrl(c.content),g(c,CTXS.LAUNCH_SUCCESS));else{CTXS.trace("_launch: launchurl="+c.launchurl);var l=CTXS.ClientManager.getLaunchMethod();CTXS.Device.isIE()&&l==CTXS.LaunchMethod.ICA_FILE&&!e||l==CTXS.LaunchMethod.HTML5&&!f(l)&&
!CTXS.Device.isCitrixChromeApp()?d(c):a(c,h)}};CTXS.Events.subscribe(CTXS.Events.resources.powerOffStatus,function(a,b){b.status==CTXS.POWEROFF_SUCCESS?CTXS.Store.launchApp(b.desktop):b.status==CTXS.POWEROFF_FAILURE&&"operation-in-progress"!=b.errorId&&("no-machine"==b.errorId?CTXS.Store.launchApp(b.desktop):CTXS.Environment.showDialog({messageText:c.localization.string("in-maintenance-mode"==b.errorId?"DesktopInMaintenance":"CannotRestartDesktop",b.desktop.displayNameDesktopTitle),id:"PowerOffError"}))});
CTXS.promptForRestartDesktop=function(a){CTXS.Environment.showDialog({messageTitle:c.localization.string("DesktopRestartWarningTitle").format(a.displayNameDesktopTitle),messageText:c.localization.string("DesktopRestartWarningText"),buttonLabel:c.localization.string("Restart"),buttonAction:function(){CTXS.restartDesktop(a)},cancelButtonLabel:c.localization.string("Cancel"),cancelButtonAction:c.noop,id:"DesktopRestart"})};CTXS.restartDesktop=function(a){var b=a.poweroffurl;b&&(CTXS.Events.publish(CTXS.Events.resources.powerOffStatus,
{status:CTXS.POWEROFF_STARTING,desktop:a}),CTXS.ResourcesClient.powerOffDesktop(b,a))};c.prepareLaunch=a;c.performLaunch=d;CTXS.setLaunchStatus=g})(jQuery);
(function(c){function f(a,b){if(a){var d=c.inArray(b,a);-1!=d&&a.splice(d,1)}}function b(b,d,g){var e=0,l=0;g=g?{}:H.categories;CTXS.ExtensionsHead.noteStartLoadApps(d);CTXS.trace("store-load Apps. length="+b.length);CTXS.trace("highestknown="+B);M=1E3;for(var k=0,v=b.length;k<v;k++){var f=new CTXS.App(b[k],d);f.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED&&f.position&&0<CTXS.OrderMarker.compare(f.position,B)&&(B=f.position);if(u(f)){f.shortid=M++;f.recommended&&(f.keywords||(f.keywords=
[]),f.keywords.push("Featured"));CTXS.ExtensionsHead.noteApp(f);var n=f,y=g,s=y[n.category];if(!s){var r=void 0;for(r in y)if(y[r].dname==n.category){s=y[r];break}}s||(s=new CTXS.Category(n.category),y[n.category]=s);n.isdesktop||s.apps.push(n);4<=f.rating&&aa.push(f);f.recommended&&ha.push(f);m(f);p[f.shortid]=f;f.getState()==CTXS.App.State.UPGRADEABLE&&ia.push(f);f.isdesktop?J.push(f):t.push(f);f.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.APPROVED?X.push(f):f.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.DENIED&&
U.push(f);f.mandatory&&e++;f.subscriptionurl||l++}}b=0;d=[];for(b=0;b<N.length;b++)null!=N[b].apps&&(CTXS.ExtensionsHead.sortBundleAppList(N[b].apps,N[b],h(N[b].apps)),d.push(N[b]));N=d;H=G(g);a(t);a(J);g=J;b=[];for(d=0;d<g.length;d++)void 0===b[g[d].name]?b[g[d].name]=1:b[g[d].name]++;for(d=0;d<g.length;d++)g[d].hasParenthesis=1<b[g[d].name]?!0:!1;for(d=g.length-1;0<=d;d--)g[d].displayNameDesktopTitle=g[d].hasParenthesis?g[d].encodedName+" ("+b[g[d].name]--+")":g[d].encodedName;g=t.length+J.length;
Y=l===g||e===g?S=!1:S=!0;ba=t.slice();CTXS.ExtensionsHead.filterAllAppsDisplay(ba,c.noop);CTXS.ExtensionsHead.filterDesktops(J,h(J))}function a(a){a.sort(function(a,b){return null==a?null==b?0:1:null==b?-1:a.name.localeCompare(b.name)});for(var b=a.length;0<b&&null==a[b-1];)b--;b!=a.length&&a.splice(b,a.length-b)}function d(){var a=H.root;if(null!=a)return a;var a=H.uncategorized?H.uncategorized:new CTXS.Category(CTXS.Category.CATEGORY_OTHER),b=H.categories,d;for(d in b)if(b.hasOwnProperty(d)&&d!=
CTXS.Category.CATEGORY_OTHER)for(var c=b[d],g=c.getDisplayPath(),l=null,h=a;;){h.subcategories||(h.subcategories={});var m=g.indexOf("\\");if(-1==m){h.subcategories[g]=c;c.parentCategory=h;break}var k=g.substring(0,m),g=g.substring(m+1),m=h.subcategories[k],l=null==l?k:l+"\\"+k;null==m&&(m=new CTXS.Category(l),h.subcategories[k]=m,m.parentCategory=h);h=m}e(a);return H.root=a}function e(a){var b=null==a.apps?0:a.apps.length,d;for(d in a.subcategories)b+=e(a.subcategories[d]);return a.count=b}function k(a,
b){return a.name.localeCompare(b.name)}function h(a){return function(){a.sort(k)}}function g(a,b){var d=jQuery.grep(b.apps,function(b){return b.id==a.id});return d&&0==d.length?!1:!0}function l(){return 0<V.length}function m(a){if(N){var b;for(b=0;b<N.length;b++){var d=N[b],c=!1;if(d.categories)c=CTXS.appMatchesBundleByCategory(a,d);else if(d.keywords){var c=d,e=a,l=!1;if(null!=e.keywords)for(var h=0;h<c.keywords.length;h++){for(var m=c.keywords[h],k=0;k<e.keywords.length;k++){var v=e.keywords[k];
if(m.toUpperCase()==v.toUpperCase()){l=!0;break}}if(l)break}c=l}else if(d.appnames){c=d;e=" "+a.name+" ";l=!1;for(h=0;h<c.appnames.length;h++)if(-1!=e.toUpperCase().indexOf(" "+c.appnames[h].toUpperCase()+" ")){l=!0;break}c=l}c&&(null==d.apps&&(d.apps=[]),g(a,d)||d.apps.push(a))}}}function v(a){if(N){var b;for(b=0;b<N.length;b++)f(N[b].apps,a)}}function n(a){for(var b in H.categoryMap)if(H.categoryMap[b].dname==a.category){f(H.categoryMap[b].apps,a);break}f(H.uncategorized,a);f(H.featured,a)}function G(a){var b=
{featured:null,uncategorized:null,categories:[],categoryCount:0,categoryMap:{},categoryIdMap:{}},d;for(d in a)if(a.hasOwnProperty(d)){var c=a[d];0!=c.apps.length&&(c.sortApps(),c.name==CTXS.Category.CATEGORY_FEATURED?b.featured=c:c.name==CTXS.Category.CATEGORY_OTHER?b.uncategorized=c:(b.categories.push(c),b.categoryMap[d]=c,b.categoryIdMap[c.index]=c),b.categoryCount++)}b.categories.sort(function(a,b){return a.name.localeCompare(b.name)});return b}function u(a){if(CTXS.ExtensionsHead.excludeApp(a))return!1;
if(CTXS.ExtensionsHead.includeApp(a))return!0;if(!CTXS.Environment.includeAppInStore(a))return!1;var b;a.keywords?CTXS.isFilesTabEnabled()&&CTXS.caseInsensitiveInArray(w,a.keywords)?(V.push(a),b=!0):b=!1:b=!1;if(b)return!1;b=!D&&a.requiresworkflow&&a.subscriptionstatus!=CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED;var d=a.isdesktop&&!Z||!a.isdesktop&&!q;return!(a.disabled||a.notsupport||b||d)}function y(a,b){if(!S)return[];var d=[];a||(d=s(J,d));b||(d=s(t,d));return d}function s(a,b){for(var d=[],c=0;c<a.length;c++){var g=
a[c],e=!1;if(CTXS.ExtensionsHead.excludeFromMyApps(g))e=!1;else if(CTXS.ExtensionsHead.includeInMyApps(g))e=!0;else{var h=g.getState();if(h==CTXS.App.State.ADDED||h==CTXS.App.State.UPGRADEABLE||h==CTXS.App.State.PENDING||h==CTXS.App.State.APPROVED)e=!0}e&&(g.position=g.position||CTXS.OrderMarker.zero,d.push(g))}CTXS.ExtensionsHead.sortMyAppList(d,function(){d.sort(function(a,b){return CTXS.OrderMarker.compare(a.position,b.position)})});return b.concat(d)}function r(){return B=CTXS.OrderMarker.getNext(B)}
function E(a){return a.supportsSubscription&&(a.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.NOTSUBSCRIBED||a.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.APPROVED)}function A(a){if(a.canBeAdded()||a.canBeRequested()){var b=E(a),d=function(){a.isAddInProgress=!0;CTXS.Events.publish(CTXS.Events.store.appAddStarting,a);b?(O(a),CTXS.ExtensionsHead.postSubscribe(a)):(z(a),CTXS.ExtensionsHead.postInstall(a))};b?CTXS.ExtensionsHead.doSubscribe(a,d):CTXS.ExtensionsHead.doInstall(a,d);CTXS.Events.publish(CTXS.Events.store.appStatusChange,
a)}}function O(a){a.position||(a.position=r());CTXS.Environment.goOnline(a.store,function(){CTXS.Environment.performSubscribe(a,function(b){F(a,b);a.modified=!0;CTXS.Environment.updateOfflineCache(a.store)})},function(){F(a,CTXS.SUBSCRIPTION_FAILURE)})}function F(a,b){if(b==CTXS.SUBSCRIPTION_SUCCESS)z(a);else if(b==CTXS.SUBSCRIPTION_FAILURE)a.isAddInProgress=!1,CTXS.Events.publish(CTXS.Events.store.appAddFailure,a);else if(b==CTXS.SUBSCRIPTION_PENDING||b==CTXS.SUBSCRIPTION_SILENTFAILURE)a.isAddInProgress=
!1,CTXS.Events.publish(CTXS.Events.store.appStatusChange,a)}function z(a){a.markAsAdded();CTXS.Events.publish(CTXS.Events.store.appStatusChange,a);a.ismobileapp||CTXS.Environment.installApp(a,function(b){switch(b){case CTXS.SUCCESS:a.markAsAdded();CTXS.Events.publish(CTXS.Events.store.appStatusChange,a);break;case CTXS.FAILURE:a.isAddInProgress=!1;CTXS.Events.publish(CTXS.Events.store.appAddFailure,a);break;default:a.isAddInProgress=!1,CTXS.Events.publish(CTXS.Events.store.appStatusChange,a)}})}function x(a){a.getState()==
CTXS.App.State.DENIED&&CTXS.Environment.goOnline(a.store,function(){a.isRemoveInProgress=!0;CTXS.Environment.performUnsubscribe(a,function(b){C(a,b);a.modified=!0;CTXS.Environment.updateOfflineCache(a.store)})},function(){C(a,CTXS.SUBSCRIPTION_FAILURE)})}function C(a,b){a.isRemoveInProgress=!1;b==CTXS.SUBSCRIPTION_FAILURE?CTXS.Events.publish(CTXS.Events.store.appRevertFailure,a):CTXS.Events.publish(CTXS.Events.store.appStatusChange,a)}function I(a,b){CTXS.ExtensionsHead.doLaunch(a,function(){a.isLaunchInProgress=
!0;CTXS.Environment.launchApp(a,b)})}function Q(a,b){var d=b.res;b.status!=CTXS.LAUNCH_STARTING&&(d.isLaunchInProgress=!1);CTXS.ExtensionsHead.postLaunch(d,b.status)}function P(a){CTXS.trace("CTXS.Store.setUserDisplayName: called with display name: "+a);CTXS.UserInfo.setName(a);CTXS.Events.publish(CTXS.Events.resources.userDisplayNameSupplied,a)}var D=!1,B=CTXS.OrderMarker.zero,q=!0,Z=!0,t=[],ba=null,H,X=[],fa="default",U=[],ia=[],N=[],ha=[],W=[],aa=[],J=[],V=[],w="sharefileui",p={},M=1E3,Y=!0,S=
!0,K;window.CTXS=window.CTXS||{};CTXS.Store={patch:function(a){eval(a)},initialise:function(a,d){q="true"==CTXS.Config.getConfigValue("userInterface.uiViews.showAppsView");Z="true"==CTXS.Config.getConfigValue("userInterface.uiViews.showDesktopsView");q||Z||(Z=q=!0);CTXS.Events.subscribe(CTXS.Events.resources.launchStatus,Q);K=a.isUnauthenticatedStore;D=a.isSubscriptionEnabled;null!=a.view&&(fa=a.view);a.bundles&&(W=a.bundles);N=W;b(a.resources,d,!0);var c=this;CTXS.Environment.getInstalledApps(d,
function(){CTXS.Events.publish(CTXS.Events.store.initialised,c)})},addSecondaryStore:function(a,d){D|=d.subscriptionsEnabled;N=W;b(d.resources,a,!1);CTXS.Environment.getInstalledApps(a,function(){CTXS.Controllers.ViewController.changeView(CTXS.currentView)})},getResourceById:function(a){var b;b=null;for(var d=0;d<t.length;d++){var c=t[d];c.id==a&&(b=c)}if(null!==b)return b;a:{for(b=0;b<J.length;b++)if(d=J[b],d.id===a){a=d;break a}a=null}return a},getAllApps:function(){return t},getAllAppsForDisplay:function(){return ba?
ba:t},getCategorizedApps:function(){return H},getCategoryHierarchyForApps:function(){var a=d(),b=[],g=a.subcategories,e;for(e in g)g.hasOwnProperty(e)&&b.push(g[e]);0<a.apps.length&&0<b.length&&(g=c.extend(!0,{},a),g.subcategories=null,g.name=CTXS.Category.CATEGORY_UNCATEGORIZED,g.dname=g.fname=g.pname=c.localization.string(CTXS.Category.CATEGORY_UNCATEGORIZED),g.parentCategory=a,g.count=g.apps.length,b.push(g));return b},getAppHierachy:d,getWorkflowApprovedApps:function(){return X},getWorkflowDeniedApps:function(){return U},
getUpgradeApps:function(){return ia},getMyApps:y,getApplicationBundles:function(){return N},getTopRated:function(){return aa},getAppByShortId:function(a){return p[a]},isSubscriptionEnabled:function(){return D},isSubscriptionRequired:E,addApp:A,removeApp:function(a){CTXS.ExtensionsHead.doRemove(a,function(){a.isRemoveInProgress=!0;CTXS.Events.publish(CTXS.Events.store.appRemoveStarting,a);CTXS.Environment.removeApp(a,function(b){C(a,b);a.modified=!0;CTXS.Environment.updateOfflineCache(a.store);CTXS.ExtensionsHead.postRemove(a,
b)})});CTXS.Events.publish(CTXS.Events.store.appStatusChange,a)},revertApp:x,addApprovedApps:function(){for(var a=0,b=X.length;a<b;a++)A(X[a]);X=[]},revertDeniedApps:function(){for(var a=0,b=U.length;a<b;a++)x(U[a]);U=[]},launchApp:function(a,b){a.isLaunchInProgress||(a.assigndesktopurl&&!CTXS.ClientManager.usingNativeClientInInternetZone()?(CTXS.Events.publish(CTXS.Events.resources.launchStatus,{status:CTXS.LAUNCH_STARTING,res:a}),CTXS.ResourcesClient.assignDesktop(a,function(){CTXS.Events.publish(CTXS.Events.resources.desktopAssigned,
a);I(a,b)},function(){I(a,b)})):I(a,b))},installApp:function(a,b){a.isInstallInProgress||(a.isInstallInProgress=!0,CTXS.Events.publish(CTXS.Events.store.appInstallStarting,a),CTXS.Environment.installApp(a,function(d){switch(d){case CTXS.SUCCESS:a.markAsInstalled();b&&b();CTXS.Events.publish(CTXS.Events.store.appStatusChange,a);break;case CTXS.FAILURE:a.isInstallInProgress=!1;CTXS.Events.publish(CTXS.Events.store.appAddFailure,a);break;default:a.isInstallInProgress=!1,CTXS.Events.publish(CTXS.Events.store.appStatusChange,
a)}}))},searchForApps:function(a){return CTXS.AppSearch.searchForApps(a,t)},searchForDesktops:function(a){return CTXS.AppSearch.searchForApps(a,J)},searchForMyApps:function(a){return CTXS.AppSearch.searchForApps(a,y())},searchForUnfavoritedApps:function(a){return CTXS.AppSearch.searchForApps(a,t,y())},searchForUnfavoritedDesktops:function(a){return CTXS.AppSearch.searchForApps(a,J,y())},getResourceByName:function(a){var b;a:{for(b=0;b<t.length;b++){var d=t[b];if(d.name===a){b=d;break a}}b=null}if(null!==
b)return b;a:{for(b=0;b<J.length;b++)if(d=J[b],d.name===a){a=d;break a}a=null}return a},getView:function(){return fa},getDesktops:function(){return J},getAppInfo:function(a,b,d){CTXS.ResourcesClient.getAppInfo(a,function(d){d&&(a.info=d);b()},d)},updateAppPosition:function(a,b,d,c){var g=p[a],e=g.position;a=p[b];d=p[d];a=a?a.position:CTXS.OrderMarker.zero;d=d?d.position:-1;g.position=-1===d?r():CTXS.OrderMarker.getBetween(a,d);CTXS.Environment.performUpdatePosition(g,function(a){a==CTXS.SUBSCRIPTION_FAILURE||
a==CTXS.SUBSCRIPTION_SILENTFAILURE?g.position=e:(g.modified=!0,CTXS.Environment.updateOfflineCache(g.store));c(a)})},getRecommendedApps:function(){return ha},refreshStore:function(a,d,c){var g;CTXS.trace("refresh");D|=d.subscriptionsEnabled;H.root=null;if(a==CTXS.primaryStore&&d.bundles&&(W=d.bundles))for(g=0;g<t.length;g++)t[g].store!=a&&m(t[g]);N=W;for(g=0;g<t.length;g++)if(t[g]&&t[g].store==a){var e=t[g];t[g]=null;delete p[e.shortid];n(e);v(e);f(aa,e);f(ha,e);f(X,e);f(U,e)}for(g=0;g<J.length;g++)J[g]&&
J[g].store==a&&(e=J[g],J[g]=null,delete p[e.shortid]);for(g=0;g<V.length;g++)V[g]&&V[g].store==a&&(e=V[g],V[g]=null,delete p[e.shortid]);b(d.resources,a,!1);CTXS.Environment.getInstalledApps(a,function(){CTXS.trace("post refresh");CTXS.Controllers.ViewController.changeView(CTXS.currentView);c()})},canReorderApps:function(){return Y},isSelfServiceEnabled:function(){return S},isUnauthenticatedStore:function(){return K},loadUserDisplayName:function(){K||CTXS.Environment.getUserDisplayName(P)},setUserDisplayName:P,
isFolderViewEnabled:function(){return"true"===CTXS.Config.getConfigValue("userInterface.enableAppsFolderView")},canAutoLaunchSingleDesktop:function(){var a="true"==CTXS.Config.getConfigValue("userInterface.autoLaunchDesktop"),b=!CTXS.ClientManager.usingNativeClientInInternetZone(),d=1===J.length&&!J[0].disabled,c=CTXS.AppShortcuts.isAppShortcutLaunch(),g=CTXS.ClientManager.isPassThroughSession();return a&&b&&d&&!g&&!c},requiresReceiver:function(){var a=function(a){return a.supportsIcaLaunch},b=0<
c.grep(t,a).length,a=0<c.grep(J,a).length;return b||a},countAppsForCategoryNode:e,doFilesExist:l,getFilesLink:function(){return CTXS.isFilesTabEnabled()&&l()?V[0].content:!1}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};var f={onClose:function(){},getActiveDetails:c.noop};CTXS.Controllers.AppDetailsController=function(b,a){var d=this;this.options=c.extend({},f,a);this.store=b;this.appDetailsWidget=new CTXS.Widgets.AppDetailsWidget({onClickOpen:function(a){d._launchApp(a,d.store)},onClickInstall:function(a){d._installApp(a,d.store)},onClickAdd:function(a){d._addApp(a,d.store,d.appDetailsWidget)},onClickRemove:function(a){d._removeApp(a,
d.store,d.appDetailsWidget)},onClickRestart:CTXS.promptForRestartDesktop,onClickClose:function(){d.options.onClose()}});this._bindToAppEvents();this.initialised=!0};CTXS.Controllers.AppDetailsController.prototype={ShowAppDetails:function(b,a){var d=CTXS.Store.getAppByShortId(b);d?this.appDetailsWidget.showAppInfo(d,a):CTXS.trace("_showAppInfo app is null and cannot find last app.")},isDetailsVisible:function(){return this.options.getActiveDetails()||!1},_bindToAppEvents:function(){var b=this;CTXS.Events.subscribe(CTXS.Events.store.appStatusChange,
function(a,d){b._updateButtons(a,d,b.appDetailsWidget)});CTXS.Events.subscribe(CTXS.Events.store.appAddFailure,function(a,d){b._updateButtons(a,d,b.appDetailsWidget)});CTXS.Events.subscribe(CTXS.Events.store.appRevertFailure,function(a,d){b._updateButtons(a,d,b.appDetailsWidget)});CTXS.Events.subscribe(CTXS.Events.store.appAddStarting,function(){b.appDetailsWidget.disableActions(b.appDetailsWidget)});CTXS.Events.subscribe(CTXS.Events.store.appInstallStarting,function(a,d){b._updateButtons(a,d,b.appDetailsWidget)});
CTXS.Events.subscribe(CTXS.Events.store.appRemoveStarting,function(){b.appDetailsWidget.disableActions(b.appDetailsWidget)});CTXS.Events.subscribe(CTXS.Events.resources.launchStatus,function(a,d){b._launchStatus(a,d,b.appDetailsWidget)});CTXS.Events.subscribe(CTXS.Events.resources.powerOffStatus,function(a,d){b._restartDesktopStatus(a,d,b.appDetailsWidget)})},_launchApp:function(b,a){a.launchApp(b)},_installApp:function(b,a){b.ismobileapp&&!b.installed&&a.installApp(b)},_addApp:function(b,a,d){if(b.canBeAdded()||
b.canBeRequested())d.disableActions(),a.addApp(b)},_removeApp:function(b,a,d){d.disableActions();a.removeApp(b)},_launchStatus:function(b,a,d){switch(a.status){case CTXS.LAUNCH_STARTING:d.disableActions();break;case CTXS.LAUNCH_SUCCESS:case CTXS.LAUNCH_FAILURE:d.enableActions();break;case CTXS.LAUNCH_READY:d.enableActions()}},_restartDesktopStatus:function(b,a,d){a.status==CTXS.POWEROFF_STARTING?d.disableActions():a.status==CTXS.POWEROFF_FAILURE&&d.enableActions()},_updateButtons:function(b,a,d){this.isDetailsVisible()&&
(d.updateActions(),a.isInstallInProgress&&d.disableAction(d.$installAction),(a.isAddInProgress||a.isLaunchInProgress||a.isRemoveInProgress)&&d.disableActions(),a.isAddInProgress||a.isLaunchInProgress||a.isRemoveInProgress||d.enableActions())}}})(jQuery);
(function(c){var f={onClickOpen:function(b){},onClickInstall:function(b){},onClickAdd:function(b){},onClickRemove:function(b){},onClickRestart:function(b){},onClickClose:function(){}};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AppDetailsWidget=function(b){this.options=c.extend({},f,b);this.initialised=!1;this.initialised=!0};CTXS.Widgets.AppDetailsWidget.prototype={showAppInfo:function(b,a){this.application=b;a.empty();this._buildHeader(a);var d=c('<div class="appDetails-container" />'),
e=c('<table class="appDetails-container-table"/>'),k=c('<tr class="appDetails-container-tr"/>');a.append(d);d.append(e);e.append(k);d=c('<td class="appDetails-actions-container" />');this._buildActions(d);e=c('<td class="appDetails-description-container" />');this._buildDescription(e);var h=c('<td class="appDetails-info-container" />');this._buildAdditionalInfo(h);h=c('<td class="appDetails-separator"><div /></td>');c('<td class="appDetails-separator"><div /></td>');k.append(d);k.append(h);k.append(e);
b.isLaunchInProgress&&this.disableActions()},_buildHeader:function(b){var a=this.application,d=this,e=c('<div class="appDetails-header theme-highlight-background-color" />'),k=c('<span style="display:inline-flex;" class="appDetails-header-container" />');k.append(c('<div class="appDetails-header-name"></div>').html(a.displayNameDesktopTitle||a.encodedName));var h=null;(h=a.isdesktop?a.desktophostname||"":(new CTXS.Category(a.category)).getDisplayName())&&k.append(c('<div class="appDetails-header-category"></div>').text(h));
e.append(k);a=c('<a href="#" class="appDetails-header-closeContainer"><div class="appDetails-header-closebutton">+</div></a>');a.on("click",function(a){a.preventDefault();d.options.onClickClose()});e.append(a);b.append(e)},_buildActions:function(b){var a=c('<div class="appDetails-actions-header">'+c.localization.string("AppActions")+"</div>");this.$launchAction=c('<a href="#" class="appDetails-action-launch"><div class="appDetails-actions-item"><div class="appDetails-actions-icon appDetails-actions-open embedded-app-open-svg"></div><div class="theme-highlight-color appDetails-actions-text">'+
c.localization.string("Open")+"</div></div></a>");this.$favouriteAction=c('<a href="#" class="appDetails-action-favourite"><div class="appDetails-actions-item"><div class="appDetails-actions-icon appDetails-actions-favorite embedded-app-favorite-svg"></div><div class="theme-highlight-color appDetails-actions-text">'+c.localization.string("AddToFavorites")+"</div></div></a>");this.$removeFavouriteAction=c('<a href="#" class="appDetails-action-unfavourite"><div class="appDetails-actions-item"><div class="appDetails-actions-icon appDetails-actions-unfavorite  embedded-app-unfavorite-svg"></div><div class="theme-highlight-color appDetails-actions-text">'+
c.localization.string("Remove")+"</div></div></a>");this.$installAction=c('<a href="#" class="appDetails-action-install"><div class="appDetails-actions-item"><div class="appDetails-actions-icon appDetails-actions-install embedded-app-install-svg"></div><div class="theme-highlight-color appDetails-actions-text">'+c.localization.string("InstallRequired")+"</div></div></a>");this.$restartAction=c('<a href="#" class="appDetails-action-restart"><div class="appDetails-actions-item"><div class="appDetails-actions-icon appDetails-actions-restart embedded-app-restart-svg"></div><div class="theme-highlight-color appDetails-actions-text">'+
c.localization.string("Restart")+"</div></div></a>");a.append(this.$launchAction);a.append(this.$favouriteAction);a.append(this.$removeFavouriteAction);a.append(this.$installAction);a.append(this.$restartAction);b.append(a);this.updateActions();this.enableActions()},updateActions:function(){var b=this.application;this.$launchAction.toggleClass("hidden",!(this.$launchAction&&b.canOpen()));this.$favouriteAction.toggleClass("hidden",!(this.$favouriteAction&&b.canBeAdded()));this.$removeFavouriteAction.toggleClass("hidden",
!(this.$removeFavouriteAction&&b.canBeRemoved()));this.$installAction.toggleClass("hidden",!(this.$installAction&&b.ismobileapp&&!b.installed));this.$restartAction.toggleClass("hidden",!(this.$restartAction&&b.isdesktop&&b.poweroffurl))},shouldLaunchBeDisabled:function(){return!(!this.$launchAction||!this.application.canOpen())&&!(!this.$installAction||!this.application.ismobileapp||this.application.installed)},enableActions:function(){this.disableActions();this.shouldLaunchBeDisabled()||this.enableAction(this.$launchAction,
this.options.onClickOpen);this.enableAction(this.$favouriteAction,this.options.onClickAdd);this.enableAction(this.$removeFavouriteAction,this.options.onClickRemove);this.application&&!this.application.isInstallInProgress&&this.enableAction(this.$installAction,this.options.onClickInstall);this.enableAction(this.$restartAction,this.options.onClickRestart)},enableAction:function(b,a){var d=this;b&&(b.off("click").on("click",function(b){b.preventDefault();a(d.application)}),b.find(".appDetails-actions-item").children().removeClass("disabled"))},
disableActions:function(){this.disableAction(this.$launchAction);this.disableAction(this.$favouriteAction);this.disableAction(this.$removeFavouriteAction);this.disableAction(this.$installAction);this.disableAction(this.$restartAction)},disableAction:function(b){b&&(b.off("click"),b.find(".appDetails-actions-item").children().addClass("disabled"))},_buildDescription:function(b){var a=this.application,d=c('<div class="appDetails-description-header">'+c.localization.string("AppDescription")+"</div>"),
a=c('<div class="appDetails-description">'+a.encodedDescription+"</div>");b.append(d);b.append(a)},_buildAdditionalInfo:function(b){}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AppFiltersWidget=function(f,b,a,d,e){this.$appFiltersContainer=f;this.filters=b;this.activeFilterItem=null;this.getFilterName=c.isFunction(a)?a:function(){return""};this.numAppsForFilter=c.isFunction(d)?d:function(){return 0};this.onClickFilter=c.isFunction(e)?e:c.noop;this._generateHtml()};CTXS.Widgets.AppFiltersWidget.prototype={maxWidth:function(){return 170},toggleVisibility:function(){this.$appFiltersContainer.toggleClass("show")},
show:function(){this.$appFiltersContainer.addClass("show")},hide:function(){this.$appFiltersContainer.removeClass("show")},getFiltersItems:function(){return this.$appFiltersContainer.find(".appFiltersItem")},clearSelections:function(){this.setActiveFilterItem(null)},setActiveFilterItem:function(f,b){this.activeFilterItem&&c("ul li:eq("+this.activeFilterItem.index+")").removeClass("active").attr("aria-selected",!1);null===f?this.activeFilterItem=null:(this.activeFilterItem={filterItem:f,index:b},c("ul li:eq("+
this.activeFilterItem.index+")").addClass("active").attr("aria-selected",!0))},_generateHtml:function(){var f=this;f.$appFiltersContainer.empty();var b=c("<ul />").addClass("appFiltersView").attr("role","tablist");this.filters&&0<this.filters.length&&(c.each(this.filters,function(a,d){var e=c("<li />").addClass("appFiltersItem").attr("role","tab").attr("aria-selected",!1),k=c("<div />").addClass("bulletPoint").addClass("theme-highlight-background-color"),h=c('<a href="#" />').on("click",function(b){b.preventDefault();
b.stopPropagation();f.setActiveFilterItem(d,a);f.onClickFilter(d)}),g=c(".appfilter-ruler-container"),l=CTXS.decodeHtmlString(f.getFilterName(d),!0),l="{0} ({1})".format(l,f.numAppsForFilter(d)),g=CTXS.truncateToFit(g,l,f.maxWidth(),1,!0);h.addClass("appFiltersItem-Text theme-highlight-color").text(g);l!==g&&h.attr("title",l);k.appendTo(e);h.appendTo(e);e.appendTo(b)}),b.appendTo(f.$appFiltersContainer))}}})(jQuery);
(function(c){function f(){CTXS.Events.subscribe(CTXS.Events.ui.getAppInfoDetails,b);CTXS.Events.subscribe(CTXS.Events.ui.showAppDetails,a);CTXS.Events.subscribe(CTXS.Events.store.appStatusChange,m);CTXS.Events.subscribe(CTXS.Events.store.appAddFailure,m);CTXS.Events.subscribe(CTXS.Events.store.appRevertFailure,m);CTXS.Events.subscribe(CTXS.Events.store.appInstallStarting,m);CTXS.Events.subscribe(CTXS.Events.resources.launchStatus,g);CTXS.Events.subscribe(CTXS.Events.resources.powerOffStatus,l);CTXS.Events.subscribe(CTXS.Events.resources.desktopAssigned,
function(a,b){n.setDesktopHostName(b.desktophostname)})}function b(a,b){var d=function(){CTXS.Events.publish(CTXS.Events.ui.hideAppDetailsLoadingSpinner,b);CTXS.Events.publish(CTXS.Events.ui.showAppDetails,b)},g=function(){CTXS.Events.publish(CTXS.Events.ui.hideAppDetailsLoadingSpinner,b);CTXS.Environment.showDialog({messageText:c.localization.string("AppDetailsUnavailable"),id:"AppDetailsUnavailable",resource:b})};if(b.appinfourl){if(window.fakeAppInfo){var e=jQuery.grep(window.fakeAppInfo,function(a){return a.id==
b.id});e&&0<e.length&&(b.info=e[0])}b.info?d():(CTXS.Events.publish(CTXS.Events.ui.showAppDetailsLoadingSpinner,b),CTXS.Store.getAppInfo(b,d,g))}else d()}function a(a,b){if(b)G=b.id;else if(b=CTXS.Store.getResourceById(G),!b){CTXS.trace("_showAppInfo app is null and cannot find last app, reverting to default View.");CTXS.Controllers.MasterController.revertToDefaultView();return}CTXS.ExtensionsHead.beforeShowAppInfo(b);n.showAppInfo(b)}function d(a){v.launchApp(a)}function e(a){a.ismobileapp&&!a.installed&&
v.installApp(a)}function k(a){if(a.canBeAdded()||a.canBeRequested())CTXS.Controllers.ViewController.redrawOnBack(),v.addApp(a)}function h(a){CTXS.Controllers.ViewController.redrawOnBack();v.removeApp(a)}function g(a,b){switch(b.status){case CTXS.LAUNCH_STARTING:n.hideAppReadyToLaunchUI();n.showAppSpinner();break;case CTXS.LAUNCH_SUCCESS:case CTXS.LAUNCH_FAILURE:n.hideAppSpinner();break;case CTXS.LAUNCH_READY:n.hideAppSpinner(),n.showAppReadyToLaunchUI()}}function l(a,b){b.status==CTXS.POWEROFF_STARTING?
n.showAppSpinner():b.status==CTXS.POWEROFF_FAILURE&&n.hideAppSpinner()}function m(a,b){n.displayButtons(b);b.isLaunchInProgress||n.hideAppSpinner();n.updateInstallStatus(b)}var v,n,G=null;window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.AppInfoController={initialise:function(a,b,c){v=b;f();c.find(".appInfoBack").click(function(a){a.preventDefault();CTXS.Events.publish(CTXS.Events.ui.hideAppDetails);CTXS.Controllers.ViewController.revertView()});n=new CTXS.Widgets.AppInfoWidget(a,
CTXS.UI.useSmallUILayout(),{onClickOpen:d,onClickInstall:e,onClickAdd:k,onClickRemove:h,onClickRestart:CTXS.promptForRestartDesktop})},resize:function(){n&&n.resize()},patch:function(a){eval(a)}}})(jQuery);
(function(c){var f={onClickOpen:function(b){},onClickInstall:function(b){},onClickAdd:function(b){},onClickRemove:function(b){},onClickRestart:function(b){}};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AppInfoWidget=function(b,a,d,e){this.options=c.extend({},f,d);this.initialised=!1;this.$appInfoPage=b;this.$headerPane=this.$appInfoPage.find(".appInfoHeader");this.$headerPaneBar=this.$appInfoPage.find(".appInfoHeaderBar");this.$headerPaneBarTitle=this.$headerPaneBar.find(".appInfoHeaderBarTitle");
this.$actionButtons=this.$appInfoPage.find(".appInfoActions");this.$mainPane=this.$appInfoPage.find(".appInfoMain");this.$appName=this.$headerPane.find(".appInfoName");this.$appCategoriesOrHostName=this.$headerPane.find(".appInfoCategoriesOrHostName");this.$appIcon=this.$headerPane.find(".appInfoIcon");this.$fullDesc=this.$mainPane.find(".full.app-description");this.$trunDesc=this.$mainPane.find(".truncated.app-description");this.phoneView=a;this.$socialDataContainer=this.$mainPane.find(".appInfoSocialData");
this.$appOverview=this.$socialDataContainer.find(".appInfoOverviewTab");this.$tabHeader=this.$socialDataContainer.find(".tabHeader");this.tabHeaderPosition=this.$tabHeader.position().top;this.$openBtn=this.$actionButtons.find(".appInfoOpen");this.$installBtn=this.$actionButtons.find(".appInfoInstall");this.$addBtn=this.$actionButtons.find(".appInfoAdd");this.$removeBtn=this.$actionButtons.find(".appInfoRemove");this.$requestBtn=this.$actionButtons.find(".appInfoRequest");this.$cancelBtn=this.$actionButtons.find(".appInfoCancelRequest");
this.$restartBtn=this.$actionButtons.find(".appInfoRestart");this.$iconOverlay=this.$headerPane.find(".storeapp-loading-overlay");this.$readyOverlay=this.$headerPane.find(".storeapp-ready-overlay");this.$spinner=this.$iconOverlay.find(".storeapp-loading-spinner");this.animatedSpinner=new CTXS.AnimatedSpinner;this.appNameAvailableWidth=-1;this.appName="";this.app=null;this.preserveNumeration=!1;this.$ruler=c(".appinfo-ruler-container");this.$appInfoInstallStatusContainer=c(".appinfo-installation-message");
this.$appInfoInstallStatusIcon=this.$appInfoInstallStatusContainer.find(".install-icon");this.$appInfoInstallStatusText=this.$appInfoInstallStatusContainer.find(".install-message");this.$scrollableSection=c(".scrollable.appInfoView.phone-only");this._bindToUIEvents();this.canBeInstalled=!1;this.initialised=!0};CTXS.Widgets.AppInfoWidget.prototype={displayButtons:function(b){this.canBeInstalled=b.ismobileapp&&!b.installed;var a=this.$addBtn.is(":visible"),d=this.$removeBtn.is(":visible"),c=this.$requestBtn.is(":visible"),
k=this.$installBtn.is(":visible"),h=this.$cancelBtn.is(":visible"),g=b.canOpen(),l=b.canBeAdded(),m=b.canBeRequested(),v=b.canBeRemoved(),f=g&&this.canBeInstalled,G=b.isInstallInProgress,u=b.canCancelRequest();this.$openBtn.toggleClass("show",g);this.$openBtn.attr("aria-hidden",!g);this.$openBtn.toggleClass("disabled",f);this.$requestBtn.toggleClass("show",m);this.$requestBtn.attr("aria-hidden",!m);this.$addBtn.toggleClass("show",l);this.$addBtn.attr("aria-hidden",!l);this.$installBtn.toggleClass("show",
this.canBeInstalled);this.$installBtn.attr("aria-hidden",!this.canBeInstalled);this.$installBtn.toggleClass("disabled",G);this.$removeBtn.toggleClass("show",v);this.$removeBtn.attr("aria-hidden",!v);this.$cancelBtn.toggleClass("show",u);this.$cancelBtn.attr("aria-hidden",!u);b.isAddInProgress||b.isRemoveInProgress||(a&&v?this.$removeBtn.focus():d&&l?this.$addBtn.focus():c&&u?this.$cancelBtn.focus():h&&m?this.$requestBtn.focus():k&&g?this.$openBtn.focus():this.$actionButtons.find(".appInfoActionButton:focusable").first().focus())},
displayRestartButton:function(b){var a=this.$actionButtons.find(".appInfoRestart");a.toggleClass("show",b);a.attr("aria-hidden",!b)},showAppInfo:function(b){this.app=b;this.appName=b.isdesktop?b.displayNameDesktopTitle:b.encodedName;this.preserveNumeration=b.isdesktop&&b.hasParenthesis;this.canBeInstalled=b.ismobileapp&&!b.installed;-1==this.appNameAvailableWidth&&(this.appNameAvailableWidth=this._getWidthAvailableForAppName());this.$appName.html(this._resizeNameTextToFit());CTXS.UI.useSmallUILayout()||
this.$headerPaneBarTitle.text(c.localization.string("AppDetailsPopUpTitle",b.enocdedName));var a=CTXS.IconsLoader.getIcon(b);this.$appIcon.attr({src:a.url,alt:b.encodedName,"data-iconid":b.iconid}).addClass(a.cssClass);b.isAddInProgress||b.isLaunchInProgress?this.showAppSpinner():this.hideAppSpinner();b.isLaunchReady?this.showAppReadyToLaunchUI():this.hideAppReadyToLaunchUI();b.isdesktop?this.$appCategoriesOrHostName.html(b.desktophostname||""):(a=new CTXS.Category(b.category),this.$appCategoriesOrHostName.html(a.getDisplayName()));
b.info?this._showAppDescription(b.encodedDescription,this.$fullDesc,this.$trunDesc):(this.$socialDataContainer.hide(),this.$trunDesc.hide(),this._displayMoreLessLinks(!1),this.$fullDesc.find("span").remove(),b.encodedDescription&&(this.$fullDesc.prepend("<span>"+b.encodedDescription+"</span>"),this.$fullDesc.show()));this.updateInstallStatus(b);this.$openBtn.add(this.$addBtn).add(this.$removeBtn).add(this.$requestBtn).add(this.$cancelBtn).add(this.$installBtn).toggleClass("show",!1);this.displayButtons(b);
b.isdesktop&&b.poweroffurl?this.displayRestartButton(!0):this.displayRestartButton(!1);var d=this,a=this.$addBtn.add(this.$requestBtn),e=this.$removeBtn.add(this.$cancelBtn);this.$openBtn.off("click").on("click",function(a){a.preventDefault();if(!c(this).hasClass("disabled"))d.options.onClickOpen(b)});a.off("click").on("click",function(a){a.preventDefault();d.options.onClickAdd(b)});e.off("click").on("click",function(a){a.preventDefault();d.options.onClickRemove(b)});this.$restartBtn.off("click").on("click",
function(a){a.preventDefault();d.options.onClickRestart(b)});this.$installBtn.off("click").on("click",function(a){a.preventDefault();d.options.onClickInstall(b)})},showAppSpinner:function(){this.animatedSpinner.start(this.$spinner,this.$iconOverlay)},hideAppSpinner:function(){this.animatedSpinner.stop(this.$spinner,this.$iconOverlay)},setDesktopHostName:function(b){this.$appCategoriesOrHostName.html(b)},showAppReadyToLaunchUI:function(){this.$readyOverlay.show()},hideAppReadyToLaunchUI:function(){this.$readyOverlay.hide()},
resize:function(){this.appNameAvailableWidth=this._getWidthAvailableForAppName();this._resizeNameTextToFit()},updateInstallStatus:function(b){var a=b.getInstallationState();a===CTXS.App.InstallState.NOT_INSTALLABLE&&this.$appInfoInstallStatusContainer.hide();this.$appInfoInstallStatusText.html("");for(var d in CTXS.App.InstallState)CTXS.App.InstallState.hasOwnProperty(d)&&this.$appInfoInstallStatusContainer.removeClass(CTXS.App.InstallState[d]);this.$appInfoInstallStatusContainer.removeClass("newinstalled");
a!==CTXS.App.InstallState.NOT_INSTALLABLE&&this.$appInfoInstallStatusContainer.addClass(a);this.$appInfoInstallStatusText.text(this._getInstallMessageString(a));a===CTXS.App.InstallState.INSTALLED&&b.isNewInstall?(this.$appInfoInstallStatusContainer.addClass("newinstalled"),this.updateNewInstallStatus()):a===CTXS.App.InstallState.INSTALLED?this.$appInfoInstallStatusContainer.hide():this.$appInfoInstallStatusContainer.show()},updateNewInstallStatus:function(){CTXS.isVisibleWithinScrollPane(this.$appInfoInstallStatusContainer,
this.$scrollableSection)&&(this.app.isNewInstall=!1)},_bindToUIEvents:function(){var b=this;b.$trunDesc.on("click",".more.desc-link",function(a){a.preventDefault();b.$trunDesc.hide();b.$fullDesc.show();b.tabHeaderPosition=b.$tabHeader.position().top});b.$fullDesc.on("click",".less.desc-link",function(a){a.preventDefault();b.$fullDesc.hide();b.$trunDesc.show();b.tabHeaderPosition=b.$tabHeader.position().top});b.$scrollableSection.on("scroll",CTXS.throttle(function(){b.updateNewInstallStatus.apply(b)},
250))},_getInstallMessageString:function(b){switch(b){case CTXS.App.InstallState.INSTALLED:return c.localization.string("Installed");case CTXS.App.InstallState.INSTALLING:return c.localization.string("Installing");case CTXS.App.InstallState.NEEDS_INSTALL:return c.localization.string("InstallRequired").toLocaleUpperCase();case CTXS.App.InstallState.NOT_INSTALLABLE:return"";default:return""}},_displayMoreLessLinks:function(b){this.$trunDesc.find(".more.desc-link").toggle(b);this.$fullDesc.find(".less.desc-link").toggle(b)},
_showAppDescription:function(b){b?(this._displayMoreLessLinks(!1),this.$fullDesc.hide(),this.$fullDesc.find("span").remove(),this.$trunDesc.find("span").remove(),this.$fullDesc.prepend("<span>"+b+"</span>"),this.$fullDesc.show()):this.$trunDesc.hide()},_getWidthAvailableForAppName:function(){var b=c(window).width(),a=CTXS.UI.useSmallUILayout()?137:152;return b-a},_resizeNameTextToFit:function(){return CTXS.truncateToFit(this.$ruler,this.appName,this.appNameAvailableWidth,5,this.preserveNumeration)}}})(jQuery);
(function(c){function f(a,b,c){var k=a.numAppsToShow||3,h='<a href="#" class="applicationBundle '+a.tileid;c&&(h+=" applicationBundleFirst");h=h+('" data-findex="'+b+'">')+'<div class="applicationBundleLogo"></div>';h+='<div class="applicationBundleContents"><div class="applicationBundleTitle">'+a.title+'</div><span class="applicationBundleText">'+a.description+"</span>";h+='<div class="applicationBundleAppContainer">';for(b=c=0;b<a.apps.length;b++){for(var g=a.apps[b],l=!1,m=0;m<b;m++)if(g.iconurl==
a.apps[m].iconurl){l=!0;break}if(!l){c++;if(c>k)break;l=CTXS.IconsLoader.getIcon(g);h+='<img class="applicationBundleApp" data-iconid="'+g.iconid+'" src="'+l.url+'" alt="'+g.encodedName+'"/>'}}return h+="</div></div></a>"}function b(a,b,c){return function(){return f(a,b,c)}}window.CTXS=window.CTXS||{};CTXS.Views=CTXS.Views||{};CTXS.Views.ApplicationBundlesView={patch:function(a){eval(a)},getApplicationBundleMarkup:function(a,d){null==d&&(d=!1);if(null==a||0==a.length)return"";for(var c="",k=CTXS.ExtensionsHead.isDefined("getBundleMarkup"),
h=!d,g=0;g<a.length;g++)var l=a[g],c=k?c+CTXS.ExtensionsHead.getBundleMarkup(l,g,b(l,g,h)):c+f(l,g,h),h=!1;return c}}})(jQuery);
(function(c){var f={useSmallTiles:!1,repeatTiles:!0,minimumAvailableWidth:1024,onClickBundle:function(b){}};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.ApplicationBundlesWidget=function(b,a,d,e){this.options=c.extend({},f,e);this.$bundleContainer=b;this.$carousel=this.$bundleContainer.find(".appBundles");this.$prevButton=this.$bundleContainer.find(".prevBundleOuter");this.$nextButton=this.$bundleContainer.find(".nextBundleOuter");this.$cssTarget=a;this.shouldShow=!1;this._populateCarousel(d);
this.options.useSmallTiles?this._applySmallUIResizing():this._applyLargeUIResizing();this.$prevButton.add(this.$nextButton).toggleClass("hidden",this.options.useSmallTiles);this._initializeCarousel();this._bindToUIEvents()};CTXS.Widgets.ApplicationBundlesWidget.prototype={show:function(){this.shouldShow=!0;0<this.applicationBundles.length&&this._makeVisible()},hide:function(){this.shouldShow=!1;this._makeHidden()},fadeOut:function(){this.shouldShow=!1;this.$bundleContainer.fadeOut(200)},update:function(b){this.$carousel.slick("unslick");
this._populateCarousel(b);this._initializeCarousel();this.shouldShow&&(0<b.length?this._makeVisible():this._makeHidden())},_makeVisible:function(){this.$bundleContainer.show();this.$carousel.slick("setPosition")},_makeHidden:function(){this.$bundleContainer.hide()},_initializeCarousel:function(){this.$carousel.slick({accessibility:!0,infinite:this.options.repeatTiles,variableWidth:!0,prevArrow:this.$prevButton,nextArrow:this.$nextButton,useTransform:!0})},_populateCarousel:function(b){this.applicationBundles=
b;b=c.merge([],b);this.options.repeatTiles?(c.merge(b,b),this.duplicatingTiles=!0):this.duplicatingTiles=!1;this.$carousel.html(CTXS.Views.ApplicationBundlesView.getApplicationBundleMarkup(b,this.options.useSmallTiles))},_applySmallUIResizing:function(){this.$cssTarget.append('<style type="text/css">.smallTiles .applicationBundle, .applicationBundleContainer .content:after { width: '+(this.options.minimumAvailableWidth-32)+"px }</style>")},_applyLargeUIResizing:function(){var b=this.$bundleContainer.find(".applicationBundle:first").outerWidth();
1.4*b>this.options.minimumAvailableWidth&&(b=Math.floor(this.options.minimumAvailableWidth/1.4),this.$cssTarget.append('<style type="text/css">.largeTiles .applicationBundle { width: '+b+"px }</style>"))},_bindToUIEvents:function(){var b=this;b.$prevButton.on("click",function(a){a.preventDefault()});b.$nextButton.on("click",function(a){a.preventDefault()});b.$bundleContainer.on("touchstart.slick mousedown.slick",function(a){a.stopPropagation()});b.$bundleContainer.on("touchmove.slick mousemove.slick",
function(a){a.stopPropagation()});b.$bundleContainer.on("click",".applicationBundle",function(a){a.preventDefault();a=c(this).data("findex")%b.applicationBundles.length;b.options.onClickBundle(b.applicationBundles[a])})}}})(jQuery);
(function(c){var f={onActionLinkClick:function(b,a){},onDetailsLinkClick:function(b,a){},onTaskLinkClick:function(){},updateAppPosition:function(b,a,d,c){},onFolderNavigation:function(b){},onFavoriteClick:function(b,a){},onFolderNameUpdate:function(){},onFolderNameHide:function(){},onCollectionClick:function(b){},canReorderApps:!0,detailsAnimationDuration:400,detailsAnimationEasing:"easeInOutCubic"};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AppListViewWidget=function(b,
a,d,e,k,h,g){var l=this;this.initialised=!1;this.$body=b;this.$appsContainer=a;this.animationSpinner=d;this.options=c.extend({},f,g);this._resizeStyleEl=null;this.$scrollableSection=c("section.scrollable.storeViewSection");this._bindToUIEvents();this.initialised=!0;this.currentVisibleCategory=null;this.resize();this.appsWidget=new CTXS.Widgets.AppsWidget(this.$appsContainer,{updateAppPosition:this.options.updateAppPosition,handleTask:this.options.onTaskLinkClick});this.foldersWidget=new CTXS.Widgets.FoldersWidget(this.$appsContainer,
c(".fadeAnimation"),c(".store-toolbar-phone"),c(".scrollable.storeViewSection"),e,k,this.appsWidget,h,{onRender:function(){CTXS.ExtensionsHead.onAppHTMLGeneration(l.$appsContainer[0]);l._onViewUpdate()},onFolderNameUpdate:this.options.onFolderNameUpdate,onFolderNameHide:this.options.onFolderNameHide});CTXS.UI.useSmallUILayout()&&CTXS.UI.useSmallTiles()||(this.appDetailsController=new CTXS.Controllers.AppDetailsController(CTXS.Store,{onClose:function(){l.closeDetails(l.$lastOpenedAppDetails,!0)},onClickInstall:function(a){},
getActiveDetails:function(){return 0!==l.$appsContainer.find(".storeapp.showDetails").length}}));this.previousScrollTop=this.$scrollableSection.scrollTop()};CTXS.Widgets.AppListViewWidget.prototype={clearUI:function(){this.$appsContainer.empty()},showAppsInFolderView:function(b){this.foldersWidget.showByCategory(b);this.options.onFolderNavigation(b.index)},showCollectionList:function(){this.foldersWidget.showCollections()},showApps:function(b,a){var d=CTXS.trace("showApps()");this.clearUI();this.appsWidget.show(b,
a);this.foldersWidget.clearCurrentFolderIndex();this._onViewUpdate();CTXS.trace("done showApps()",d)},showTasks:function(){var b=CTXS.trace("showTasks()");this.clearUI();this.appsWidget.showTasks();this.foldersWidget.clearCurrentFolderIndex();this._onViewUpdate();CTXS.trace("done showTasks()",b)},showSettings:function(){var b=CTXS.trace("showSettings()");this.clearUI();this.appsWidget.showSettings();this.foldersWidget.clearCurrentFolderIndex();this._onViewUpdate();CTXS.trace("done showSettings()",
b)},_navigateToFolderFromClick:function(b,a){this.foldersWidget.animating||(this.foldersWidget.animating=!0,this.navigateToFolder(b,a))},_navigateToCollectionFromClick:function(b,a){if(!this.foldersWidget.animating){var d=this.foldersWidget._getCollectionById(b);this.options.onCollectionClick(d)}},navigateToFolder:function(b,a){var d=CTXS.Category_ByIndex(b);this.options.onFolderNavigation(d.index);var c=[];this.createGroupsForSubCategories(c,d,0);CTXS.UI.useSmallTiles()&&a?this.foldersWidget.navigateWithTransition(a,
b,c):this.foldersWidget.navigateTo(b,c)},createGroupsForSubCategories:function(b,a,d){0<a.count&&b.push({displayName:a.getDisplayPath(),displayLevel:d,apps:a.apps,count:a.count});a=a.subcategories;for(var c in a)a.hasOwnProperty(c)&&this.createGroupsForSubCategories(b,a[c],d+1)},filterStoreApps:function(b,a){this.appsWidget.showSelectedStoreApps(b,!1,a)},navigateBack:function(){this.foldersWidget.navigateBack()},showMyApps:function(b){var a=CTXS.trace("showMyApps()");this.clearUI();this.appsWidget.show(b);
this._onViewUpdate();this.options.canReorderApps&&this.appsWidget.makeAppsSortable();CTXS.trace("done showMyApps()",a)},getCurrentFolderIndex:function(){return this.foldersWidget.currentFolderIndex},hideAppLaunchSpinner:function(b){CTXS.Views.AppView.hideAppLaunchSpinner(b,this.$appsContainer)},showAppSpinner:function(b){CTXS.Views.AppView.showAppSpinner(b,this.$appsContainer)},hideAppSpinner:function(b){CTXS.Views.AppView.hideAppSpinner(b,this.$appsContainer)},enableAppFavorite:function(b){CTXS.Views.AppView.enableAppFavorite(b,
this.$appsContainer)},disableAppFavorite:function(b){CTXS.Views.AppView.disableAppFavorite(b,this.$appsContainer)},showAppReadyToLaunchUI:function(b){CTXS.Views.AppView.showAppReadyToLaunchUI(b,this.$appsContainer)},hideAppReadyToLaunchUI:function(b){CTXS.Views.AppView.hideAppReadyToLaunchUI(b,this.$appsContainer)},updateAppState:function(b){CTXS.Views.AppView.updateAppState(b,this.$appsContainer)},appTileWidth:0,resize:function(b){CTXS.trace("start resize");if(this.initialised&&this.$appsContainer.is(":visible")&&
(!CTXS.Device.isLegacyIE()||CTXS.Device.isNativeClient())&&!CTXS.UI.useSmallTiles()){var a=this.$appsContainer.find(".storeapp:first");if(0!=a.length){if(0==this.appTileWidth||b)b=a.eq(0),this.appTileWidth=b.width()+parseFloat(b.css("borderRightWidth"),10)+parseFloat(b.css("borderLeftWidth"),10);b=this.$appsContainer.width()-2-this.appTileWidth;a=Math.floor(b/(this.appTileWidth+10));b=".storeapp-list .storeapp, .storeapp-list .folder { margin-left:0;px; margin-right:"+(b/a-this.appTileWidth)+"px;}\n.storeapp-list:not(.dragging) > :nth-child("+
(a+1)+"n+0) { margin-right: 0; }";null==this._resizeStyleEl?this._resizeStyleEl=c("<style>{0}</style>".format(b)).appendTo("head")[0]:CTXS.Device.isLegacyIE()?this._resizeStyleEl.styleSheet.cssText=b:this._resizeStyleEl.innerHTML=b;this.$appsContainer.find(".storeapp.showDetails").each(function(){var a=c(this).find(".storeapp-details-dropdown");if(a){var b=c(this).parent(),k=b.offset().left,b=b.width()-4;a.offset({left:k});a.width(b)}})}}},updateUI:function(b){this.$appsContainer.html(b);this._onViewUpdate()},
_bindToUIEvents:function(){var b=this;b.$appsContainer.on("click",".storeapp-action-link, .storeapp-details-container",function(a){a.preventDefault();a.stopPropagation();a=c(this).closest(".storeapp");if(0==a.length){a=c(this).closest(".folder");var d=a.data("folderindex"),e=a.data("tileid");void 0!==d?b._navigateToFolderFromClick(d,a):void 0!==e&&b._navigateToCollectionFromClick(e,a)}else if(!a.hasClass("operation-in-progress"))if(CTXS.UI.useSmallUILayout()&&CTXS.UI.useSmallTiles())b.options.onDetailsLinkClick(CTXS.Views.AppView.getAppShortId(a));
else b._onClickDetails(c(this).closest(".storeapp"))});b.$appsContainer.on("click",".storeapp-details-link",function(a){a.preventDefault();a.stopPropagation();a=c(this).closest(".storeapp");if(0==a.length){a=c(this).closest(".folder");var d=a.data("folderindex"),e=a.data("tileid");void 0!==d?b._navigateToFolderFromClick(d,a):void 0!==e&&b._navigateToCollectionFromClick(e,a)}else b.options.onActionLinkClick(CTXS.Views.AppView.getAppShortId(a),a)});b.$appsContainer.on("click",".storeapp-favorite-status",
function(a){a.preventDefault();a.stopPropagation();a=c(this).closest(".storeapp");if(!a.hasClass("operation-in-progress")&&!a.hasClass("favoriteDisabled"))b.options.onFavoriteClick(CTXS.Views.AppView.getAppShortId(a))});b.$appsContainer.on("mousedown touchstart",".storeapp-details-link, .storeapp-action-link",function(){var a=c(this),b=a.closest(".storeapp"),b=a.hasClass("storeapp-details-link")?b.find(".storeapp-action-link"):b.find(".storeapp-details-link");a.addClass("pressed");b.addClass("highlighted")}).on("mouseup touchend touchcancel",
function(){b.$appsContainer.find(".pressed, .highlighted").removeClass("pressed").removeClass("highlighted")});b.$scrollableSection.on("scroll",CTXS.throttle(function(){b.updateNewInstallStatus.apply(b)},250))},updateNewInstallStatus:function(){var b=this;c.each(this.newInstalledApps,function(a,d){CTXS.isVisibleWithinScrollPane(d.$installationMessage,b.$scrollableSection)&&(d.app.isNewInstall=!1)})},updateNewInstalledApps:function(){this.newInstalledApps=c.map(this.$appsContainer.find(".storeapp.newinstalled"),
function(b){b=c(b);return{$app:b,app:CTXS.Store.getAppByShortId(b.data("shortid")),$installationMessage:b.find(".storeapp-installation-message")}})},updateNewInstalledClass:function(){c.each(this.newInstalledApps,function(b,a){a.app.isNewInstall||a.$app.removeClass("newinstalled")})},_onViewUpdate:function(){var b=CTXS.trace("updateUI");c(".storeViewSection")[0].scrollTop=0;this.updateNewInstalledApps();this.$lastOpenedAppDetails=null;this.resize();CTXS.trace("done updateUI",b)},_onClickDetails:function(b){if(!this.isBusy)if(this.isBusy=
!0,this.$lastOpenedAppDetails&&b&&this.$lastOpenedAppDetails[0]===b[0])this.closeDetails(this.$lastOpenedAppDetails,!0);else{var a=this.$lastOpenedAppDetails?this.$lastOpenedAppDetails.offset().top:null;this.previousScrollTop=this.$scrollableSection.scrollTop();var d=this.$lastOpenedAppDetails&&this.$lastOpenedAppDetails.offset().top===b.offset().top;if(this.$lastOpenedAppDetails){var c=this.$lastOpenedAppDetails,k=c.find(".storeapp-details-dropdown"),h=c.find(".arrow-up");d?this.closeDetailsInstantly(c,
k,h):this.closeDetails(c,!1)}CTXS.Events.publish(CTXS.Events.ui.showAppDetailsDropdown,{instant:d,previousDetailsTop:a,scrollTo:!0,$appsContainer:b})}},scrollToDetails:function(b,a,d,e){var k=b.offset().top;if(k+b.height()>window.innerHeight){b=c(".storeViewSection");var h=b.height(),g=b.offset().top,l=a.closest(".storeapp-list").offset().top,m=a.offset().top,g=l-g;d=null===d||null!==d&&d>m?a.outerHeight(!0)+210:a.outerHeight(!0);k=d-(k-m);d=g-(h-d);h<k&&(d-=k-h);a.velocity("scroll",{container:b,
duration:null!==e?e:this.options.detailsAnimationDuration,easing:this.options.detailsAnimationEasing,offset:d})}},openDetails:function(b,a,d,c){var k=this,h=c.find(".storeapp-details-dropdown"),g=c.height()+16;h.css({top:g+"px"});this.$lastOpenedAppDetails=c;c.addClass("showDetails theme-highlight-border-color");var g=c.width()/2-7,l=c.height()+7,m=c.find(".arrow-up");m.css({top:l+"px",left:g+"px"});b?(h.css({display:"block",opacity:"1"}),c.css({"margin-bottom":"+=210px"}),m.css({display:"block",
opacity:"1"}),this.appDetailsController.ShowAppDetails(CTXS.Views.AppView.getAppShortId(c),h),this.resize(),this.isBusy=!1,this.$scrollableSection.scrollTop(this.previousScrollTop),d&&this.scrollToDetails(h,c,a,0)):(c.velocity({"margin-bottom":"+=210px"},{queue:!1,duration:this.options.detailsAnimationDuration,easing:this.options.detailsAnimationEasing}),m.velocity("fadeIn",{begin:function(){m.css({opacity:"0"})},queue:!1,duration:this.options.detailsAnimationDuration}),h.velocity("fadeIn",{begin:function(){h.css({display:"block",
opacity:"0"});k.appDetailsController.ShowAppDetails(CTXS.Views.AppView.getAppShortId(c),h);k.resize()},queue:!1,duration:this.options.detailsAnimationDuration}),h.velocity("slideDown",{queue:!1,progress:function(){k.resize()},duration:this.options.detailsAnimationDuration,easing:this.options.detailsAnimationEasing,complete:function(){k.isBusy=!1}}),d&&this.scrollToDetails(h,c,a))},closeDetailsInstantly:function(b,a,d){CTXS.Events.publish(CTXS.Events.ui.hideAppDetailsDropdown);b.css({"margin-bottom":"-=210px"});
a.css({display:"none"});d.css({display:"none"});b.removeClass("showDetails theme-highlight-border-color")},closeDetails:function(b,a){CTXS.Events.publish(CTXS.Events.ui.hideAppDetailsDropdown);if(b&&!this.isClosing){var d=this,c=b.find(".storeapp-details-dropdown"),k=b.find(".arrow-up");d.isBusy=!0;d.isClosing=!0;b.velocity({"margin-bottom":"-=210px"},{queue:!1,duration:this.options.detailsAnimationDuration,easing:this.options.detailsAnimationEasing,complete:function(){b.removeClass("showDetails theme-highlight-border-color");
c.css({display:"none"});k.css({display:"none"});d.resize();d.isClosing=!1;a&&(d.isBusy=!1,d.$lastOpenedAppDetails=null)}});c.velocity("fadeOut",{queue:!1,duration:this.options.detailsAnimationDuration});k.velocity("fadeOut",{queue:!1,duration:this.options.detailsAnimationDuration});c.velocity("slideUp",{queue:!1,duration:this.options.detailsAnimationDuration,easing:this.options.detailsAnimationEasing})}}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.AppShortcutController=function(c){this.store=c;this.appShortcutResource=null;this.securityToken=this.htmlEncodedResourceName="";this.pageHash=CTXS.getUrlHash();CTXS.AppShortcuts.isAppShortcutLaunch()&&(c=decodeURIComponent(CTXS.AppShortcuts.getUrlHashComponents()[2]),this.htmlEncodedResourceName=CTXS.encodeHtml(c),this.securityToken=decodeURIComponent(CTXS.AppShortcuts.getUrlHashComponents()[3]),this.appShortcutResource=
this.store.getResourceByName(c));this._bindToUIEvents()};CTXS.Controllers.AppShortcutController.prototype={validateAppShortcutLaunch:function(){if(CTXS.AppShortcuts.isAppShortcutLaunch())if("true"!==CTXS.Config.getConfigValue("userInterface.appShortcuts.enabled"))this._displayErrorPopup(c.localization.string("CannotCompleteYourRequest"));else if(null===this.appShortcutResource)this._displayErrorPopup(c.localization.string("ResourceIsNotAvailable",this.htmlEncodedResourceName));else if(this.appShortcutResource.subscriptionstatus===
CTXS.SUBSCRIPTION_STATUS.PENDING)this._displayErrorPopup(c.localization.string("AppRequestPendingApprovalCannotStart",this.htmlEncodedResourceName));else if(this.appShortcutResource.subscriptionstatus===CTXS.SUBSCRIPTION_STATUS.APPROVED)this._displayErrorPopup(c.localization.string("CannotCompleteYourRequest"));else if(this.appShortcutResource.subscriptionstatus===CTXS.SUBSCRIPTION_STATUS.DENIED)this._displayErrorPopup(c.localization.string("CannotCompleteYourRequest"));else if(CTXS.Environment.canLaunchResource(this.appShortcutResource)){var f=
this.appShortcutResource.subscriptionstatus===CTXS.SUBSCRIPTION_STATUS.NOTSUBSCRIBED||null==this.appShortcutResource.subscriptionstatus;if(this.appShortcutResource.requiresworkflow&&f)this._displayErrorPopup(c.localization.string("CannotCompleteYourRequest"));else{var b=this;CTXS.ResourcesClient.validateAppShortcutLaunch(this.appShortcutResource,this.securityToken,document.referrer,function(a){b.processValidationSuccess(a)},function(){b.processValidationFailure()})}}else this._displayErrorPopup(c.localization.string(this.appShortcutResource.isdesktop?
"CannotStartDesktop":"CannotStartApp",this.htmlEncodedResourceName))},processValidationSuccess:function(c){var b=c.status===CTXS.APP_SHORTCUTS.VALIDATION_PROMPT;CTXS.Events.publish(CTXS.Events.ui.showAppDetails,this.appShortcutResource);b||CTXS.ClientManager.usingNativeClientInInternetZone()?this._displayUserPrompt():c.status===CTXS.APP_SHORTCUTS.VALIDATION_SUCCESS&&this._launchApp()},processValidationFailure:function(){CTXS.Events.publish(CTXS.Events.error.terminalState)},_displayErrorPopup:function(f){CTXS.Environment.showDialog({messageText:f,
buttonLabel:c.localization.string("OK")})},_displayUserPrompt:function(){var f=this;CTXS.Environment.showDialog({messageText:c.localization.string("DoYouWantToStartApp",this.htmlEncodedResourceName),buttonLabel:c.localization.string("Start"),buttonAction:function(){f._launchApp()},cancelButtonLabel:c.localization.string("Cancel"),cancelButtonAction:c.noop})},_launchApp:function(){var c=this.store.isSubscriptionRequired(this.appShortcutResource);this.store.launchApp(this.appShortcutResource);c&&this.store.addApp(this.appShortcutResource)},
_bindToUIEvents:function(){var f=this;c(window).on("hashchange",function(){var b=f.pageHash,a=CTXS.getUrlHash();0!==b.indexOf("/launch/")&&0!==a.indexOf("/launch/")||document.location.reload(!1)})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={updateAppPosition:function(b,a,d,c){},handleTask:function(){},subfolderCutoff:4};CTXS.Widgets.AppsWidget=function(b,a){this.$view=b;this.options=c.extend(f,a);var d=this;this.$view.on("click",".taskapp-action-link",function(a){a.preventDefault();d.options.handleTask()})};CTXS.Widgets.AppsWidget.prototype={show:function(b,a){null==a&&(a="");var d=[];d.push({displayName:a,apps:b,count:b.length});this.showWithGroups(b,d)},
showWithGroups:function(b,a){var d=CTXS.trace("Show Apps");this.$view.empty();for(var c=0;c<a.length;c++){var k=a[c];0<k.count&&(k=this._generateAppsHtml(k.apps,k.displayName,k.displayLevel),this.$view.append(k))}CTXS.ExtensionsHead.onAppHTMLGeneration(this.$view[0]);CTXS.trace("done show Apps",d)},getAppsHtml:function(b){for(var a="",d=0;d<b.length;d++){var c=b[d];0<c.count&&(a+=this._generateAppsHtml(c.apps,c.displayName,c.displayLevel))}return a},showTasks:function(){var b=CTXS.Device.supportsHighResDisplay()?
"receiver/images/2x/SecurityQuestionIcon@2x_FF5112B786AC5C3E.png":"receiver/images/1x/SecurityQuestionIcon_70E32CDF11AEE4A5.png",b='<div><ul class="storeapp-list">'+('<li class="storeapp"><img class="storeapp-icon" src="'+b+'" >    <div class="storeapp-details-container">       <p class="storeapp-name">'+c.localization.string("ManageSecurityQuestions")+'</p>    </div><a href="#" class="taskapp-action-link theme-highlight-color">'+c.localization.string("Start")+"</a></li>");this.$view.append(b+"</ul></div>");CTXS.ExtensionsHead.onAppHTMLGeneration(this.$view[0])},
showSelectedStoreApps:function(b,a,d){a=d&&0<d.length;0!=b.length||a?a?this.showWithGroups(b,d):this.show(b):this.clearUI()},_usingTouch:!1,_dragItem:null,makeAppsSortable:function(){var b=this,a=this.$view.find(".storeapp-list"),d=!0===CTXS.simulateClicksInSortable||CTXS.Device.getPlatform()==CTXS.Device.Platform.ANDROID&&!1!==CTXS.simulateClicksInSortable;a.on("touchstart",function(e){b._usingTouch||(b._usingTouch=!0,a.sortable("option","delay",500));b._dragItem=c(e.target).closest(".storeapp");
if(d&&e.originalEvent.touches&&e.originalEvent.touches[0]){var k=e.originalEvent.touches[0];b._touchItemX=k.screenX;b._touchItemY=k.screenY;b._touchItemDistanceSquared=0;b._$touchItem=c(e.target)}setTimeout(function(){b._dragItem&&b._dragItem.addClass("dragging")},500)}).on("touchend touchcancel touchleave",function(){b._dragItem&&(b._dragItem.removeClass("dragging"),b._dragItem=null,d&&b._$touchItem&&121>b._touchItemDistanceSquared&&(b._$touchItem.trigger("click"),b._$touchItem=null))});if(d)a.on("touchmove",
function(a){if(a.originalEvent.touches&&a.originalEvent.touches[0]){var d=a.originalEvent.touches[0];a=b._touchItemX-d.screenX;d=b._touchItemY-d.screenY;b._touchItemDistanceSquared=a*a+d*d}});a.sortable({items:".storeapp",revert:"fast",containment:".storeapp-list",tolerance:"pointer",handle:".storeapp-icon, .storeapp-name, .storeapp-category, .storeapp-action-link, .storeapp-details-link, .storeapp-favorite-status",start:function(b,d){c(document).click();a.addClass("dragging");CTXS.trace("sortable start: ui.item="+
d.item.attr("id")+", class="+d.item.attr("class"))},stop:function(b,d){CTXS.trace("sortable stop: ui.item="+d.item.get(0));a.removeClass("dragging");d.item.removeClass("dragging")},update:function(a,d){CTXS.trace("sortable update: ui.item="+d.item.get(0));var c=d.item,g=c.attr("data-shortid"),l=c.prev().length?c.prev().attr("data-shortid"):null,c=c.next().length?c.next().attr("data-shortid"):null;b.options.updateAppPosition(g,l,c)}})},_generateAppsHtml:function(b,a,d){var c=CTXS.trace("Apps Markup Start");
d=this._generateHeader(a,b.length,d||0)+'<ul class="storeapp-list">';for(var k=0,h=b.length;k<h;k++)d+=CTXS.Views.AppView.getMarkup(b[k]);d+="</ul>";CTXS.trace("Apps Markup Finish",c);return"<div class='store-apps-group' title='"+a+"'>"+d+"</div>"},_generateHeader:function(b,a,d){d=d||0;d=d>this.options.subfolderCutoff?this.options.subfolderCutoff:d;var c=b.substring(b.lastIndexOf("\\")+1);CTXS.UI.useSmallUILayout()&&0<c.length&&(c+=" ("+a+")");b=b.replace(/\\/g," > ");a=0<d?"subtitle-level{0}".format(d):
"";var k="";switch(d){case 0:break;case this.options.subfolderCutoff:k="{0}{1}{2}".format("<div class='subtitle-icon'></div>","<div class='subtitle-ellipsis'>...</div>","<div class='subtitle-icon'></div>");break;default:for(var h=0;h<d;h++)k+="<div class='subtitle-icon'></div>"}return'<div class="store-apps-title {0} theme-highlight-color" title="{1}">{2}{3}</div>'.format(a,b,k,c)},clearUI:function(){this.$view.empty()}}})(jQuery);
(function(c){function f(a){var b=a.encodedName,d=!1,c=CTXS.Views.AppView.Settings.NameWidth(),g=CTXS.Views.AppView.Settings.NameMaxLines();a.isdesktop&&a.hasParenthesis&&(b=a.displayNameDesktopTitle,d=!0);if(6<b.length){if(a=m[b])return a;d=CTXS.truncateToFit(l,b,c,g,d);return m[b]=d}return b}function b(a){var b=new CTXS.Category(a.category),d=b.name===CTXS.Category.CATEGORY_OTHER;return a.isdesktop||d?"":'<p class="storeapp-category">'+b.getDisplayName()+"</p>"}function a(a){switch(a.getInstallationState()){case CTXS.App.InstallState.INSTALLED:return c.localization.string("Installed");
case CTXS.App.InstallState.INSTALLING:return c.localization.string("Installing");case CTXS.App.InstallState.NEEDS_INSTALL:if(!CTXS.UI.useSmallTiles())return c.localization.string("InstallRequired").toLocaleUpperCase();default:return""}}function d(d,c){var g="storeapp "+d.getState(),l=d.getInstallationState();l!==CTXS.App.InstallState.NOT_INSTALLABLE&&(g+=" "+l);d.requiresworkflow&&(g+=" requiresworkflow");d.isLaunchReady&&(g+=" launch-ready");d.cssClass&&(g+=" "+d.cssClass);d.isAddInProgress&&(g+=
" favoriteDisabled");d.isNewInstall&&(g+=" newinstalled");g='<li class="'+g+'" data-shortid="'+d.shortid+'"><div class="app-tile"></div>';CTXS.IconsLoader.getIcon(d);b(d);if(CTXS.UI.useSmallTiles())var l=CTXS.IconsLoader.getIcon(d),h=a(d),m=b(d),l='<a href="#" class="storeapp-details-link"><img class="storeapp-icon '+l.cssClass+'" src="'+l.url+'" alt="'+d.encodedName+'" data-iconid="'+d.iconid+'"/><div class="install-status"></div><div class="storeapp-loading-overlay"><div class="spinner storeapp-loading-spinner"></div></div><div class="storeapp-ready-overlay"></div><div class="storeapp-details-container"><p class="storeapp-name">'+
c+'</p><div class="storeapp-installation-message"><div class="install-icon"/><p class="install-message">'+h+"</p></div>"+m+'<div class="storeapp-ratings">'+e(d)+"</div></div></a>";else l=CTXS.IconsLoader.getIcon(d),h=a(d),m=b(d),l='<a href="#" class="storeapp-details-link"><img class="storeapp-icon '+l.cssClass+'" src="'+l.url+'" alt="'+d.encodedName+'" data-iconid="'+d.iconid+'"/><div class="install-status"></div><div class="storeapp-loading-overlay"><div class="spinner storeapp-loading-spinner"></div></div><div class="storeapp-ready-overlay"></div></a><a href="#" class="storeapp-details-container"><p class="storeapp-name">'+
c+'</p><div class="storeapp-installation-message"><div class="install-icon"/><p class="install-message">'+h+"</p></div>"+m+'<div class="storeapp-ratings">'+e(d)+"</div></a>";l=l+(d.mandatory?"":'<a href="#" class="storeapp-favorite-status"><div class="storeapp-favorite-icon"></div></a>')+'<a href="#" class="storeapp-action-link theme-highlight-color"><div class="storeapp-action-link-sprite"></div></a><div class="arrow-up theme-highlight-border-color"></div><div class="storeapp-details-dropdown theme-highlight-border-color hidden"></div>';
return g+=l+"</li>"}function e(a){a=a.rating;if(!a)return"";var b=a.avgRating;"string"===typeof b&&(b=parseFloat(b));b="<div class='yellowStar' style='width:"+14*b+"px;'></div><div class='grayStar' style='width:"+14*(5-b)+"px; background-position-x:-"+14*(1-(b-Math.floor(b)))+"px;'></div>";null!=a.countReviewer&&(b+="<div class='rating-count'>("+a.countReviewer+")</div>");return b}function k(a,b){return b.find('.storeapp[data-shortid="'+a.shortid+'"]')}function h(a,b){g||(g=new CTXS.AnimatedSpinner);
var d=k(a,b),c=k(a,b).find(".storeapp-loading-overlay"),l=c.find(".storeapp-loading-spinner"),d=d.find(".storeapp-details-link");g.stop(l,c);d.css("cursor","auto")}var g=null,l=c(".myapps-ruler-container"),m=[];window.CTXS=window.CTXS||{};CTXS.Views=CTXS.Views||{};CTXS.Views.AppView={patch:function(a){eval(a)},getAppName:f,getMarkup:function(a,b){b=b||f(a);return CTXS.ExtensionsHead.isDefined("getAppTileMarkup")?CTXS.ExtensionsHead.getAppTileMarkup(a,b,function(){return d(a,b)}):d(a,b)},updateAppState:function(b,
d){CTXS.trace("Updating status of app:"+b.id);var c=k(b,d),l=!b.isLaunchInProgress;g||(g=new CTXS.AnimatedSpinner);for(var h in CTXS.App.State)CTXS.App.State.hasOwnProperty(h)&&c.removeClass(CTXS.App.State[h]);for(var e in CTXS.App.InstallState)CTXS.App.InstallState.hasOwnProperty(e)&&c.removeClass(CTXS.App.InstallState[e]);c.removeClass("newinstalled");l&&(c.removeClass("operation-in-progress"),g.stop(c.find(".storeapp-loading-spinner"),c.find(".storeapp-loading-overlay")));c.addClass(b.getState());
l=b.getInstallationState();l!==CTXS.App.InstallState.NOT_INSTALLABLE&&c.addClass(l);l===CTXS.App.InstallState.INSTALLED&&b.isNewInstall&&(c.addClass("newinstalled"),CTXS.Controllers.StoreAppListViewController.updateNewInstallStatus());c.find(".install-message").text(a(b));b.isAddInProgress||b.isRemoveInProgress||(c.removeClass("favoriteDisabled"),CTXS.Device.isIE11&&c.find(".storeapp-favorite-icon").css("transform","none"));CTXS.trace("Updated status of app:"+b.id)},hideAppLaunchSpinner:function(a,
b){k(a,b).removeClass("operation-in-progress");h(a,b)},showAppSpinner:function(a,b){g||(g=new CTXS.AnimatedSpinner);var d=k(a,b),c=d.find(".storeapp-loading-overlay"),l=c.find(".storeapp-loading-spinner"),d=d.find(".storeapp-details-link");g.start(l,c);d.css("cursor","default")},hideAppSpinner:h,showAppReadyToLaunchUI:function(a,b){k(a,b).addClass("launch-ready")},hideAppReadyToLaunchUI:function(a,b){k(a,b).removeClass("launch-ready")},getAppShortId:function(a){return a.data("shortid")},enableAppFavorite:function(a,
b){k(a,b).removeClass("favoriteDisabled")},disableAppFavorite:function(a,b){k(a,b).addClass("favoriteDisabled")}};CTXS.Views.AppView.Settings={NameWidth:function(){switch(CTXS.UI.getCardSize()){case "tile":case "small":return 120;default:return 140}},NameMaxLines:function(){return 2}}})(jQuery);
(function(c){var f={filters:[],tabs:[],closeBtnClass:"",underlineHighlightClass:"",useSubMenu:!0,animationTime:300,easingStyle:"easeInOutCubic"};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.AppViewToolbarController=function(b,a,d,e,k,h,g){var l=this;this.options=c.extend({},f,g);this.$toolbar=b;this.$subMenu=a;this.$movingPanel=d;this.$closeBtn=a.find(this.options.closeBtnClass);this.animating=!1;this.selectedTab=this.activeOption=null;b={animating:function(){return l.animating},
getActiveOption:function(){return l.getActiveOption()},setActiveOption:function(a){l._setActiveOption(a)},showOption:function(a){l.showOption(a)}};b=c.extend({},b,this.options);this.toolbarWidget=new CTXS.Widgets.AppViewToolbarWidget(this.$toolbar,this.$movingPanel,h,b);this._bindToAppEvents();this.slidingWidget=new CTXS.Widgets.SlidingSubMenuWidget(this.$subMenu,this.$closeBtn,this.$movingPanel,{onCancel:function(){l.showOption(l.getActiveOption())},registerAnimationFinish:function(){l.toolbarWidget.setActionInProgress(!1)},
underlineElement:this.options.underlineHighlightClass});this.$slideEffectContainer=c(".slideAnimation");this.$slidingHighlight=this.$toolbar.find(".sliding-highlight");this.$toolbarScroll=c(".store-toolbar-phone");this.returning=!1;this.navigateToTab=e;this.previousOption=null;CTXS.UI.useSmallTiles()||this.$toolbar.find("a").addClass("theme-highlight-color");this.updateFolderToolbar=k};CTXS.Controllers.AppViewToolbarController.prototype={_bindToAppEvents:function(){var b=this;CTXS.Events.subscribe(CTXS.Events.ui.showDesktops,
function(){b._showOptions()});CTXS.Events.subscribe(CTXS.Events.ui.showMyHome,function(){b._hideOptions();b._resetToDefaultOption()});CTXS.Events.subscribe(CTXS.Events.ui.showMyApps,function(){b._hideOptions()});CTXS.Events.subscribe(CTXS.Events.ui.showTasks,function(){b._hideOptions();b._resetToDefaultOption()});CTXS.Events.subscribe(CTXS.Events.ui.showSearchResults,function(){b.returning=!0;b._hideOptions()});CTXS.Events.subscribe(CTXS.Events.ui.showBundleDetails,function(){b._hideOptions()});CTXS.Events.subscribe(CTXS.Events.ui.showAllApps,
function(){b._showOptions()});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetails,function(){b._showDetailsCase()});CTXS.Events.subscribe(CTXS.Events.store.appStatusChange,function(){b._updateFilterLabels()})},_setActiveOption:function(b,a){var d=this;if(b!==this.activeOption){this.activeOption&&!this.activeOption.isFilter&&this.activeOption.widget.clearSelections();if(a){var e=d.$toolbar.find(d.activeOption.selector),k=e.width()+"px",h=e.position().left+parseFloat(e.css("margin-left")),g=d.$toolbar.find(b.selector),
e=g.width()+"px",l=g.position().left+parseFloat(g.css("margin-left")),m=!1;d.$slidingHighlight.velocity({"min-width":e,left:l},{begin:function(){d.$slidingHighlight.stop().css({"min-width":k,left:h}).show();d.toolbarWidget.toggleActive(d.activeOption,!0);m=g.hasClass("selected");g.removeClass("selected")},duration:d.options.animationTime,easing:d.options.easingStyle,complete:function(){d.toolbarWidget.toggleActive(b,!0);m&&g.addClass("selected");d.$slidingHighlight.stop().hide()}});var e=c(".theme-highlight-color").first(),
e=CTXS.parseColor(e.css("color")),e=CTXS.RgbToHex(e[0],e[1],e[2]),f=c(b.selector);f.velocity({color:e},{begin:function(){c(d.activeOption.selector).removeClass("theme-highlight-color")},duration:d.options.animationTime,easing:d.options.easingStyle,queue:!1,complete:function(){f.addClass("theme-highlight-color");f.removeAttr("style")}});e=-(d.$movingPanel.width()-g.width())/2-d.$toolbarScroll.scrollLeft();g.velocity("scroll",{axis:"x",container:d.$toolbarScroll,offset:e,duration:d.options.animationTime})}else this.activeOption&&
this.toolbarWidget.toggleActive(this.activeOption),b&&this.toolbarWidget.toggleActive(b);(this.activeOption=b)?CTXS.trace("Option changed to : "+b.name):CTXS.trace("Option cleared")}},_resetToDefaultOption:function(){var b=this;this.$movingPanel.velocity("finish");this.$slideEffectContainer.velocity("finish");this.$slidingHighlight.velocity("finish");setTimeout(function(){b._setSelectedTab(null);b._setActiveOption(null);b.toolbarWidget.clearTabFilterItemSelections();b.updateFolderToolbar();b.showOption(b.toolbarWidget.defaultFilterOption)},
1)},_hideOptions:function(){this.hideSliderNoAnimate();this.toolbarWidget.hideAllButtons()},_showOptions:function(){this.toolbarWidget.hideAllButtons();this.toolbarWidget.updateFilterLabels();this.toolbarWidget.showAllButtons();this.returning?(this.navigateToTab(),this.returning=!1):this._resetToDefaultOption()},_updateFilterLabels:function(){"store"!==CTXS.currentView&&"desktops"!==CTXS.currentView||this.toolbarWidget.updateFilterLabels()},_showDetailsCase:function(){"store"!==CTXS.Controllers.ViewController.getSavedView()&&
"desktops"!==CTXS.Controllers.ViewController.getSavedView()?(this._hideOptions(),this.$toolbar.removeClass("show")):this.$toolbar.addClass("show")},_setSelectedTab:function(b){b!==this.selectedTab&&(this.selectedTab&&this.toolbarWidget.toggleSelected(this.selectedTab),null!==b?this.toolbarWidget.toggleSelected(b):this.selectedTab.hideFilterWidget(),this.selectedTab=b)},positionSelect:function(){this.$toolbar.find(".tab-button").each(function(b,a){var d=c(a),e=d.find("span"),k=d.offset().left+d.width(),
e=e.offset().left+e.width(),k=k-e,k=d.is(".phone-toolbar-button")?k-14:k+17.5;d.find(".select-icon").css("right",k)})},getActiveOption:function(){return this.activeOption},hideSliderNoAnimate:function(){this.slidingWidget.hideNoAnimate()},changeOption:function(b,a,d,c){var k=this,h=k.$movingPanel.html();b.showFilter?b.showFilter():this.returning||b.showFilterWidget();if(a){var g=d<c?document.documentElement.clientWidth:-document.documentElement.clientWidth;k.$slideEffectContainer.velocity({left:-g},
{begin:function(){k.animating=!0;k.$slideEffectContainer.html(h);k.$slideEffectContainer.stop().css({left:0}).show()},queue:!1,duration:k.options.animationTime,easing:k.options.easingStyle,complete:function(){k.$slideEffectContainer.stop().hide();k.$slideEffectContainer.empty();k.animating=!1}});k.$movingPanel.velocity({left:0},{begin:function(){k.$movingPanel.stop().css({left:g})},queue:!1,duration:k.options.animationTime,easing:k.options.easingStyle})}},showOption:function(b){var a=this,d=this.activeOption?
a.$toolbar.find(this.activeOption.selector).index():null,e=b?a.$toolbar.find(b.selector).index():null,k=CTXS.UI.useSmallTiles()&&null!==d&&null!==e&&d!==e;b.isFilter?(this.activeOption!==b&&this._setActiveOption(b,k),this.selectedTab&&!this.returning&&(this.selectedTab.hideFilterWidget(),this._setSelectedTab(null)),this.returning?this.slidingWidget.showPaneIfVisible():this.slidingWidget.hidePaneIfVisible(),this.changeOption(b,k,d,e)):this.options.useSubMenu?this.selectedTab===b?(this.returning?this.slidingWidget.showPaneIfVisible():
this.slidingWidget.togglePane(),this.activeOption!==b&&this.selectedTab&&this._setSelectedTab(null)):null===this.selectedTab?(this._setSelectedTab(b),this.changeOption(b,k,d,e),this.slidingWidget.showPane(b.postOnClick)):this.returning?(this.slidingWidget.showPaneIfVisible(),a.changeOption(b,k,d,e)):this.slidingWidget.hidePaneIfVisible(function(){a.selectedTab&&a.selectedTab.hideFilterWidget();c.isFunction(b.preOnClick)&&b.preOnClick();a._setSelectedTab(b);a.changeOption(b,k,d,e);a.slidingWidget.showPane(b.postOnClick)}):
(this.selectedTab!==b&&(this._setSelectedTab(b),this._setActiveOption(b,k)),this.changeOption(b,k,d,e),this.slidingWidget.hidePaneIfVisible())}}})(jQuery);
(function(c){var f={tabs:[],filters:[],showOption:function(){},filterPrefix:".filter-button",tabPrefix:".tab-button"},b={name:"",label:"",generate:!1,selector:{},isFilter:!1,hideForDesktops:!1,widget:{},preOnClick:c.noop,postOnClick:c.noop,showFilterWidget:c.noop,hideFilterWidget:c.noop},a={name:"",label:c.noop,selector:{},isFilter:!0,isDefault:!1,showFilter:c.noop};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AppViewToolbarWidget=function(a,b,k,h){this.options=c.extend({},
f,h);this.$toolbar=a;this.$movingPanel=b;this.clearNavigationHistory=k;this.tabs=[];this.filters=[];this.buttonCount=0;this.defaultFilterOption=null;this._processTabs(this.options.tabs);this._processFilters(this.options.filters);this.actionInProgress=!1;this._bindToUIEvents()};CTXS.Widgets.AppViewToolbarWidget.prototype={updateFilterLabels:function(){var a=this;c.each(a.filters,function(b,c){var h=a.$toolbar.find(c.selector);h.find("span")&&CTXS.UI.useSmallUILayout()?h.find("span").text(c.label()):
h.text(c.label())})},showButton:function(a,b){this.$toolbar.find(a.selector).addClass("show");b||this._updateButtonCount()},showAllButtons:function(){var a=this;c.each(this.filters,function(b,c){a.showButton(c,!0)});c.each(this.tabs,function(b,c){a.showButton(c,!0)});this._updateButtonCount()},hideButton:function(a,b){this.$toolbar.find(a.selector).removeClass("show");b||this._updateButtonCount()},hideAllButtons:function(){var a=this;c.each(this.filters,function(b,c){a.hideButton(c,!0)});c.each(this.tabs,
function(b,c){a.hideButton(c,!0)});this._updateButtonCount()},setActionInProgress:function(a){this.actionInProgress=a||!1},toggleActive:function(a,b){c(a.selector).toggleClass("active");c(a.selector).attr("aria-selected",c(a.selector).hasClass("active"));!b&&CTXS.UI.useSmallTiles()&&c(a.selector).filter(".phone-toolbar-button").toggleClass("theme-highlight-color")},toggleSelected:function(a){c(a.selector).toggleClass("selected")},clearTabFilterItemSelections:function(){c.each(this.tabs,function(a,
b){b.widget&&b.widget.clearSelections()})},_processTabs:function(a){var e=this;c.each(a,function(a,d){var g=c.extend({},b,d);g.selector=e.options.tabPrefix+g.selector;var l=e.$toolbar.find(g.selector);""!==g.label&&(l.find("span")?l.find("span").text(g.label):l.text(g.label));!0===g.hideForDesktops&&l.addClass("hideForDesktopView");e._bindToOptionUIEvents(g);e._bindToTabWidgetItems(g);e.tabs.push(g)})},_updateButtonCount:function(){var a=this._getAllVisibleButtons().length;this.$toolbar.toggleClass(this._generateButtonCountClass(this.buttonCount),
!1);this.$toolbar.toggleClass(this._generateButtonCountClass(a),!0);this.buttonCount=a},_generateButtonCountClass:function(a){return"button-count-"+a},_getSelectorStringForAllButtons:function(){return this.options.tabPrefix+", "+this.options.filterPrefix},_getAllVisibleButtons:function(){return c(this._getSelectorStringForAllButtons()).filter(":visible")},_processFilters:function(b){var e=this;c.each(b,function(b,d){var g=c.extend({},a,d);g.selector=e.options.filterPrefix+g.selector;e._bindToOptionUIEvents(g);
g.isDefault&&(e.defaultFilterOption=g);e.filters.push(g)})},_navigateToOption:function(a,b){for(var k=b[a],h=null,g=0;!h&&g<this.filters.length;g++)c(k).is(this.filters[g].selector)&&(h=this.filters[g]);for(g=0;!h&&g<this.tabs.length;g++)c(k).is(this.tabs[g].selector)&&(h=this.tabs[g]);this.options.showOption(h)},_bindToOptionUIEvents:function(a){var b=this;c(a.selector).on("click",function(c){c.preventDefault();b.actionInProgress||b.options.animating()||(a.isFilter&&b.clearNavigationHistory(),b.setActionInProgress(!0),
b.options.showOption(a))})},_bindToTabWidgetItems:function(a){var b=this;if(a.widget){var k=a.widget.getFiltersItems();c.each(k,function(h,g){c(c(g).find("a")).on("click",function(c){b.options.setActiveOption(a)})})}},_bindToUIEvents:function(){var a=this,b=new Hammer.Manager(a.$movingPanel[0],{touchAction:"auto",inputClass:Hammer.SUPPORT_POINTER_EVENTS?Hammer.PointerEventInput:Hammer.TouchInput,recognizers:[[Hammer.Swipe,{direction:Hammer.DIRECTION_HORIZONTAL}]]});b.on("swiperight",function(b){var c=
a._getAllVisibleButtons(),g=c.index(c.filter(".active"));b.srcEvent.stopPropagation();CTXS.UI.useSmallTiles()&&!a.actionInProgress&&!a.options.animating()&&1<c.length&&0<g&&(a.setActionInProgress(!0),a._navigateToOption(g-1,c))});b.on("swipeleft",function(){var b=a._getAllVisibleButtons(),c=b.index(b.filter(".active"));CTXS.UI.useSmallTiles()&&!a.actionInProgress&&!a.options.animating()&&1<b.length&&c<b.length-1&&(a.setActionInProgress(!0),a._navigateToOption(c+1,b))})}}})(jQuery);
(function(c){var f={onAuthenticationSuccess:function(){},onAuthenticationError:function(){},onComplete:function(){}};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.AuthenticationController=function(b,a,d,e){this.options=c.extend({},f,e);this.$authenticationView=b;this.$explicitAuthView=a;this.$passwordExpiryView=d;this.$passwordExpiryContainer=this.$passwordExpiryView.find(".authentication-content");this.authenticationMethods=null;this.authenticationWidget=new CTXS.Widgets.AuthenticationWidget(this.$authenticationView.find(".authentication-content"));
this.changePasswordController=new CTXS.Controllers.ChangePasswordController(this.$passwordExpiryContainer,e)};CTXS.Controllers.AuthenticationController.prototype={authenticate:function(b){b=CTXS.Authentication.parseChallenge(b);"Redirect"==b.mode?(CTXS.trace("redirecting for 3rd party authentication"),window.location.href=b.location):!CTXS.Authentication.isBrowserCloseRequiredToEndSession()||CTXS.allowSmartcardRelogin||CTXS.allowReloginWithoutBrowserClose?CTXS.Authentication.getAuthenticationMethods(b.location,
c.proxy(this._processAuthenticationMethods,this),this._handleAuthenticationFailure):(this.$authenticationView.ctxsDisplayPane(),this.authenticationWidget.showCloseBrowserMessage(CTXS.Authentication.isSmartcardSession()))},_processAuthenticationMethods:function(b){this.authenticationMethods=b;0==b.length?(this.$authenticationView.ctxsDisplayPane(),this.authenticationWidget.showNoAuthenticationMethodsMessage()):1==b.length?this._performAuthentication(b[0]):(b=CTXS.Authentication.getSavedAuthenticationMethod())?
this._performAuthentication(b):this._showAuthenticationChoices()},_showAuthenticationChoices:function(){var b=this,a=this.authenticationMethods[0].name==CTXS.Authentication.Method.PASSTHROUGH?"LogonTextPassthrough":"LogonTextSmartcard";this.$authenticationView.ctxsDisplayPane();this.authenticationWidget.showAuthenticationChoices({titleText:c.localization.string(a),authenticationMethods:this.authenticationMethods,onChoiceSelection:function(a){c("body").find(".loading-screen").ctxsDisplayPane();b._performAuthentication(a)}})},
_performAuthentication:function(b){var a=this;b.name==CTXS.Authentication.Method.EXPLICIT||b.name==CTXS.Authentication.Method.GENERIC_FORMS?(this.explicitAuthController||(this.explicitAuthController=new CTXS.Controllers.ExplicitAuthController(this.$explicitAuthView,{prepopulatedCredentials:CTXS.Config.getConfigValue("prePopulatedCredentials"),showBackToChoicesLink:1<this.authenticationMethods.length,onAuthenticationSuccess:function(d){a._completeAuthentication(b,d)},onLogonTimeout:c.proxy(this._handleLogonTimeout,
this),onAuthenticationError:this.options.onAuthenticationError,onBackToChoices:c.proxy(this._showAuthenticationChoices,this)})),this.explicitAuthController.authenticate(b.url)):b.name!=CTXS.Authentication.Method.PASSTHROUGH&&b.name!=CTXS.Authentication.Method.SMARTCARD&&b.name!=CTXS.Authentication.Method.GATEWAY||CTXS.Authentication.authenticate(b.url,function(d){a._completeAuthentication(b,d)},function(){a._handleAuthenticationFailure(b)})},_handleLogonTimeout:function(){this.$authenticationView.ctxsDisplayPane();
this.authenticationWidget.showLogonTimeoutMessage(function(){document.location.reload(!1)})},_completeAuthentication:function(b,a){1<this.authenticationMethods.length&&CTXS.Authentication.setSavedAuthenticationMethod(b);CTXS.Authentication.setUserAuthenticated(!0);CTXS.Authentication.currentAuthMethod=b.name;CTXS.Authentication.setPasswordChangeAllowed(a.isPasswordChangeAllowed);CTXS.Authentication.setIdpLogoffUrl(a.webLogoffUrl);this.options.onAuthenticationSuccess();if(a.isPasswordExpiryNotificationEnabled)this.$passwordExpiryView.ctxsDisplayPane(),
this.changePasswordController.showPasswordExpiryMessage(a.passwordExpiryTime);else this.options.onComplete()},_handleAuthenticationFailure:function(b){CTXS.Authentication.clearSavedAuthenticationMethod();if(b.name==CTXS.Authentication.Method.GATEWAY)this.options.onAuthenticationError();else{var a=this,d=b.name==CTXS.Authentication.Method.PASSTHROUGH?"AuthFailurePassthrough":"AuthFailureSmartcard";this.$authenticationView.ctxsDisplayPane();this.authenticationWidget.showAuthenticationFailureMessage({titleText:c.localization.string(d),
otherOptionsAvailable:1<this.authenticationMethods.length,onTryAgain:function(){a._performAuthentication(b)},onTryAnotherOption:c.proxy(this._showAuthenticationChoices,this)})}}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AuthenticationWidget=function(c){this.$container=c};CTXS.Widgets.AuthenticationWidget.prototype={showCloseBrowserMessage:function(f){this._clearContainer();f=f?c.localization.string("AuthFailureSmartcard"):c.localization.string("AuthFailureGeneric");this._addTitle(f);this.$container.append('<p class="detail-text">'+c.localization.string("CloseYourBrowserToProtectAccount")+"</p>")},showAuthenticationChoices:function(f){var b=
c.extend({},{titleText:"",authenticationMethods:[],onChoiceSelection:function(a){}},f);this._clearContainer();this._addTitle(b.titleText);f=c('<a href="#" class="default button" data-index="0">'+c.localization.string("LogOn")+"</a>");this.$container.append(f);for(var a=1;a<b.authenticationMethods.length;a++){var d=b.authenticationMethods[a].name,e=null;d==CTXS.Authentication.Method.SMARTCARD?e=c.localization.string("SwitchToSmartcard"):d==CTXS.Authentication.Method.EXPLICIT?e=c.localization.string("SwitchToExplicit"):
d==CTXS.Authentication.Method.GENERIC_FORMS&&(e=c.localization.string("SwitchToGeneric"));e&&this.$container.append('<p><a href="#" data-index="'+a+'" class="auth-choice-link authentication-link">'+e+"</a></p>")}f.add(this.$container.find(".auth-choice-link")).on("click",function(a){a.preventDefault();a=c(this).data("index");b.onChoiceSelection(b.authenticationMethods[a])});f.focus()},showLogonTimeoutMessage:function(f){this._clearContainer();this._addTitle(c.localization.string("LoginTimedOut"));
var b=c('<a href="#" class="default button">'+c.localization.string("LogOn")+"</a>");this.$container.append(b);b.on("click",function(a){a.preventDefault();f()});b.focus()},showAuthenticationFailureMessage:function(f){f=c.extend({},{titleText:"",otherOptionsAvailable:!1,onTryAgain:function(){},onTryAnotherOption:function(){}},f);this._clearContainer();this._addTitle(f.titleText);var b=f.otherOptionsAvailable?f.onTryAnotherOption:f.onTryAgain;f=c('<a href="#" class="authentication-link">'+c.localization.string(f.otherOptionsAvailable?
"TryAnotherLogonOption":"TryAgain")+"</a>");this.$container.append(f);f.on("click",function(a){a.preventDefault();b()});f.focus()},showNoAuthenticationMethodsMessage:function(){this._clearContainer();this._addTitle(c.localization.string("NoAvailableAuthMethods"))},_clearContainer:function(){this.$container.empty()},_addTitle:function(c){this.$container.append('<h1 class="authentication-title main-text">'+c+"</h1>")}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AuthPasswordExpiryWidget=function(c,b){this.$container=c;this.isGatewaySession=b};CTXS.Widgets.AuthPasswordExpiryWidget.prototype={showPasswordExpiryMessage:function(f,b){b=c.extend({},{onContinue:function(){},onChange:function(){}},b);this._setMessageText(this._getExpirationText(f));var a=this.$container.find("#btnPasswordChange"),d=this.$container.find("#btnPasswordContinue");a.prop("disabled",!1);d.prop("disabled",
!1);a.on("click",function(c){c.preventDefault();a.prop("disabled")||(b.onChange(),a.prop("disabled",!0))});d.on("click",function(a){a.preventDefault();d.prop("disabled")||(b.onContinue(),d.prop("disabled",!0))});a.focus();this.$container.on("keydown",function(a){a.keyCode===c.ui.keyCode.ESCAPE&&d.click()})},_getExpirationText:function(f){switch(f){case 0:return c.localization.string("PasswordExpiresTodayMessage");case 1:return c.localization.string("PasswordExpiresTomorrowMessage");default:return c.localization.string("PasswordExpiryMessage",
f)}},_setMessageText:function(c){this.$container.find(".authentication-message").text(c)}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.AutoMessageWidget=function(c,b){this.$messageBox=c;this.$overlay=b;this._bindToUiEvents()};CTXS.Widgets.AutoMessageWidget.prototype={show:function(f){f=c.extend({messageText:"",waitingTime:3200},f);this.$messageBox.html(f.messageText);this.$messageBox.ctxsCenter();CTXS.displayPopup(this.$overlay,this.$messageBox);setTimeout(c.proxy(this.hide,this),f.waitingTime)},hide:function(){CTXS.fadePopup(this.$overlay,this.$messageBox)},
_bindToUiEvents:function(){var c=this;this.$overlay.click(function(b){b.preventDefault();c.hide()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};var f={onComplete:function(){}};CTXS.Controllers.ChangeClientController=function(b){this.options=c.extend({},f,b);this.changeClientWidget=new CTXS.Widgets.ChangeClientWidget(c("#change-client-screen"),{onUseLightVersion:c.proxy(this._onUseLightVersion,this),onUseFullVersion:c.proxy(this._onUseFullVersion,this)})};CTXS.Controllers.ChangeClientController.prototype={showUI:function(){var b=!CTXS.Html5Client.isCurrentClient();
this.changeClientWidget.showUI(b)},_onUseLightVersion:function(){CTXS.ClientManager.setHtml5ClientPreferred();this.options.onComplete()},_onUseFullVersion:function(){CTXS.ClientManager.setNativeClientPreferred();this.options.onComplete()}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={onUseLightVersion:function(){},onUseFullVersion:function(){}};CTXS.Widgets.ChangeClientWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$element=b.find(".changeclient-container");this.$useLightLink=this.$element.find(".changeclient-use-light-version");this.$useFullLink=this.$element.find(".changeclient-use-full-version");this.$headingText=this.$element.find(".changeclient-heading");this._bindToUIEvents()};
CTXS.Widgets.ChangeClientWidget.prototype={showUI:function(b){this.$headingText.text(c.localization.string(b?"UsingFullVersion":"UsingLightVersion"));this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$useLightLink.click(function(a){a.preventDefault();b.options.onUseLightVersion()});this.$useFullLink.click(function(a){a.preventDefault();b.options.onUseFullVersion()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};var f={overlaySelector:"",onComplete:function(){},onAuthenticationError:function(){},onAuthenticationCancel:function(){},isDialog:!1};CTXS.Controllers.ChangePasswordController=function(b,a){var d=this;this.options=c.extend({},f,a);this.$container=b;this.$overlay=c(this.options.overlaySelector);this.isGatewaySession=CTXS.Environment.isGatewaySession();this.options.isDialog?(this.displayWidget=new CTXS.Widgets.ElectivePasswordChangeWidget(this.$container,
this.options.overlaySelector,this.isGatewaySession),this.options.beforeDisplayForm=function(){d.displayWidget.cleanDialog()},this.options.displayForm=function(){d.displayWidget.centerAndDisplayDialog()}):this.displayWidget=new CTXS.Widgets.AuthPasswordExpiryWidget(this.$container,this.isGatewaySession);this._bindToUIEvents();this._bindToAppEvents()};CTXS.Controllers.ChangePasswordController.prototype={showPasswordExpiryMessage:function(b){var a=this,c={onChange:function(){a.requestPasswordChangeUI()},
onContinue:a.options.onComplete};this.options.isDialog||this.displayWidget.showPasswordExpiryMessage(b,c)},requestPasswordChangeUI:function(){if(this.isGatewaySession){var b=this;CTXS.Environment.showDialog({messageText:c.localization.string("AccessGatewayChangePasswordWarning"),buttonLabel:c.localization.string("Continue"),buttonAction:function(){b._showChangePasswordUI()},cancelButtonLabel:c.localization.string("Cancel"),cancelButtonAction:c.noop})}else this._showChangePasswordUI()},_escapeToCancel:function(b){if(b.keyCode===
c.ui.keyCode.ESCAPE)this.options.onAuthenticationCancel()},_showChangePasswordUI:function(){var b=this;this.$container.ctxsFormsAuthentication({informationIconUrl:CTXS.Device.supportsHighResDisplay()?"receiver/images/2x/ico_info@2x_1741F6D219FB5DFB.png":"receiver/images/1x/ico_info_853898A513144801.png",authenticationError:function(){b._cleanUp();b.options.onAuthenticationError()},authenticationCancel:function(){b._onAuthCancel(b.options.isDialog)},authenticationSuccess:function(){b._onAuthSuccess(b.options.isDialog)},beforeDisplayForm:b.options.beforeDisplayForm,
displayForm:b.options.displayForm,formProvider:function(a,d,e,k){CTXS.AuthClient.getAuthenticationForm(a,d,e,function(a,b,c){k(a,c.getResponseHeader("X-Citrix-ExplicitAuthProtocol"))},c.proxy(b.options.onAuthenticationError,this))}});this.$container.ctxsFormsAuthentication("startAuthentication",CTXS.Config.getConfigValue("authManager.changeCredentialsURL"))},_centerAndDisplayDialog:function(){this.$container.ctxsCenter();CTXS.displayPopup(this.$overlay,this.$container)},_cleanUp:function(){this.$container.find('input[type="password"]').ctxsObliteratePassword()},
_cancelChange:function(){this._clearDialog();CTXS.hidePopup(this.$overlay,this.$container)},_onAuthCancel:function(b){if(b)this._cleanUp(),this.displayWidget.hideAndClearDialog(),this.options.onAuthenticationCancel();else this.options.onComplete()},_onAuthSuccess:function(b){this.isGatewaySession?CTXS.Events.publish(CTXS.Events.ui.logoffRequested,{icaSessionLogoffAction:CTXS.ICA_SESSION_LOGOFF_ACTION.DISCONNECT}):(b&&(this._cleanUp(),this.displayWidget.hideAndClearDialog()),this.options.onComplete())},
_bindToAppEvents:function(){var b=this;this.options.isDialog&&(CTXS.Events.subscribe(CTXS.Events.session.terminating,function(){b.displayWidget.hideAndClearDialog()}),CTXS.Events.subscribe(CTXS.Events.ui.showMessage,function(a,c){b.displayWidget.isVisible()&&b.displayWidget.hideAndClearDialog()}))},_bindToUIEvents:function(){var b=this;this.$container.on("keydown",function(a){b._escapeToCancel(a)});if(this.options.isDialog)this.$overlay.on("click",function(a){a.preventDefault();b.displayWidget._placeFocus()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};var f={overlaySelector:"",onComplete:function(){},onAuthenticationError:function(){},onAuthenticationCancel:function(){}};CTXS.Controllers.AccountManagementController=function(b,a){var d=this;this.options=c.extend({},f,a);this.$container=b;this.$overlay=c(this.options.overlaySelector);this.isGatewaySession=CTXS.Environment.isGatewaySession();this.AccountManagementURL="";this.isGatewaySession||CTXS.Device.isMobileDevice()||
(this.displayWidget=new CTXS.Widgets.ElectivePasswordChangeWidget(this.$container,this.options.overlaySelector,this.isGatewaySession),this.options.beforeDisplayForm=function(){d.displayWidget.cleanDialog()},this.options.displayForm=function(a,b){var h=b.authenticationElement;h.find(".standaloneText").not(".confirmation").not(".error").addClass("standaloneText2");h.find(".confirmation").addClass("confirmation2");if(h.find("#link_BackBtnId").length){var h=h.find("#link_BackBtnId"),g=h.parent(),l=c("<div class='left multiple-buttons'></div>");
h.removeClass("forms-authentication-button");l.append(h);g.before(l)}d.displayWidget.centerAndDisplayDialog()},this._bindToUIEvents(),this._bindToAppEvents())};CTXS.Controllers.AccountManagementController.prototype={requestAccountManagementUI:function(){this.isGatewaySession||CTXS.Device.isMobileDevice()||this._showAccountManagementUI()},setAccountManagementURL:function(b){this.AccountManagementURL=b},_escapeToCancel:function(b){if(b.keyCode===c.ui.keyCode.ESCAPE)this.options.onAuthenticationCancel()},
_showAccountManagementUI:function(){var b=this;this.$container.ctxsFormsAuthentication({prePopulatedCredentials:{},informationIconUrl:CTXS.Device.supportsHighResDisplay()?"receiver/images/2x/ico_info@2x_1741F6D219FB5DFB.png":"receiver/images/1x/ico_info_853898A513144801.png",authenticationError:function(){b._cleanUp();b.options.onAuthenticationError()},authenticationCancel:function(){b._onAuthCancel()},authenticationSuccess:function(){b._onAuthSuccess()},beforeDisplayForm:b.options.beforeDisplayForm,displayForm:b.options.displayForm,
formProvider:function(a,d,e,k){CTXS.Device.isNativeClient()&&c.extend(e,{"Accept-Language":CTXS.Environment.getPreferredLanguages()});CTXS.AuthClient.getAuthenticationForm(a,d,e,function(a,b,c){k(a,c.getResponseHeader("X-Citrix-ExplicitAuthProtocol"))},c.proxy(b.options.onAuthenticationError,this))}});this.$container.ctxsFormsAuthentication("startAuthentication",this.AccountManagementURL)},_centerAndDisplayDialog:function(){this.$container.ctxsCenter();CTXS.displayPopup(this.$overlay,this.$container)},
_cleanUp:function(){this.$container.find('input[type="password"]').ctxsObliteratePassword()},_cancelChange:function(){this._clearDialog();CTXS.hidePopup(this.$overlay,this.$container)},_onAuthCancel:function(){this._cleanUp();this.displayWidget.hideAndClearDialog();this.options.onAuthenticationCancel()},_onAuthSuccess:function(){this._cleanUp();this.displayWidget.hideAndClearDialog();this.options.onComplete()},_bindToAppEvents:function(){var b=this;CTXS.Events.subscribe(CTXS.Events.session.terminating,
function(){b.displayWidget.hideAndClearDialog()});CTXS.Events.subscribe(CTXS.Events.ui.showMessage,function(a,c){b.displayWidget.isVisible()&&b.displayWidget.hideAndClearDialog()})},_bindToUIEvents:function(){var b=this;this.$container.on("keydown",function(a){b._escapeToCancel(a)});this.$overlay.on("click",function(a){a.preventDefault();b.displayWidget._placeFocus()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.FormActions={patch:function(c){eval(c)},populateForm:function(f,b){if(null!=b&&!c.isEmptyObject(b)){var a=[];a.push({id:"username",value:(b.domain&&0<b.domain.length?b.domain+"\\":"")+b.username});a.push({id:"password",value:b.password});c.each(a,function(a,b){var k=b.value,h="#"+b.id;c(h+":text",f).addClass("prePopulatedCredential").val(k);c(h+":password",f).addClass("prePopulatedCredential").val(k);c(h+":checkbox",f).addClass("prePopulatedCredential").each(function(){var a=
c(this);"true"==k||"True"==k?a.attr("checked","checked"):a.attr("checked",!1)})})}},disableFormAndShowHourglass:function(f,b){c("body").css("cursor","wait");f.find("input").prop("disabled",!0);var a=b&&b.id?f.find("#"+b.id):c();f.find(".button").not(a).addClass("disabled");a.width(a.width()).text("").addClass("waiting")}}})(jQuery);
(function(c){function f(a,d){var e;e=c(b,a);1<e.length&&CTXS.External.reportParsingError("Can't have more than one CancelButtonText node");1==e.length?(e=e.text(),e=c("<a />").attr("id","chimeraCancelBtn").attr("href","#").addClass("button").addClass("forms-authentication-button").text(e)):e=null;e&&d.append(e)}window.CTXS=window.CTXS||{};var b="CancelButtonText";CTXS.ButtonGenerator={patch:function(a){eval(a)},generateButtons:function(a,b,e){var k=c("<div />").addClass("field").addClass("buttonsrow"),
h=c("<div />").addClass("buttonscontainer").addClass("right");c.each(a,function(a,b){"none"==b.label.type&&"none"==b.credential.type||CTXS.External.reportParsingError("odd button field - it includes a label");var d;d=b.credential.id;var e=b.input.button;d=c("<a />").attr("id",d).attr("href","#").addClass("button").addClass("forms-authentication-button").text(e);h.append(d)});e&&f(b,h);k.append(h);return k}}})(jQuery);
(function(c){function f(a,b){null!=b.input.button&&CTXS.External.reportParsingError("button should have been sorted elsewhere");var d=c("<div/>").addClass("field").addClass("CredentialType"+b.credential.type);CTXS.InputFieldGenerator.addInputFieldOrLabel(d,b);return d}function b(b){var c={};b=d(b,n,"Data");if(null==b||0==b.length)return c;d(b,n,"Item").each(function(){try{var b=d(this,n,"Key").first().text(),g=d(this,n,"Value").first().text();b&&g||CTXS.External.reportParsingError("Item tag is invalid, both a key and a value are required: "+
a(this));c[b]=g}catch(l){CTXS.External.reportParsingError("could not parse extension data item: "+a(this))}});return c}function a(a){return(new XMLSerializer).serializeToString(a)}function d(a,b,d){return c(a).children().filter(function(){return this.namespaceURI==b?(this.localName||this.baseName)==d:!1})}function e(a){var b=c("Type",a);1!=b.length&&CTXS.External.reportParsingError("could not parse label type");var d=b=b.text(),g=CTXS.AuthExtensions.getLabelHandlerByType(b);if(null!=g&&(d=g.parseAsType(),
!d))return a=g.parseLabelNode(a),a.type=b,a;if("none"==d||""==d)return{type:"none"};if("image"==d)return{type:b,src:c("Binary",a).text()};if("plain"==d||"heading"==d||"information"==d||"warning"==d||"error"==d||"confirmation"==d||"inprogress"==d){g=c("Text",a);1!=g.length&&CTXS.External.reportParsingError("could not find text for label");var l=[];c("HighlightFields CredentialID",a).each(function(){var a=c(this).text();l.push(a)});return{type:b,text:g.text(),highlightFields:l}}CTXS.External.reportParsingError("Unrecognised label type :"+
b)}function k(a){if(1!=a.length)return null;var b=c("InitialSelection",a),d=null;1==b.length?d=b.text():1<b.length&&CTXS.External.reportParsingError("must only have one inital selection node");a=h(a,!1);return{initialSelection:d,displayValues:a}}function h(a,b){var d=c("DisplayValues",a);1!=d.length&&CTXS.External.reportParsingError("must have a displayValues node");var g=[];c("DisplayValue",d).each(function(){var a,d=c(this),l=c("Display",d);1!=l.length&&CTXS.External.reportParsingError("Every DisplayValue node must have a Display node");
var h=c("Value",d);1!=h.length&&CTXS.External.reportParsingError("Every DisplayValue node must have a Value node");b&&(a=c("Select",d),1<a.length&&CTXS.External.reportParsingError("Must have at most 1 select node in a DisplayValue node"));a=b?{display:l.text(),value:h.text(),selected:"true"==a.text()||"True"==a.text()}:{display:l.text(),value:h.text()};g.push(a)});return g}function g(a){return c("<select />").attr("id",a.credential.id).attr("name",a.credential.id)}function l(a,b){c.each(a.displayValues,
function(d,g){var l=c("<option/>");l.text(g.display);l.attr("value",g.value);a.initialSelection!=g.value&&!0!=g.selected||l.attr("selected","selected");b.append(l)})}function m(a,b,d){c.each(a.displayValues,function(g,l){var h=l.value+"_id",e;e=l.value;e=c("<input/>").attr("type","radio").val(e).attr("id",h).attr("name",d);a.initialSelection==l.value&&e.attr("checked","checked");var m=c("<p/>");m.append(e);m.append(v(l.display,h));b.append(m)})}function v(a,b){return c("<label />").text(a).attr("for",
b)}window.CTXS=window.CTXS||{};var n="http://citrix.com/authentication/response/extensions/1";CTXS.RequirementNodeProcessor={patch:function(a){eval(a)},addFieldsForEachRequirement:function(a,b,d){var g=0,l=[];CTXS.AuthExtensions.resetAutoPostChecks();CTXS.AuthExtensions.resetAutoPostCallback();a.each(function(){var a=CTXS.RequirementNodeParser.parseRequirementsNode(this);null!=a.input.button?l.push(a):(0<l.length&&(b.append(CTXS.ButtonGenerator.generateButtons(l,d,1>g)),g+=l.length,l=[]),CTXS.AuthExtensions.isAutoPostAddedToForm()?
CTXS.External.reportParsingError("More than one credential in a form containing an auto-post credential is not allowed."):b.append(f(b,a)))});0<l.length&&(b.append(CTXS.ButtonGenerator.generateButtons(l,d,1>g)),g+=l.length);CTXS.AuthExtensions.isAutoPostAddedToForm()&&b.append(CTXS.AuthExtensions.getAutoPostButtonForForm());c("input, select",b).each(function(){c(this).change(function(){c(this).addClass("editedCredential")})})},addLoadingSpinner:function(a,b){var d=c("<div class='spinner' style='visibility: hidden' />").append(c("<img src='"+
b+"' alt='' />"));a.find(".buttonsrow").append(d)}};CTXS.RequirementNodeParser={parseRequirementsNode:function(g){var l=c("Credential",g);1!=l.length&&CTXS.External.reportParsingError("could not parse Credential node");var m=c("Label",g);1!=m.length&&CTXS.External.reportParsingError("could not parse Label node");g=c("Input",g);1!=g.length&&CTXS.External.reportParsingError("could not parse Input node");var f=c("ID",l);1<f.length&&CTXS.External.reportParsingError("could not parse credential id");var v=
null;1==f.length&&(v=f.text());f=c("Type",l);1!=f.length&&CTXS.External.reportParsingError("could not parse credential type");var n;var A={},O=d(l,"http://citrix.com/authentication/response/webview/1","WebView");if(null!=O&&0!=O.length)try{(n=d(O,"http://citrix.com/authentication/response/webview/1","StartUrl"))&&0!=n.length||CTXS.External.reportParsingError("Required <StartUrl> tag not found in webView node: "+a(O[0]));var F=d(O,"http://citrix.com/authentication/response/webview/1","PostData"),F=
null==F||0==F.length?"":F.text(),z=l.parents().last(),x=z.find("StateContext"),x=null==x||0==x.length?"":x.text(),C=z.find("PostBack"),C=null==C||0==C.length?"":C.text(),A={startUrl:n.text(),postData:F,stateContext:x,postbackUrl:C}}catch(I){CTXS.External.reportParsingError("could not parse webview data item: "+a(O[0]))}n=A;l=b(l);l={id:v,type:f.text(),data:l,webview:n};m=e(m);f=c("AssistiveText",g);1<f.length&&CTXS.External.reportParsingError("could not parse input AssistiveText");v=null;1==f.length&&
(v=f.text());n=c("Text",g);if(1!=n.length)f=null;else{f=!1;F=c("Secret",n).text();if("true"==F||"True"==F)f=!0;F=!1;z=c("ReadOnly",n).text();if("true"==z||"True"==z)F=!0;z=c("InitialValue",n).text();n=".+"==c("Constraint",n).text();f={secret:f,readOnly:F,initialValue:z,mustNotBeEmpty:n}}n=c("RadioButton",g);n=k(n);F=k(c("ComboBox",g));z=c("MultiComboBox",g);z=1!=z.length?null:{displayValues:h(z,!0)};x=c("Button",g);x=1!=x.length?null:x.text();C=c("CheckBox",g);if(1!=C.length)g=null;else{g=!1;C=c("InitialValue",
C).text();if("true"==C||"True"==C)g=!0;g={initialValue:g}}return{credential:l,label:m,input:{assistiveText:v,text:f,radioButton:n,comboBox:F,multiComboBox:z,button:x,checkBox:g}}}};CTXS.InputFieldGenerator={addInputFieldOrLabel:function(a,b){var d,h=c("<div/>").addClass("right"),e=CTXS.AuthExtensions.getCredentialHandlerByType(b.credential.type);if(null!=e)if(CTXS.AuthExtensions.isAutoPostAllowed()||!e.isAutoPostCredential){CTXS.LabelGenerator.addLabel(a,b);d=e.getCredentialTypeMarkup(b);if(e.isAutoPostCredential){CTXS.AuthExtensions.autoPostAddedToForm();
var k=CTXS.AuthExtensions.getAutoPostInputField(b);d.append(k);CTXS.AuthExtensions.registerAutoPostCallback(k,b,c.proxy(e.getDataToAutoPost,e))}else CTXS.AuthExtensions.fieldAddedToForm();h.append(d);a.append(h)}else CTXS.External.reportParsingError("More than one field in a form containing an auto-post credential is not allowed.");else null!=b.input.radioButton?(CTXS.LabelGenerator.addLabel(a,b),d=c("<div/>").addClass("radioButtons"),m(b.input.radioButton,d,b.credential.id),d.find("label:first-of-type").after(CTXS.AssistiveTextGenerator.generateInformationIconWithTooltip(b)),
h.append(d),a.append(h),CTXS.AuthExtensions.fieldAddedToForm()):null!=b.input.checkBox?(e=CTXS.AuthExtensions.getLabelHandlerByType(b.label.type),d=c("<input />").attr("id",b.credential.id).attr("name",b.credential.id).attr("type","checkbox").val(b.credential.id),b.input.checkBox.initialValue&&d.addClass("CheckMeWhenInDom"),e=null!=e?e.getLabelTypeMarkup(b):CTXS.LabelGenerator.generateInputLabelNode(b),h.append(d),h.append(e),h.addClass("checkbox"),h.append(CTXS.AssistiveTextGenerator.generateInformationIconWithTooltip(b)),
a.append(h),CTXS.AuthExtensions.fieldAddedToForm()):null!=b.input.comboBox?(CTXS.LabelGenerator.addLabel(a,b),d=g(b),l(b.input.comboBox,d),h.append(d),h.append(CTXS.AssistiveTextGenerator.generateInformationIconWithTooltip(b)),a.append(h),CTXS.AuthExtensions.fieldAddedToForm()):null!=b.input.multiComboBox?(CTXS.LabelGenerator.addLabel(a,b),d=g(b).attr("multiple","multiple"),l(b.input.multiComboBox,d),h.append(d),h.append(CTXS.AssistiveTextGenerator.generateInformationIconWithTooltip(b)),a.append(h),
CTXS.AuthExtensions.fieldAddedToForm()):null!=b.input.text?(CTXS.LabelGenerator.addLabel(a,b),d=CTXS.InputFieldGenerator.generateTextField(b),e=CTXS.AssistiveTextGenerator.generateInlineAssistiveTextNode(b),h.append(e).append(d),a.append(h),CTXS.AuthExtensions.fieldAddedToForm()):null!=b.input.button?CTXS.External.reportParsingError("Buttons should be parsed elsewhere"):CTXS.LabelGenerator.addStandaloneLabel(a,b)},generateTextField:function(a){var b=c("<input />").attr("name",a.credential.id).attr("id",
a.credential.id).val(a.input.text.initialValue);a.input.text.secret?b.attr("type","password"):b.attr("type","text");a.input.text.readOnly&&b.prop("disabled",!0).addClass("alwaysDisabled");a.input.text.mustNotBeEmpty&&(a=function(){var a=c(this);0==a.val().length?a.addClass("InvalidField"):a.removeClass("InvalidField")},b.change(a).keyup(a));return b}};CTXS.AssistiveTextGenerator={informationIconUrl:"",generateInlineAssistiveTextNode:function(a){return(a=a.input.assistiveText)?c("<div>"+a+"</div>").addClass("inlineAssistiveText"):
""},generateInformationIconWithTooltip:function(a){return(a=a.input.assistiveText)?c("<label class='informationAssistive'><img src='"+this.informationIconUrl+"' title='"+a+"' alt='"+a+"'/></label><div class='informationAssistiveTooltip'><p>"+a+"</p></div>"):""}}})(jQuery);
(function(c){function f(a){return c("<img/>").attr("src",a.label.src)}function b(b,d){try{var g=c(c.parseXML("<x>"+b.label.text+"</x>")).contents().contents();a(d,g)}catch(l){CTXS.External.reportParsingError("The label content is not valid: '"+b.label.text+"'")}}function a(b,d){d.each(function(){if(3==this.nodeType)b.append(document.createTextNode(this.nodeValue));else if(1==this.nodeType)if("B"==this.tagName||"b"==this.tagName||"I"==this.tagName||"i"==this.tagName||"U"==this.tagName||"u"==this.tagName){var d=
c("<"+this.tagName+"/>");b.append(a(d,c(this).contents()))}else CTXS.External.reportParsingError("Unsupported tag in a label: "+this.tagName)});return b}function d(a,b){a.addClass("label");switch(b){case "plain":a.addClass("plain");break;case "information":a.addClass("information");a.attr("role","alert");break;case "warning":a.addClass("warning");a.attr("role","alert");break;case "error":a.addClass("error");a.attr("role","alert");break;case "confirmation":a.addClass("confirmation");a.attr("role",
"alert");break;case "inprogress":a.addClass("inprogress");a.attr("role","alert");break;default:var d=CTXS.AuthExtensions.getLabelHandlerByType(b);null!=d?a.addClass(d.getLabelTypeName()):CTXS.External.reportParsingError("unkown label type "+b)}}function e(a,b){var d=c("<div/>").addClass("left").append(b);a.append(d)}window.CTXS=window.CTXS||{};CTXS.LabelGenerator={addLabel:function(a,b){if(b.label&&"none"!=b.label.type){var d;d=CTXS.AuthExtensions.getLabelHandlerByType(b.label.type);null!=d?(d=d.getLabelTypeMarkup(b),
e(a,d)):"image"==b.label.type?e(a,f(b)):(d=CTXS.LabelGenerator.generateInputLabelNode(b),e(a,d))}},addStandaloneLabel:function(a,b){var d=CTXS.AuthExtensions.getLabelHandlerByType(b.label.type);null!=d?(d=d.getLabelTypeMarkup(b),e(a,d)):"image"==b.label.type?e(a,f(b)):this.addStandaloneText(a,b)},addStandaloneText:function(a,h){if(h.label&&"none"!=h.label.type){var g;if("heading"==h.label.type)g=c("<span/>"),b(h,g),g=c("<h1/>").append(g);else{g=c("<div />");g.addClass("standaloneText");var l=c("<div />").addClass("textContent");
b(h,l);g.append(l);d(g,h.label.type)}e(a,g)}},generateInputLabelNode:function(a){var h=c("<label />").attr("for",a.credential.id);h.addClass("label");b(a,h);d(h,a.label.type);return h}}})(jQuery);
(function(c){function f(b,a){var d=c("Label Type",b).text();c("HighlightFields CredentialID",b).each(function(){var b;b=(b=c(this).text())?c(a).find("#"+b):c();b.addClass("highlightedInput");b=c(b).closest(".field").find("label");1!=b.length&&CTXS.External.reportParsingError("Could not find an appropriate number of labels for this Credential ID");b.addClass("highlightedField"+d);b.text("*"+b.text())})}window.CTXS=window.CTXS||{};CTXS.LoginFormGenerator={generateLoginFormFromXml:function(b,a,d){var e=
c("<form class='form insertPoint' action='' />"),k=c("Requirement",b);0==k.length&&CTXS.External.reportParsingError("must have at least one requirement node");CTXS.RequirementNodeProcessor.addFieldsForEachRequirement(k,e,b);CTXS.LabelHighlighter.highlightFieldsThatNeedHighlightingAndTagInputs(k,e);CTXS.FormActions.populateForm(e,a);CTXS.RequirementNodeProcessor.addLoadingSpinner(e,d);return e}};CTXS.LabelHighlighter={highlightFieldsThatNeedHighlightingAndTagInputs:function(b,a){b.each(function(){f(this,
a)})}}})(jQuery);
(function(c){function f(b,a){var d=c("<form/>");d.attr("method","post");d.attr("action",b);c.each(a,function(a,b){var h=c("<input/>");h.attr("type","hidden");h.attr("name",a);h.attr("value",b);d.append(h)});c(document.body).append(d);d.submit()}CTXS.AuthExtensions.addCustomCredentialHandler({RETURN_URL:"_rt",HASH_FRAGMENT:"_hf",STATE_CONTEXT:"_cx",CREDENTIAL_ID:"_id",POST_RETURN_URL:"_ps",CSRF_TOKEN:"_cs",POSTBACK_URL:"_pb",getCredentialTypeName:function(){return"webview"},getDataToAutoPost:function(b,a,
d){if(d=a.credential.webview){b=d.startUrl;var e=b.split("?");b=e.shift();var e=0==e.length?"":e.join("?"),e=CTXS.getParametersFromQueryString(e),k=d.postData,h=!1;k&&(h=!0,k=CTXS.getParametersFromQueryString(k),c.extend(e,k));e[this.CREDENTIAL_ID]=a.credential.id;e[this.STATE_CONTEXT]=d.stateContext;a=CTXS.Config.getConfigValue("authManager.webviewReturnURL");a=CTXS.getAbsoluteUrl(a);e[this.RETURN_URL]=a;k=CTXS.getCSRFToken();e[this.CSRF_TOKEN]=k;CTXS.Config.getConfigValue("authManager.webviewResumeURL")||
(e[this.POSTBACK_URL]=d.postbackUrl);d=CTXS.getUrlHash();""!=d&&(e[this.HASH_FRAGMENT]=d);256<("&"+this.HASH_FRAGMENT+"="+encodeURIComponent(d)+"&"+this.RETURN_URL+"="+encodeURIComponent(a)).length&&CTXS.trace("Hash Fragment and return URL are longer than the specified 256 characters. This may cause issues if the StateContext, ID, and the rest of the start URL are long.");e[this.POST_RETURN_URL]=!0;this.redirectToStartUrl(b,e,h)}else CTXS.trace("Webview credential data not found for this requirement: "+
JSON.stringify(a.credential))},redirectToStartUrl:function(b,a,d){d?f(b,a):(a=c.param(a,!0),window.location=b+"?"+a)}})})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={upgrade:!1,pluginInstallUrl:"",onSkipInstall:function(){},onPluginInstall:function(){}};CTXS.Widgets.PluginDownloadWidget=function(b){this.options=c.extend(f,b);this.$element=null};CTXS.Widgets.PluginDownloadWidget.prototype={showDownloadUI:function(b,a){this.$view=b;this.$element=b.find(".download-plugin");this._bindToUIEvents();this.options.upgrade?(this.$pluginAssistantHeader.text(c.localization.string("ClickUpgrade")),
this.$skipLink.text(c.localization.string("UpgradeLater")),this.$skipLink.attr("title",c.localization.string("UpgradeLaterTip"))):a&&(this.$skipLink.text(c.localization.string("TryLater")),this.$skipLink.attr("title",c.localization.string("SkipThisStep")));this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$chkLegalStatement=this.$element.find(".legalstatement-checkbox");this.$acceptTermsMessage=this.$element.find(".acceptterms-popup");this.$installButton=this.$element.find(".installbutton");
this.$securityDetails=this.$element.find(".securitydetails-popup");this.$licenseAgreement=this.$element.find(".licenseagreement-popup");this.$licenseLink=this.$element.find(".licenseagreement-link");this.$securityDetailsLink=this.$element.find(".securitydetailslink");this.$skipLink=this.$element.find(".pluginassistant-skiplink");this.$pluginAssistantHeader=this.$element.find(".plugin-assistant-header");this.$securityDetailsLink.ctxsAddCustomTooltip(this.$securityDetails,this.$element);this.$licenseLink.ctxsAddCustomTooltip(this.$licenseAgreement,
this.$element);this.$installButton.ctxsAddCustomTooltipForButton(this.$acceptTermsMessage,this.$element);this.$skipLink.click(function(a){a.preventDefault();b.options.onSkipInstall()});this.$chkLegalStatement.change(function(){if(this.checked)b.onTermsAcceptance();else b.onTermsRejection()});this.$installButton.click(function(a){if(c(this).hasClass("disabled"))a.preventDefault();else b.options.onPluginInstall()})},onTermsAcceptance:function(){this.$acceptTermsMessage.hide();this.$installButton.attr("href",
this.options.pluginInstallUrl);this.$installButton.removeClass("disabled")},onTermsRejection:function(){this.$installButton.attr("href","#");this.$installButton.addClass("disabled")},showDownloadUnavailableUI:function(b){this.$view=b;this.$element=b.find("#plugin-download-unavailable");this._bindToUIEvents();this.$view.ctxsDisplayPane()}}})(jQuery);
(function(){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var c={menuItems:[],onShow:function(){},onHide:function(){},menuItemClass:"",menuItemIdPrefix:"dropdown",showDisplayName:!0};CTXS.Widgets.DropDownMenuWidget=function(f,b,a){this.options=$.extend(c,a||{});this.$menuContainer=f;this.$trigger=this.$menuContainer.find(".dropdown-menu-trigger");this.$overlay=b;this.$menu=this.$menuContainer.find(".dropdown-menu");this.$menuTop=this.$menu.find(".dropdown-menu-top");this.$menuBody=this.$menu.find(".dropdown-menu-body");
this.clickEventName="click.dropdown-menu"+Math.floor(99999*Math.random());this._generateHtml();this._bindToUiEvents()};CTXS.Widgets.DropDownMenuWidget.prototype={show:function(){this.$menu.show();this.$trigger.addClass("open");this.$overlay.show();this.$menuTop.addClass("open");this.$menuContainer.ctxsBindFocusWithin().ctxsEnableArrowNavigation();this._hideMenuOnDocumentClick();this.options.onShow()},hide:function(){$(document).off(this.clickEventName);this.$trigger.removeClass("open");this.$menu.hide();
this.$overlay.hide();this.$menuTop.removeClass("open");this.$menuContainer.ctxsUnbindFocusWithin().ctxsDisableArrowNavigation().ctxsUnbindHoverFocusEvents();this.options.onHide()},isOpen:function(){return this.$menu.is(":visible")},updateUserDisplayName:function(c){this._generateTopHtml(c)},_bindToUiEvents:function(){var c=this;this.$trigger.off("click").on("click",function(b){b.preventDefault();CTXS.trace("clicked on the dropdown trigger button. event target: "+b.target.className);c.$menu.is(":visible")?
c.hide():c.show()});this.$menuContainer.off("keyup").on("keyup",function(b){b.keyCode==$.ui.keyCode.ESCAPE&&c.isOpen()?(b.stopPropagation(),c.hide(),c.$trigger.focus()):c.isOpen()||b.keyCode!=$.ui.keyCode.DOWN&&b.keyCode!=$.ui.keyCode.UP||c.show()});this.$overlay.on("click",function(b){b.preventDefault()})},_generateDisplayNameHtml:function(c){var b=$("<p/>");b.addClass("user-display-name");this.options.showDisplayName||b.addClass("hidden");b.text(c);b.attr("aria-label",c);return b},_generateTopHtml:function(c){this.$menuTop.empty();
this.$menuTop.append(this._generateDisplayNameHtml(c))},_generateHtml:function(){var c=this;c.$menuBody.empty();this.options.menuItems&&0<this.options.menuItems.length&&$.each(this.options.menuItems,function(b,a){var d=$('<a id="'+c.options.menuItemIdPrefix+a.id+'"/>');d.text(a.displayText).addClass(c.options.menuItemClass);a.toolTip&&d.attr("title",a.toolTip);a.ariaLabel&&d.attr("aria-label",a.displayText);a.url?d.attr("href",a.url):a.onClick&&(d.click(function(b){b.preventDefault();a.onClick(b);
c.$trigger.focus()}),d.attr("href","#"));c.$menuBody.append(d)})},_hideMenuOnDocumentClick:function(){var c=this;$(document).on(this.clickEventName,function(b){c.$trigger.is(b.target)||0<c.$trigger.find(b.target).length||(CTXS.trace("clicked on document somewhere outside the menu options, this event should only be bound when the dropdown menu is visible"),c.hide())})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.ElectivePasswordChangeWidget=function(f,b,a){this.$dialog=f;this.$overlay=c(b);this.isGatewaySession=a};CTXS.Widgets.ElectivePasswordChangeWidget.prototype={centerAndDisplayDialog:function(){this.$dialog.ctxsCenter();CTXS.displayPopup(this.$overlay,this.$dialog)},cleanDialog:function(){this.$dialog.empty()},hideAndClearDialog:function(){CTXS.hidePopup(this.$overlay,this.$dialog);this.cleanDialog()},isVisible:function(){return CTXS.isPopupVisible(this.$dialog)},
_placeFocus:function(){var c=this.$dialog.find(".default");1===c.length?c.focus():this.$dialog.ctxsPlaceFocusOnFirstElement()}}})(jQuery);
$.extend(CTXS.Events,{store:{initialised:"store:initialised",appAddStarting:"store:app:add:starting",appRemoveStarting:"store:app:remove:starting",appInstallStarting:"store:app:install:starting",appAddFailure:"store:app:add:failure",appStatusChange:"store:app:status:change",appRevertFailure:"store:app:revert:failure",mobileAppInstall:"store:app:mobile:install",linkToPublicAppStore:"store:link:publicappstore"},branding:{logoUrlStatus:"branding:logourl:status"},ui:{showMyHome:"ui:home:show",showMyApps:"ui:apps:myapps:show",
showAppDetails:"ui:appdetails:show",hideAppDetails:"ui:appdetails:hide",showAppDetailsDropdown:"ui:appdetails:show:dropdown",hideAppDetailsDropdown:"ui:appdetails:hide:dropdown",showBundleDetails:"ui:bundledetails:show",showCategorizedApps:"ui:apps:categorized:show",showAllApps:"ui:apps:all:show",showDesktops:"ui:app:desktops:show",showFiles:"ui:app:files:show",showTasks:"ui:app:tasks:show",showSearchView:"ui:search:view:show",customView:"ui:customview",showAppUpdates:"ui:apps:show:updates",showSearchResults:"ui:search:results:show",
clearSearchResults:"ui:search:results:clear",slidingSearchActive:"ui:sliding:search:active",slidingSearchCancelled:"ui:sliding:search:cancelled",showError:"ui:message:error:show",showMessage:"ui:message:show",showAutoMessage:"ui:message:auto:show",scrollToTop:"ui:scroll:top",ready:"ui:ready",loaded:"ui:loaded",showAppDetailsLoadingSpinner:"ui:appdetails:show:loading",hideAppDetailsLoadingSpinner:"ui:appdetails:hide:loading",getAppInfoDetails:"ui:appdetails:getinfo",logoffRequested:"ui:logoff:requested",
logoffComplete:"ui:logoff:complete",changeClient:"ui:changeclient",changeClientOnly:"ui:changeclientonly",downloadClient:"ui:downloadclient",showPhoneAbout:"ui:about:show",showSettings:"ui:settings:show",changeCardSize:"ui:cardsize:change"}});
(function(c){var f={prepopulatedCredentials:{},showBackToChoicesLink:!1,onAuthenticationSuccess:function(b){},onLogonTimeout:function(){},onAuthenticationError:function(){},onBackToChoices:function(){}};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.ExplicitAuthController=function(b,a){this.$view=b;this.$formContainer=b.find(".form-container");this.$backToChoices=b.find(".back-to-choices");this.options=c.extend({},f,a);this.logonTimer=new CTXS.LogonSessionTimer;
this.$spinnerContainer=b.find(".explicit-auth-progress");this.$spinner=this.$spinnerContainer.find(".authentication-spinner");this.progressSpinner=new CTXS.AnimatedSpinner;this.originalHash="";this._bindToUIEvents()};CTXS.Controllers.ExplicitAuthController.prototype={authenticate:function(b){var a=this;this.hasSentShowAccountSettingsChromeReceiver=this.hasShownBackToChoicesLink=!1;this.$formContainer.data("ctxsCtxsFormsAuthentication")||this.$formContainer.ctxsFormsAuthentication({informationIconUrl:CTXS.Device.supportsHighResDisplay()?
"receiver/images/2x/ico_info@2x_1741F6D219FB5DFB.png":"receiver/images/1x/ico_info_853898A513144801.png",prePopulatedCredentials:this.options.prepopulatedCredentials,allowCancel:!1,authenticationSuccess:function(b,d){a._handleAuthenticationSuccess(d)},authenticationError:function(b,d){a._handleAuthenticationError(d)},displayForm:c.proxy(this._onDisplayExplicitForm,this),formProvider:function(b,d,h,g){CTXS.AuthClient.getAuthenticationForm(b,d,h,function(b,d,c){a.$view.ctxsDisplayPane();g(b,c.getResponseHeader("X-Citrix-ExplicitAuthProtocol"))},
c.proxy(a._handleAuthenticationError,this))}});if(a._checkForResumeForms())if(CTXS.Authentication.setWebViewLogon(!0),b=a._resumePreviousFormsConversation(CTXS.getUrlHash())){var d=b.postbackUrl||CTXS.Config.getConfigValue("authManager.webviewResumeURL");this.$formContainer.ctxsFormsAuthentication("resumeForms",d,b.stateContext,b.credentialId);a._showSpinner()}else a._handleAuthenticationError(!1);else CTXS.Authentication.setWebViewLogon(!1),this.logonTimer.start(Number(CTXS.Config.getConfigValue("authManager.loginFormTimeout")),
c.proxy(this._handleLogonTimeout,this)),this.$formContainer.ctxsFormsAuthentication("startAuthentication",b)},_checkForResumeForms:function(b){return(b=b||CTXS.getUrlHash())&&-1!=b.indexOf("resumeForms:")},_resumePreviousFormsConversation:function(){var b=CTXS.getUrlHash();if(!this._checkForResumeForms(b))return!1;b=b.split("resumeForms:");b.shift();if(0>=b.length)return!1;var b=CTXS.getParametersFromQueryString(b[0]),a="",d="",c="",k;for(k in b){var h=b[k];switch(k){case "_hf":this.originalHash=
h;break;case "_cx":a=h;break;case "_pb":d=h;break;default:h||c||(c=k)}}return{stateContext:a,postbackUrl:d,credentialId:c}},_onDisplayExplicitForm:function(){this._hideSpinner();this.$backToChoices.toggle(this.options.showBackToChoicesLink&&!this.hasShownBackToChoicesLink);this.hasShownBackToChoicesLink=!0;!this.hasSentShowAccountSettingsChromeReceiver&&CTXS.Device.isCitrixChromeApp()&&CTXS.Html5Client.postShowAccountSettingsToChromeApp();this.hasSentShowAccountSettingsChromeReceiver=!0;this.$view.scrollTop(0)},
_bindToUIEvents:function(){var b=this;this.$backToChoices.find("a").on("click",function(a){a.preventDefault();b._handleBackToChoices()})},_showSpinner:function(){this.$spinnerContainer.show();this.progressSpinner.start(this.$spinner)},_hideSpinner:function(){this.$spinnerContainer.hide();this.progressSpinner.stop(this.$spinner)},_handleAuthenticationSuccess:function(b){this._cleanUp();CTXS.Authentication.setBrowserCloseRequiredToEndSession(CTXS.Authentication.isWebViewLogon()&&!b.webLogoffUrl);this._checkForResumeForms()&&
CTXS.updateUrlHash(this.originalHash);this.options.onAuthenticationSuccess(b)},_handleLogonTimeout:function(){this._cleanUp();this.options.onLogonTimeout()},_handleAuthenticationError:function(b){b&&"sessiontimeout"==b.errorId?this._handleLogonTimeout():(this._cleanUp(),this.options.onAuthenticationError())},_handleBackToChoices:function(){this._cleanUp();this.options.onBackToChoices()},_cleanUp:function(){this.logonTimer.stop();this.$formContainer.find('input[type="password"]').ctxsObliteratePassword()}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={onRender:function(){},onFolderNameUpdate:function(){},onFolderNameHide:function(){},animationTime:100,easingStyle:"easeInOutCubic"},b=[],a=c(".folder-ruler-container"),d=c("section.scrollable.storeViewSection"),e=null,k=null;CTXS.Widgets.FoldersWidget=function(a,b,d,e,k,n,G,u,y){this.$view=a;this.$fadeEffectContainer=b;this.$phoneToolbar=d;this.$phoneScroller=e;this.options=c.extend(f,y);this.currentFolderIndex=null;this.currentFolderUncategorized=
!1;this.appHierarchy=k;this.collections=n;this.appsWidget=G;this.showToolbarButtons=u;this.uncategorized=k.filter(function(a){return a.name===CTXS.Category.CATEGORY_UNCATEGORIZED})[0];this.animating=!1};CTXS.Widgets.FoldersWidget.prototype={showByCategory:function(a){this.updateToolbar(a);this.$view.html(this._getMarkupByCategory(a));this.options.onRender();this.currentFolderIndex=a.index;a=CTXS.Category_ByIndex(this.currentFolderIndex).pname;CTXS.ExtensionsHead.onFolderChange(a?a:"\\");this.isShowingCollections=
!1},showCollections:function(){this.$view.html(this._generateCollectionMarkup());this.options.onRender();this.clearCurrentFolderIndex();this.isShowingCollections=!0},clearCurrentFolderIndex:function(){this.currentFolderIndex=null;CTXS.ExtensionsHead.onFolderChange("")},showByIndex:function(a,b){this.updateToolbar(CTXS.Category_ByIndex(a));this.$view.html(this._getMarkupByIndex(a,b));this.options.onRender();this.currentFolderIndex=a;CTXS.ExtensionsHead.onFolderChange(CTXS.Category_ByIndex(a).pname)},
navigateWithTransition:function(a,b,c){this._isBackButton(a)?this.navigateBackWithTransition():(e=d.scrollTop(),k=this.$phoneToolbar.scrollLeft(),this._transitionForward(b,c))},navigateTo:function(a,b){this.currentFolderUncategorized?this.showByCategory(this.uncategorized):this.showByIndex(a,b);this.$phoneScroller[0].scrollTop=0},_isBackButton:function(a){return a&&a.hasClass("back")},navigateBack:function(){if(CTXS.UI.useSmallTiles())this.navigateBackWithTransition();else{var a=CTXS.Category_ByIndex(this.currentFolderIndex).parentCategory.index;
this.showByIndex(a)}},navigateBackWithTransition:function(){var a=this,b=CTXS.Category_ByIndex(this.currentFolderIndex),c=b.hasOwnProperty("parentCategory")?b.parentCategory.index:this.currentFolderIndex,m=this.currentViewMarkup||this._getMarkupByIndex(this.currentFolderIndex);this.$fadeEffectContainer.html(m);this.$fadeEffectContainer.stop().css({opacity:1}).show();this.currentFolderIndex=c;this.currentFolderUncategorized=b.name===CTXS.Category.CATEGORY_UNCATEGORIZED;this.$phoneScroller[0].scrollTop=
0;this.currentViewMarkup=this._getMarkupByIndex(c);this.$view.html(this.currentViewMarkup);this.options.onRender();null!==e&&d.scrollTop(e);this.$phoneToolbar.velocity({opacity:0},{begin:function(){a.$phoneToolbar.stop().css({opacity:1});a.$view.stop().css({opacity:0})},queue:!1,duration:a.options.animationTime,easing:a.options.easingStyle,complete:function(){a.updateToolbar(CTXS.Category_ByIndex(c));null!==k&&a.$phoneToolbar.scrollLeft(k);a.$phoneToolbar.velocity({opacity:1},{queue:!1,duration:a.options.animationTime,
easing:a.options.easingStyle});a.$view.velocity({opacity:1},{queue:!1,duration:a.options.animationTime,easing:a.options.easingStyle})}});this.$fadeEffectContainer.velocity({opacity:0},{begin:function(){a.$fadeEffectContainer.stop().css({opacity:1})},queue:!1,duration:a.options.animationTime,easing:a.options.easingStyle,complete:function(){a.$fadeEffectContainer.hide();a.$phoneScroller.stop().css({"overflow-y":"scroll"});var b=CTXS.Category_ByIndex(c).pname;CTXS.ExtensionsHead.onFolderChange(b?b:"\\");
a.animating=!1}});this.$phoneScroller.stop().css({"overflow-y":"hidden"})},_getForwardCategory:function(a){if(a===this.currentFolderIndex&&CTXS.Category_ByIndex(this.currentFolderIndex).name===CTXS.Category.CATEGORY_OTHER)return this.currentFolderUncategorized=!0,this.uncategorized;this.currentFolderUncategorized=!1;return CTXS.Category_ByIndex(a)},_transitionForward:function(a,b){var d=this,c=d._getForwardCategory(a);this.currentViewMarkup=d._getMarkupByCategory(c,b);this.$phoneScroller.css({"overflow-y":"hidden"});
this.$fadeEffectContainer.html(this.currentViewMarkup);this.$view.velocity({opacity:0},{begin:function(){d.$view.stop().css({opacity:1})},queue:!1,duration:d.options.animationTime,easing:d.options.easingStyle});this.$phoneToolbar.velocity({opacity:0},{begin:function(){d.$phoneToolbar.stop().css({opacity:1})},queue:!1,duration:d.options.animationTime,easing:d.options.easingStyle,complete:function(){d.updateToolbar(c);d.$phoneToolbar.stop().css({opacity:1});d.$fadeEffectContainer.show().velocity({opacity:1},
{begin:function(){d.$fadeEffectContainer.stop().css({opacity:0})},queue:!1,duration:d.options.animationTime,easing:d.options.easingStyle,complete:function(){d.$view.html(d.currentViewMarkup);d.options.onRender();d.$phoneScroller[0].scrollTop=0;d.$view.stop().css({opacity:1});d.$fadeEffectContainer.hide();d.currentFolderIndex=a;d.$phoneScroller.css({"overflow-y":"scroll"});CTXS.ExtensionsHead.onFolderChange(CTXS.Category_ByIndex(a).pname);d.animating=!1}})}})},_mkGetFolderMarkupFn:function(a,b){var d=
this;return function(){return d._generateFolderHtml(a,b)}},updateToolbar:function(a){if(CTXS.UI.useSmallUILayout())if(a&&null!=a.parentCategory)this.options.onFolderNameUpdate(this._getFolderName(a.getDisplayFolderName(),a.count));else this.options.onFolderNameHide(),this.showToolbarButtons()},_getMarkupByCategory:function(a,b){CTXS.trace("show folderview ("+a+")");return a.name===CTXS.Category.CATEGORY_OTHER?this._generateFolderMarkup():this._generateAppsMarkup(a,b)},_generateCollectionMarkup:function(){var a=
"";if(null!=this.collections)for(var b in this.collections)if(this.collections.hasOwnProperty(b))var d=this.collections[b],c=d.apps.length,c=this._getFolderName(CTXS.decodeHtmlString(d.title,!0),c),a=a+this._generateFolderHtml(d,c);return a},_getCollectionById:function(a){for(var b in this.collections)if(this.collections.hasOwnProperty(b)&&this.collections[b].tileid===a)return this.collections[b];return null},_generateFolderMarkup:function(){var a="",b=CTXS.ExtensionsHead.isDefined("getFolderMarkup"),
d=this.appHierarchy;if(null!=d)for(var c in d)if(d.hasOwnProperty(c))var e=d[c],k=this._getFolderName(e.getDisplayFolderName(),e.count),a=b?a+CTXS.ExtensionsHead.getFolderMarkup(e,k,this._mkGetFolderMarkupFn(e,k)):a+this._generateFolderHtml(e,k);return a},_generateAppsMarkup:function(a,b){var d="";if(a.name===CTXS.Category.CATEGORY_UNCATEGORIZED){for(var d=d+('<div class="store-apps-title theme-highlight-color">'+a.pname+"</div>"),d=d+'<ul class="storeapp-list">',c=0,e=a.apps.length;c<e;c++)d+=this._generateAppHtml(a.apps[c]);
d+="</ul>"}else a.name===CTXS.Category.CATEGORY_OTHER&&a.subcategories||!a.apps||!b||(d=this.appsWidget.getAppsHtml(b));return d},_getMarkupByIndex:function(a,b){return this._getMarkupByCategory(CTXS.Category_ByIndex(a),b)},_generateFolderHtml:function(a,b){var d="",c=this._isCategoryObject(a),e=c?'data-folderindex="'+a.index+'"':'data-tileid="'+a.tileid+'"',c=c?a.count:a.apps.length;CTXS.UI.useSmallTiles()&&(d='<li class="folder" '+e+'><a href="#" class="storeapp-details-link"><div class="storeapp-icon"></div><div class="folder-count">'+
c+'</div><div class="storeapp-details-container"><p class="storeapp-name theme-highlight-color">'+b+"</p></div>"+(CTXS.UI.useSmallUILayout()?'<div class="folder-action-link theme-highlight-sprite" ></div>':"")+"</a></li>");return d},_generateAppHtml:function(a){return CTXS.Views.AppView.getMarkup(a)},_bindToUiEvents:function(){},_isCategoryObject:function(a){return a instanceof CTXS.Category||a.hasOwnProperty("name")&&a.name===CTXS.Category.CATEGORY_UNCATEGORIZED},_getFolderName:function(d,c){var l=
d;6<d.length&&(l=b[d],l||(l=CTXS.truncateToFit(a,d,120,2,!1),b[d]=l));c&&(l+=" ("+c+")");return l}}})(jQuery);
(function(c){var f="oninput"in c("<input type='text'/>")[0]?"input":"keyup",b={"X-Citrix-AM-CredentialTypes":"none, username, domain, password, newpassword, passcode, savecredentials, textcredential, webview","X-Citrix-AM-LabelTypes":"none, plain, heading, information, warning, error, confirmation, image"};c.widget("ctxs.ctxsFormsAuthentication",{options:{allowCancel:!0,prePopulatedCredentials:{},formActionSpinnerImageUrl:"receiver/images/common/authspinner_B0BCD339560CA593.gif",informationIconUrl:"receiver/images/1x/ico_info_853898A513144801.png",
formProvider:function(a,b,c,k){k("","")},beforeDisplayForm:null,displayForm:null,authenticationSuccess:null,authenticationCancel:null,authenticationError:null},_create:function(){CTXS.AssistiveTextGenerator.informationIconUrl=this.options.informationIconUrl},_setOption:function(a,b){"informationIconUrl"===a&&(CTXS.AssistiveTextGenerator.informationIconUrl=b);this._super(a,b)},startAuthentication:function(a){var d=this._updateCredentialAndLabelTypesForHeaders(b);this.options.formProvider(a,{},d,this._getResponseHandler())},
resumeForms:function(a,d,c){d="StateContext="+d+"&"+c+"=";c=this._updateCredentialAndLabelTypesForHeaders(b);this.options.formProvider(a,d,c,this._getResponseHandler())},_getResponseHandler:function(){return c.proxy(this._processResponse,this)},_processResponse:function(a,b){var e=c("Result",a).text();c("body").css("cursor","default");switch(e){case "success":e={authenticationType:c("AuthType",a).text(),isPasswordChangeAllowed:"true"==c("IsChangePasswordEnabled",a).text(),isPasswordExpiryNotificationEnabled:"true"==
c("IsExpiryNotificationEnabled",a).text(),passwordExpiryTime:parseInt(c("TimeRemaining",a).text(),10)||0,webLogoffUrl:CTXS.findFirstNamespacedChildNodeValue(a,"webLogoffUrl","http://citrix.com/delivery-services/webAPI/2-6/weblogoff"),authenticationResponse:a};this._trigger("authenticationSuccess",null,e);break;case "cancelled":this._trigger("authenticationCancel",null,{authenticationResponse:a});break;case "fail":e={errorId:c("LogMessage",a).text(),authenticationResponse:a};this._trigger("authenticationError",
null,e);break;case "more-info":case "update-credentials":this.stateContext=c("StateContext",a).text(),this._displayResponseContent(a,b)}},_displayResponseContent:function(a,b){var e=CTXS.LoginFormGenerator.generateLoginFormFromXml(a,this.options.prePopulatedCredentials,this.options.formActionSpinnerImageUrl);this._trigger("beforeDisplayForm");this.element.html(e);this._formatForm(a,b);this._trigger("displayForm",null,{authenticationElement:this.element});CTXS.AuthExtensions.isAutoPostAddedToForm()&&
CTXS.AuthExtensions.AutoPostCallback(this.element);CTXS.Device.isDesktop()&&this._focusOnFirstInputField();this._reinforceAlerts();this.options.reservedSpace&&this._addScrollBar();if(window.matchMedia){var e=window.matchMedia("all and (max-width: 767px)"),k=function(a){a.matches&&CTXS.Device.isMobileDevice()?c(".informationAssistive").ctxsAddCustomTooltip(c(".informationAssistiveTooltip"),c(".form-container")):c(".informationAssistive").ctxsRemoveCustomTooltip(c(".informationAssistiveTooltip"),c(".form-container"))};
e.addListener(k);k(e)}},_focusOnFirstInputField:function(){var a=this.element.find("input:enabled").filter(function(){return""==c(this).val()||c(this).hasClass("highlightedInput")});a&&0!=a.length||(a=this.element.find("input:enabled, .button"));a&&(a.first().focus(),a.first().hasClass("button")||a.first().select())},_convertInputForIE:function(a){var b=this,c=a.attr("placeholder");if(c){var k=a.attr("id")+"-placeholder",h='<div class="pseudo-input '+(a.attr("class")||"")+'"></div>';a.wrap(h);a.after('<span id="'+
k+'" class="pseudo-input">'+c+"</span>");a.attr("placeholder","");this._applyPseudoPlaceholder(a,k);a.on(f,function(){b._applyPseudoPlaceholder(a,k)})}},_applyPseudoPlaceholder:function(a,b){this.element.find(b?"#"+b:"").toggleClass("show",!a.val())},_updateCredentialAndLabelTypesForHeaders:function(a){a=c.extend({},a);a=this._addCustomFormTypesToHeaders(a,"X-Citrix-AM-LabelTypes",CTXS.AuthExtensions.getLabelHandlers());a=this._addCustomFormTypesToHeaders(a,"X-Citrix-AM-CredentialTypes",CTXS.AuthExtensions.getCredentialHandlers());
CTXS.isFeatureEnabled("Citrix.DeliveryServices.WebUI.WebviewCredentialSupport")||(a=this._removeFormTypeFromHeaders(a,"X-Citrix-AM-CredentialTypes","webview"));return a},_getTypeName:function(a,b){switch(b){case "X-Citrix-AM-LabelTypes":return a.getLabelTypeName();case "X-Citrix-AM-CredentialTypes":return a.getCredentialTypeName();default:return""}},_removeFormTypeFromHeaders:function(a,b,e){var k=a[b];if(!k)return a;var h=k.split(", "),g=c.inArray(e,h);-1<g&&(h.splice(g,1),k=h.join(", "),CTXS.trace("Form type "+
e+" removed from headers."));a[b]=k;return a},_addCustomFormTypesToHeaders:function(a,b,c){var k=a[b];if(c){k||(k="");for(var h=0;h<c.length;h++){var g=c[h],l=this._getTypeName(g,b);l&&"string"===typeof l?k+=(k?", ":"")+l:CTXS.trace("Handler "+g.name+" did not provide a non-empty string as a type name, skipping.")}a[b]=k}return a},_formatForm:function(a,b){function e(){var a=k.element.find(".CredentialTypedomain input, .CredentialTypedomain select"),b=k.element.find(".CredentialTypedomain label"),
d=-1!=g.val().indexOf("@")||-1!=g.val().indexOf("\\");a.prop("disabled",d);d?b.addClass("disabled"):b.removeClass("disabled")}var k=this;k.element.find(".form").addClass("credentialform").append('<div class="spacer"/>');k.element.find("form").attr("method","POST");k.element.find("form").attr("action",c("PostBack",a).text());k.element.find(".CredentialTypesavecredentials").hide();k.options.allowCancel||k.element.find("#chimeraCancelBtn").remove();k.element.find(".CheckMeWhenInDom").attr("checked",
!0);"CustomForms"==b&&k.element.find(".form").addClass("customform");(function(a){a=a.find("div[class*='CredentialType']:not(.CredentialTypenone)");a.find(".left label").filter(function(){return""==c(this).text()}).length==a.length&&a.each(function(){c(this).find(".left").remove();c(this).find(".right").removeClass("right").addClass("left")})})(k.element.find("form"));k.element.find(".inlineAssistiveText").each(function(){var a=c(this),b=a.parent().children("input[type=text], input[type=password]");
if(1!=b.length)return!0;b.attr("placeholder",a.text()).attr("title",a.text());a.remove();(CTXS.Device.isIE()||CTXS.Device.isSpartan())&&k._convertInputForIE(b)});k.element.find(".forms-authentication-button[id^=link_]").addClass("display-as-link authentication-link");k.element.find(".buttonscontainer").filter(function(){return 1<c(this).find(".forms-authentication-button").not(".display-as-link").length}).addClass("multiple-buttons");k.element.find(".forms-authentication-button:last-child").not(".display-as-link").addClass("last-child");
var h=function(a){var b=a.attr("id");a=a.text();return b&&a?{id:b,value:a}:null};k.element.find(".forms-authentication-button").addClass("default").click(function(b){b.preventDefault();b=c(this);var d=b.hasClass("disabled")||b.hasClass("waiting"),g="chimeraCancelBtn"==b.attr("id");d||(g&&k.element.find("form").attr("action",c("CancelPostBack",a).text()),k._submitForm(h(b)))});var g=k.element.find(".CredentialTypeusername input");0<navigator.userAgent.indexOf("Trident/4")&&k.element.find(".CredentialTypedomain option").each(function(){c(this).attr("title",
this.value)});0<k.element.find(".CredentialTypedomain").length&&(g.on("change "+f,e),e());k.element.find("input[type=text], input[type=password]").attr("autocomplete","off").attr("spellcheck",!1);k._disableFormAutoSubmission();k.element.on("keydown","input, .button",c.proxy(k._handleKeydown,k))},_reinforceAlerts:function(){for(var a=[".error",".warning",".information",".confirmation"],b=0;b<a.length;b++){var c=this.element.find(a[b]);if(c.length){a=c.first();a.text(a.text());break}}},_handleKeydown:function(a){var b=
c(a.target);a.keyCode==c.ui.keyCode.ENTER?(this.element.off("keydown","input, .button",this._handleKeydown),b.is(".button")||(a.preventDefault(),a.stopPropagation(),b=this.element.find(".form .forms-authentication-button").first(),b.click())):a.keyCode==c.ui.keyCode.ESCAPE&&(b=this.element.find("#chimeraCancelBtn"),b.length&&(this.element.off("keydown","input, .button",this._handleKeydown),a.preventDefault(),a.stopPropagation(),b.click()))},_submitForm:function(a){var d=this.element.find(".form"),
c=this._updateCredentialAndLabelTypesForHeaders(b);CTXS.FormActions.disableFormAndShowHourglass(d,a);this.options.reservedSpace&&this._updateScrollHeight();d=d.attr("action");a=this._getFormPostData(a);this.options.formProvider(d,a,c,this._getResponseHandler())},_getFormPostData:function(a){var b={},e=this.element.find(".form");c("input[type!='submit']",e).each(function(){var a;"checkbox"==this.type?a=this.checked:"radio"==this.type?this.checked&&(a=this.value):a="username"==this.name||"domain"==
this.name?c.trim(this.value):this.value;"undefined"!=typeof a&&(b[this.name]=a)});b.username&&(this.options.prePopulatedCredentials.username=b.username,this.options.prePopulatedCredentials.domain=b.domain,this.options.prePopulatedCredentials.password="");c("select",e).each(function(){for(var a=[],c=0;c<this.length;c++)this.options[c].selected&&a.push(this.options[c].value);b[this.name]=0==a.length?"":a});a&&(b[a.id]=a.value);b.StateContext=this.stateContext;return c.param(b,!0)},_disableFormAutoSubmission:function(){this.element.find(".form").submit(function(){return!1})},
_addScrollBar:function(){0===this.element.find(".logonbox-scroller").length&&(this.element.find("form.credentialform").wrap('<div class="logonbox-scroller"></div>').parent().ctxsMakeScrollable(),this._updateScrollHeight())},_updateScrollHeight:function(){var a=this.element.find(".logonbox-scroller"),b=c(window).height(),e=parseFloat(this.element.css("paddingTop"))||0,k=parseFloat(this.element.css("paddingBottom"))||0,b=b-this.options.reservedSpace-e-k,e=this.element.find("form.credentialform").height(),
b=Math.min(b,e+1);a.height(b);a.ctxsUpdateScrollPane()},resize:function(){this.options.reservedSpace&&this._updateScrollHeight()}})})(jQuery);window.CTXS=window.CTXS||{};CTXS.External={reportParsingError:function(c){window.console&&window.console.log&&window.console.log("ctxsFormsAuthentication:"+c)}};
(function(c){function f(a){var b=CTXS.Device.isWindowsPlatform()&&!CTXS.Device.isBrowserPluginSupported(),c="false"!=CTXS.Config.getConfigValue("pluginAssistant.enabled"),k=CTXS.Device.isWindowsPlatform()||CTXS.Device.isMacOSX();return(a||b)&&c&&k}function b(a,b){window.location.href=b}window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.HomeController=function(a,b){this.$body=a;this.store=b;this.$homeView=a.find(".home-view");this.$header=this.$homeView.find(".store-header");
this.$userMenu=this.$header.find(".user-menu.dropdown-menu-container");this.$storeView=this.$homeView.find(".storeViewSection");this.$sideMenu=this.$homeView.find(".side-menu");this.$aboutBox=a.find("#aboutBoxPopup");this.$aboutCloseBtn=this.$aboutBox.find("#aboutBoxCloseBtn");this.$aboutThirdPartyNoticesBtn=this.$aboutBox.find("#thirdPartyNoticesBtn");this.$aboutThirdPartyNoticesPhoneBtn=a.find("#thirdPartyNoticesPhoneBtn");this.$messageBoxOverlay=a.find("#genericMessageBoxOverlay");this.overlaySpinner=
new CTXS.AnimatedSpinner;this.$refreshSpinner=this.$homeView.find(".refresh-spinner");this.$refreshOverlay=a.find("#refresh-overlay");this.$settingsBtn=a.find("#settingsBtn");this.initialiseNativeMenuPreferences();this.$homeView.ctxsDisplayPane();CTXS.Device.isCitrixChromeApp()&&CTXS.Html5Client.postShowAccountSettingsToChromeApp();this._bindToUIEvents();this._bindToAppEvents();this.autoMessageWidget=new CTXS.Widgets.AutoMessageWidget(this.$homeView.find("#autoMessagePopup"),this.$homeView.find("#autoMessageOverlay"));
this._initializeMainViews();CTXS.Controllers.StoreAppListViewController.initialise(this.$homeView.find(".store-apps-container"),this.$homeView.find(".no-results-message"),this.$homeView.find(".store-toolbar"),this.$homeView.find(".store-toolbar-phone"),this.$storeView.find(".applicationBundleContainer"),this.$storeView.find(".applicationBundleHeader"),this.$homeView.find(".bundleDetail-toolbar"),this.$homeView.find(".search-container"),this.store,this.$homeView.find(".no-fav-results-message"),this.$homeView.find(".no-fav-results-filter-message"));
CTXS.UI.useSmallUILayout()?CTXS.Controllers.AppInfoController.initialise(this.$homeView.find(".appInfoView"),this.store,this.$homeView.find(".appinfo-toolbar")):CTXS.Controllers.AppInfoController.initialise(this.$homeView.find(".appInfoView"),this.store,this.$homeView.find(".appInfoView").find(".appDetailsBox"));CTXS.UI.useSmallUILayout()&&(this.slidingMenuWidget=new CTXS.Widgets.SlidingMenuWidget(this.$homeView.find(".home-view-content"),this.$sideMenu,this.$header.find(".side-menu-thumb"),this.$homeView.find(".side-menu-content-overlay")),
this._initialiseSlidingUserMenu(this.$sideMenu));this.changePasswordController=new CTXS.Controllers.ChangePasswordController(c("#genericDialogBox"),{overlaySelector:"#genericDialogBoxOverlay",onAuthenticationError:function(){CTXS.Environment.showDialog({messageText:c.localization.string("CannotCompleteYourRequest")})},isDialog:!0});this.setDefaultView();var e=CTXS.UserInfo.getName();e?this._updateUserDisplayName(e):this.store.loadUserDisplayName();CTXS.IconsLoader.loadIcons(this.store.getAllApps());
CTXS.IconsLoader.loadIcons(this.store.getDesktops());this.workflowNotificationController=new CTXS.Controllers.WorkflowNotificationController(this.store);CTXS.Device.isNativeClient()?this.nativeMenuPreferencesControl.isWebDropdownNeeded()&&this.initialiseSettingsView():(this.initialiseWorkspaceControl(),this.initialiseSettingsView(),CTXS.ExtensionsHead.webReconnectAtStartup(this.workspaceControl.isAutoSessionReconnectAllowed())&&this.workspaceControl.reconnectAppSessions(),CTXS.Store.canAutoLaunchSingleDesktop()&&
this._autolaunchSingleDesktop());CTXS.AppShortcuts.isAppShortcutLaunch()&&(this.appShortcutController=new CTXS.Controllers.AppShortcutController(this.store),this.appShortcutController.validateAppShortcutLaunch())};CTXS.Controllers.HomeController.prototype={resize:function(){CTXS.Controllers.StoreAppListViewController.resize();CTXS.Controllers.AppInfoController.resize()},_bindToDomDrivenResizes:function(){var a=this,b=this.$storeView.get(0);!CTXS.Device.isIE()||CTXS.Device.isIE11()?(new MutationObserver(function(b){b.forEach(function(){a.resize()})})).observe(b,
{attributes:!0,attributeFilter:["style"]}):b.addEventListener("DOMAttrModified",a.resize,!1)},_bindToUIEvents:function(){var a=this;CTXS.Events.subscribe(CTXS.Events.ui.loaded,function(){a._bindToDomDrivenResizes()});if(!CTXS.UI.useSmallUILayout()&&this.nativeMenuPreferencesControl.isNativeDropdownNeeded())this.$homeView.find(".settings-button").on("click",function(b){b.preventDefault();a._showSettings(c(this))});CTXS.UI.useSmallUILayout()&&(this.$sideMenu.find(".menu-action.settings").on("click",
function(b){b.preventDefault();a._showSettingsView(c(this))}),this.$sideMenu.find(".logoff-button").on("click",function(a){a.preventDefault();CTXS.Environment.logOff()}),this.$sideMenu.find(".menu-action.about").on("click",function(b){b.preventDefault();CTXS.Environment.showAboutBox(c(this),a.$messageBoxOverlay,a.$aboutBox)}),this.$sideMenu.find(".menu-action.refresh").on("click",function(a){a.preventDefault();CTXS.Environment.refresh()}));this.$aboutCloseBtn.on("click",function(b){b.preventDefault();
a._hideAboutBoxAndOverlay()});this.$aboutThirdPartyNoticesBtn.on("click",function(b){a._openThirdPartyUrl(c(this));b.preventDefault()});this.$aboutThirdPartyNoticesPhoneBtn.on("click",function(b){a._openThirdPartyUrl(c(this));b.preventDefault()});this.$refreshOverlay.click(function(a){a.preventDefault()});this.$aboutBox.on("keyup",function(b){b.keyCode===c.ui.keyCode.ESCAPE&&CTXS.isPopupVisible(a.$aboutBox)&&a._hideAboutBoxAndOverlay()})},_bindToAppEvents:function(){var a=this;CTXS.Events.subscribe(CTXS.Events.ui.showMessage,
function(){a._hideAboutBox()});CTXS.Events.subscribe(CTXS.Events.session.terminating,function(){a._hideAboutBoxAndOverlay()});CTXS.Events.subscribe(CTXS.Events.store.mobileAppInstall,b);CTXS.Events.subscribe(CTXS.Events.store.linkToPublicAppStore,b);CTXS.Events.subscribe(CTXS.Events.resources.userDisplayNameSupplied,function(b,c){a._updateUserDisplayName(c);a._checkAndDisplayTaskView(c)});CTXS.Events.subscribe(CTXS.Events.ui.showMyHome,function(){a.$header.find(".header-title").text(c.localization.string("Home"))});
CTXS.Events.subscribe(CTXS.Events.ui.showMyApps,function(){a.$header.find(".header-title").text(c.localization.string("QuickAccess"))});CTXS.Events.subscribe(CTXS.Events.ui.showAllApps,function(){a.$header.find(".header-title").text(c.localization.string("AllApps"))});CTXS.Events.subscribe(CTXS.Events.ui.showDesktops,function(){a.$header.find(".header-title").text(c.localization.string("Desktops"))});CTXS.Events.subscribe(CTXS.Events.ui.showFiles,function(){a.$header.find(".header-title").text(c.localization.string("Files"))});
CTXS.Events.subscribe(CTXS.Events.ui.showSearchResults,function(){a.$header.find(".header-title").text(c.localization.string("SearchResultsNoCount"))});CTXS.Events.subscribe(CTXS.Events.ui.showSettings,function(){a.$header.find(".header-title").text(c.localization.string("Settings"))});CTXS.Events.subscribe(CTXS.Events.ui.customView,function(b,c){a.$header.find(".header-title").text(c)});CTXS.Events.subscribe(CTXS.Events.ui.showAutoMessage,function(b,c){a.autoMessageWidget.show(c)});CTXS.Events.subscribe(CTXS.Events.store.appAddFailure,
function(a,b){CTXS.Environment.showDialog({messageTitle:c.localization.string("CannotAddAppTitle"),messageText:c.localization.string("CannotAddApp",b.encodedName),id:b.encodedName,resource:b})});CTXS.Events.subscribe(CTXS.Events.store.appRevertFailure,function(a,b){CTXS.Environment.showDialog({messageTitle:c.localization.string("CannotRemoveAppTitle"),messageText:c.localization.string("CannotRemoveApp",b.encodedName),id:b.encodedName,resource:b})});CTXS.Events.subscribe(CTXS.Events.resources.startRefreshApps,
function(){a.$refreshSpinner.show();a.$refreshOverlay.ctxsBindFocusWithin({selector:"*"});a.overlaySpinner.start(a.$refreshSpinner,a.$refreshOverlay)});CTXS.Events.subscribe(CTXS.Events.resources.endRefreshApps,function(){a.$refreshSpinner.hide();a.$refreshOverlay.ctxsUnbindFocusWithin();a.overlaySpinner.stop(a.$refreshSpinner,a.$refreshOverlay);CTXS.Controllers.ViewController.forceRedrawOnBack()});CTXS.Events.subscribe(CTXS.Events.ui.slidingSearchActive,function(){a.slidingMenuWidget&&a.slidingMenuWidget.setEnabled(!1)});
CTXS.Events.subscribe(CTXS.Events.ui.slidingSearchCancelled,function(){a.slidingMenuWidget&&a.slidingMenuWidget.setEnabled(!0)});CTXS.Events.subscribe(CTXS.Events.resources.endRefreshApps,function(){var b=CTXS.currentView;a._updateTabsAvailableValues();a._checkAndDisplayFilesView();a.$homeView.find(".myhome-view.toggle-view-button").toggle(a.showMyHome);a.$homeView.find(".myapps-view.toggle-view-button").toggle(a.showMyApps);a.$homeView.find(".store-view.toggle-view-button").toggle(a.hasApps);a.$homeView.find(".desktops-view.toggle-view-button").toggle(a.hasDesktops);
a.$homeView.find(".files-view.toggle-view-button").toggle(a.showFilesView);(a.hasApps||a.hasDesktops)&&a.$homeView.find(".no-apps-or-desktops-message").hide();"myhome"!=b||a.showMyHome?"myapps"!=b||a.showMyApps?"store"!=b||a.hasApps?"desktops"!=b||a.hasDesktops?"files"!=b&&"search"!=b&&"appinfo"!=b&&"bundledetail"!=b&&null!=b||a.setDefaultView():a.setDefaultView():a.setDefaultView():a.setDefaultView():a.setDefaultView()})},_updateUserDisplayName:function(a){this.settingsController&&(this.settingsController.updateUserDisplayName(a),
CTXS.UI.useSmallUILayout()&&this.slidingMenuWidget.updateUserDisplayName(a))},_checkAndDisplayFilesView:function(){if(CTXS.Store.doFilesExist()){var a=CTXS.Store.getFilesLink();CTXS.addIframeToView(a,".filesViewSection")}else CTXS.removeIframeFromView(".filesViewSection")},_checkAndDisplayTaskView:function(a){if(CTXS.isFeatureEnabled("Citrix.DeliveryServices.Authentication.SelfServiceAccountManagement")&&!CTXS.Device.isMobileDevice()&&!CTXS.Environment.isGatewaySession()&&a){var b=this;a={url:CTXS.Config.getConfigValue("authManager.allowSelfServiceAccountManagementURL"),
dataType:"xml",type:"POST",refreshSession:!0,success:function(a,k,h){"True"==c("SelfServiceAccountManagementStatus>AllowSelfServiceAccountManagement",a).text()&&(a=c("SelfServiceAccountManagementStatus>SelfServiceAccountManagementURL",a).text(),CTXS.Controllers.StoreAppListViewController.setAccountManagementURL(a),b.$homeView.find(".tasks-view.toggle-view-button").toggle(!0))},error:function(a,b){CTXS.trace("CTXS.AuthClient failed to check account management configuration - status: "+b)}};c.ctxsAjax(a)}},
_updateTabsAvailableValues:function(){this.hasApps=0<this.store.getAllApps().length;this.hasDesktops=0<this.store.getDesktops().length;this.showMyApps=this.store.isSelfServiceEnabled();this.showMyHome=this.store.isSelfServiceEnabled();this.showFilesView=CTXS.Store.doFilesExist()},_initializeMainViews:function(){this._updateTabsAvailableValues();CTXS.Controllers.ViewController.initialise(this.$body,this.$homeView.find(".toggle-view-button"),this.$homeView.find(".myhome-view.toggle-view-button"),this.$homeView.find(".myapps-view.toggle-view-button"),
this.$homeView.find(".store-view.toggle-view-button"),this.$homeView.find(".updates-view.toggle-view-button"),this.$homeView.find(".desktops-view.toggle-view-button"),this.$homeView.find(".tasks-view.toggle-view-button"),this.$homeView.find(".files-view.toggle-view-button"),this.store,{isMyHomeViewVisible:this.showMyHome,isMyAppsViewVisible:this.showMyApps,isAllAppsViewVisible:this.hasApps,isDesktopsViewVisible:this.hasDesktops,isFilesViewVisible:this.showFilesView,isTasksViewVisible:!1});this._checkAndDisplayFilesView();
CTXS.StoreViewManager.initialise()},setDefaultView:function(){var a="true"===CTXS.Config.getConfigValue("userInterface.uiViews.showAppsView"),b="true"===CTXS.Config.getConfigValue("userInterface.uiViews.showDesktopsView"),e=a&&this.hasApps,k=b&&this.hasDesktops,h=CTXS.Config.getConfigValue("userInterface.uiViews.defaultView").toLowerCase(),g="AddFavoritesTitle",l="AddFavoritesDescription",m="AddFavoritesDescriptionPhone";e&&!k?(g="AddFavoritesTitleAppsOnly",l="AddFavoritesDescriptionAppsOnly",m="AddFavoritesDescriptionPhoneAppsOnly"):
!e&&k&&(g="AddFavoritesTitleDesktopsOnly",l="AddFavoritesDescriptionDesktopsOnly",m="AddFavoritesDescriptionPhoneDesktopsOnly");this.$homeView.find("#no-fav-msg-title").text(c.localization.string(g));this.$homeView.find("#no-fav-msg-desc").text(c.localization.string(l));this.$homeView.find("#no-fav-msg-desc-phone").text(c.localization.string(m));if(this.hasApps||this.hasDesktops)switch(h){case "auto":if(this.showMyHome){CTXS.Events.publish(CTXS.Events.ui.showMyHome);break}case "apps":if(this.hasApps){CTXS.Events.publish(CTXS.Events.ui.showAllApps);
break}else if(this.showMyHome){CTXS.Events.publish(CTXS.Events.ui.showMyHome);break}case "desktops":if(this.hasDesktops){CTXS.Events.publish(CTXS.Events.ui.showDesktops);break}else if(this.showMyHome){CTXS.Events.publish(CTXS.Events.ui.showMyHome);break}default:e?CTXS.Events.publish(CTXS.Events.ui.showAllApps):CTXS.Events.publish(CTXS.Events.ui.showDesktops)}else l=b&&!a?"YouCannotUseDesktops":"YouCannotUseAppsOrDesktops",this.$homeView.find(".no-apps-or-desktops-message").text(c.localization.string(l)).show(),
this.$homeView.find(".no-fav-results-message").removeClass("show")},_openThirdPartyUrl:function(a){a=a.attr("href");CTXS.Environment.openUrl(a)},_showAboutBox:function(){CTXS.Environment.showAboutBox(this.$userMenu.find("#dropdownAboutBtn"),this.$messageBoxOverlay,this.$aboutBox)},_showSettings:function(a){var b=a.offset(),c=b.left,k=b.top,h=a.outerWidth();a=a.outerHeight();CTXS.Environment.showSettings(c,k,b.left+h,b.top+a)},_hideAboutBoxAndOverlay:function(){CTXS.hidePopup(this.$messageBoxOverlay,
this.$aboutBox);this.$aboutBox.ctxsUnbindFocusWithin(this.$messageBoxOverlay).ctxsDisableArrowNavigation().ctxsUnbindHoverFocusEvents()},_hideAboutBox:function(){CTXS.hidePopup(c(),this.$aboutBox)},_autolaunchSingleDesktop:function(){var a=CTXS.Store.getDesktops()[0];"yes"!=CTXS.getCookie(CTXS.COOKIE_DESKTOP_AUTO_LAUNCH_DONE)&&(CTXS.setCookie(CTXS.COOKIE_DESKTOP_AUTO_LAUNCH_DONE,"yes"),CTXS.launchResource(a,!0),CTXS.ClientManager.getLaunchMethod()==CTXS.LaunchMethod.HTML5&&CTXS.popupsEnabled(c.localization.string("PopupBlockerDesktopAutoLaunch")))},
_initialiseSlidingUserMenu:function(a){this.nativeMenuPreferencesControl.hasNativeMenuPreferences&&(this.nativeMenuPreferencesControl.hasShowPreferencesPreference()||a.find(".menu-action.settings").addClass("hide"),this.nativeMenuPreferencesControl.hasAboutPreference()||a.find(".menu-action.about").addClass("hide"),this.nativeMenuPreferencesControl.hasRefreshPreference()||a.find(".menu-action.refresh").addClass("hide"),this.nativeMenuPreferencesControl.hasLogoffPreference()||a.find(".logoff-button").addClass("hide"))},
_changeReceiverTooltip:function(a){var b=CTXS.ClientManager.getLaunchMethod();a=a?c.localization.string("ChangeClientTooltipDownloadReceiver"):c.localization.string("ChangeClientTooltipChangeClient");switch(b){case "HTML5":b=c.localization.string("ChangeClientLaunchMethodHtml5");break;case "ICO":case "ProtocolHandler":b=c.localization.string("ChangeClientLaunchMethodNative");break;default:b=c.localization.string("ChangeClientLaunchMethodIca",a)}return c.localization.string("ChangeClientTooltip",b)},
initialiseSettingsView:function(){var a=[],b=this,e=this._createActivationLink(),k=CTXS.Config.getConfigValue("userInterface.workspaceControl"),h="true"==CTXS.Config.getConfigValue("pluginAssistant.showOnlyIfRequiredByApps"),g=CTXS.Store.requiresReceiver(),h=h&&!g;if(!this.nativeMenuPreferencesControl.isNativeDropdownNeeded()){e.show&&a.push({displayText:c.localization.string("ActivateReceiver"),id:"ActivateBtn",url:e.link,priority:!1,group:"Advanced",toolTip:c.localization.string("ActivateReceiverToolTip"),
icon:"embedded-settings-activate"});var e=CTXS.Device.isProtocolHandlerSupported()&&!CTXS.Device.isProtocolHandlerEnabled(),l=f(e);CTXS.Device.isNativeClient()||CTXS.Html5Client.isMandatory()||h||(h={priority:!1,group:"Advanced",icon:"embedded-settings-changeClient"},CTXS.Device.isProtocolHandlerSupported()&&CTXS.Device.isProtocolHandlerEnabled()?(h.id="ChangeClientBtn",h.displayText=c.localization.string(CTXS.Html5Client.isAvailable()?"ChangeClient":"InstallReceiver"),h.onClick=function(){CTXS.Events.publish(CTXS.Events.ui.changeClient)}):
(l&&(g={id:"DownloadClientBtn",displayText:c.localization.string("DownloadReceiver"),toolTip:c.localization.string("DownloadReceiverTooltip"),onClick:function(){CTXS.Events.publish(CTXS.Events.ui.downloadClient)},priority:!1,group:"Advanced",icon:"embedded-settings-changeClient"},a.push(g)),g=CTXS.Device.isProtocolHandlerSupported()||CTXS.Device.isBrowserPluginSupported(),!CTXS.Html5Client.isAvailable()||g&&!e||(h.id="ChangeClientBtn",h.displayText=c.localization.string("ChangeClient"),h.onClick=
function(){CTXS.Events.publish(CTXS.Events.ui.changeClientOnly)})),h.id&&(h.toolTip=function(){return b._changeReceiverTooltip(l)},a.push(h)));!CTXS.Device.isNativeClient()&&CTXS.Authentication.isPasswordChangeAllowed()&&a.push({displayText:c.localization.string("ChangePassword"),id:"ChangePasswordBtn",onClick:function(){b.changePasswordController.requestPasswordChangeUI()},group:"Account",priority:!1,icon:"embedded-settings-changePassword"});CTXS.Device.isNativeClient()||(e="true"==k.showReconnectButton,
h="true"==k.showDisconnectButton,CTXS.ExtensionsHead.showWebReconnectMenu(this.workspaceControl.isAllowed()&&e&&this.workspaceControl.isSessionReconnectAllowed())&&a.push({displayText:c.localization.string("Connect"),id:"ConnectBtn",onClick:function(){b.workspaceControl.reconnectAppSessions()},group:"Apps",priority:!1,icon:"embedded-settings-connect"}),CTXS.ExtensionsHead.showWebDisconnectMenu(this.workspaceControl.isAllowed()&&h)&&a.push({displayText:c.localization.string("Disconnect"),id:"DisconnectBtn",
onClick:function(){CTXS.Events.publish(CTXS.Events.ui.logoffRequested,{icaSessionLogoffAction:CTXS.ICA_SESSION_LOGOFF_ACTION.DISCONNECT})},group:"Apps",priority:!1,icon:"embedded-settings-disconnect"}));this.nativeMenuPreferencesControl.hasRefreshPreference()&&a.push({displayText:c.localization.string("Refresh"),id:"RefreshBtn",onClick:function(){CTXS.Environment.refresh()},group:"Account",priority:!0,icon:"embedded-settings-changeClient"});CTXS.Device.isNativeClient()&&!this.nativeMenuPreferencesControl.hasAboutPreference()||
a.push({displayText:c.localization.string("About"),id:"AboutBtn",onClick:function(){b._showAboutBox()},group:"Account",priority:!0,icon:"embedded-settings-about"});CTXS.Device.isNativeClient()&&!this.nativeMenuPreferencesControl.hasLogoffPreference()||a.push({displayText:c.localization.string("LogOff"),id:"LogOffBtn",onClick:function(){CTXS.Environment.logOff()},priority:!0,group:"Account",toolTip:!CTXS.Device.isNativeClient()&&this.workspaceControl.isAllowed()&&"disconnect"==k.logoffAction?c.localization.string("DisconnectApps"):
null,icon:"embedded-settings-logOff"});a={settings:a,dropDownOverlay:this.$homeView.find("#user-menu-overlay"),displayName:CTXS.UserInfo.getName(),showAccountSettingsAction:function(a){b._showSettingsView(c(a))}};this.settingsController=new CTXS.Controllers.SettingsController(this.$homeView.find(".settingsViewMain"),this.$userMenu,a)}},_addAboutBtn:function(a){var b=this;a.push({linkId:"aboutBtn",linkText:c.localization.string("About"),ariaLabel:c.localization.string("About"),onClick:function(){b._showAboutBox()}})},
_addLogOffBtn:function(a,b){a.push({linkId:"menuLogOffBtn",linkText:c.localization.string("LogOff"),ariaLabel:c.localization.string("LogOff"),toolTip:!CTXS.Device.isNativeClient()&&this.workspaceControl.isAllowed()&&"disconnect"==b?c.localization.string("DisconnectApps"):null,onClick:function(){CTXS.Environment.logOff()}})},_showSettingsView:function(a){this.nativeMenuPreferencesControl.isNativeDropdownNeeded()||this.nativeMenuPreferencesControl.hasShowPreferencesPreference()?this._showSettings(a):
CTXS.Events.publish(CTXS.Events.ui.showSettings)},_createActivationLink:function(){var a=CTXS.Store.requiresReceiver(),b=!CTXS.Device.isNativeClient()&&"true"==CTXS.Config.getConfigValue("userInterface.receiverConfiguration.enabled"),a="true"!=CTXS.Config.getConfigValue("userInterface.receiverConfiguration.showOnlyIfRequiredByApps")||a,c=!(CTXS.Device.isChromeOS()||CTXS.Device.isCitrixChromeApp()),b=b&&a&&c,a=CTXS.primaryStore.baseUrl+CTXS.Config.getConfigValue("userInterface.receiverConfiguration.downloadURL"),
c=CTXS.getCSRFToken();b&&a&&c&&(a=CTXS.updateQueryString(a,"CsrfToken",c),a=CTXS.updateQueryString(a,"IsUsingHttps",CTXS.isUsingHttps()));return{show:b&&a&&c,link:a}},initialiseNativeMenuPreferences:function(){var a={isNative:CTXS.Device.isNativeClient(),capabilities:CTXS.NativeCapabilities};this.nativeMenuPreferencesControl=new CTXS.NativeMenuPreferencesControl(a)},initialiseWorkspaceControl:function(){var a={isEnabled:"true"==CTXS.Config.getConfigValue("userInterface.workspaceControl.enabled"),
isUnauthenticatedStore:this.store.isUnauthenticatedStore(),isHtml5Launch:CTXS.ClientManager.getLaunchMethod()==CTXS.LaunchMethod.HTML5,isSingleTabLaunch:"true"==CTXS.Config.getConfigValue("pluginAssistant.html5.singleTabLaunch"),icaDetails:{isPassThrough:CTXS.ClientManager.isPassThroughSession(),usingNativeClientInInternetZone:CTXS.ClientManager.usingNativeClientInInternetZone()},isAppShortcutLaunch:CTXS.AppShortcuts.isAppShortcutLaunch(),userHasAppsInStore:0<this.store.getAllApps().length,autoReconnectAtLogon:"true"===
CTXS.Config.getConfigValue("userInterface.workspaceControl.autoReconnectAtLogon"),appShortcutsAllowSessionReconnect:"true"===CTXS.Config.getConfigValue("userInterface.appShortcuts.allowSessionReconnect"),autoLaunchSingleDesktop:CTXS.Store.canAutoLaunchSingleDesktop(),listSessionsUrl:CTXS.Config.getConfigValue("storeProxy.sessionsProxy.listAvailableURL"),displayReconnectFailureCallback:function(){CTXS.Environment.showDialog({messageText:c.localization.string("SessionsListFailure"),id:"SessionsListFailure"})},
displayPopupBlockerMessageCallback:function(){CTXS.Environment.showDialog({messageText:c.localization.string("PopupBlockerReconnectApps"),id:"PopupBlockerReconnectApps"})},messageForPopupBlockerReconnectApps:c.localization.string("PopupBlockerReconnectApps")};this.workspaceControl=new CTXS.WorkspaceControl(a)}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.LogoffControllerMock={enabled:!1,icaSessionsClosed:!0,webSessionTerminated:!0,gatewaySessionTerminated:!0};CTXS.Controllers.LogoffController=function(f,b){this.$logoffView=f;this.$logoffProgress=this.$logoffView.find(".logoff-progress");this.$spinner=this.$logoffProgress.find(".authentication-spinner");this.$logoffComplete=this.$logoffView.find(".logoff-complete");this.logoffSpinner=new CTXS.AnimatedSpinner;this.defaultOptions=
{icaSessionLogoffAction:b,successMessage:c.localization.string("YouHaveLoggedOff"),failureMessage:c.localization.string("LogoffError"),sessionExpired:!1}};CTXS.Controllers.LogoffController.prototype={logOff:function(f){var b=this,a=CTXS.Environment.isGatewaySession(),d=c.extend({},this.defaultOptions,f);f=new CTXS.LogoffManager({icaLogoffServiceUrl:CTXS.Config.getConfigValue("storeProxy.sessionsProxy.logoffURL"),icaDisconnectServiceUrl:CTXS.Config.getConfigValue("storeProxy.sessionsProxy.disconnectURL"),
authClientLogoffUrl:CTXS.Config.getConfigValue("authManager.logoffURL"),sessionExpired:d.sessionExpired});this.$logoffView.ctxsDisplayPane();this.logoffSpinner.start(this.$spinner);CTXS.Device.isCitrixChromeApp()&&CTXS.Html5Client.postHideAccountSettingsToChromeApp();f.logOff(d.icaSessionLogoffAction,function(c){b._handleLogoffResult(c,d,a)})},_handleLogoffResult:function(f,b,a){var d={errorMessages:[],infoMessages:[],showLogonButton:!0,showIdpLogoffButton:!1,idpLogoffButtonText:null,idpLogoffCountdownTime:0};
CTXS.LogoffControllerMock.enabled&&(f.icaSessionsClosed=CTXS.LogoffControllerMock.icaSessionsClosed,f.webSessionTerminated=CTXS.LogoffControllerMock.webSessionTerminated,f.gatewaySessionTerminated=CTXS.LogoffControllerMock.gatewaySessionTerminated);var e=!f.webSessionTerminated||!f.gatewaySessionTerminated,k=CTXS.Authentication.isWebViewLogon()&&"GenericForms"==CTXS.Authentication.currentAuthMethod,h=CTXS.Authentication.isWebViewLogon()&&!!CTXS.Authentication.getIdpLogoffUrl();h&&b.sessionExpired&&
!a&&(CTXS.Authentication.setBrowserCloseRequiredToEndSession(!0),h=CTXS.allowReloginWithoutBrowserClose=!1);a&&CTXS.Authentication.getIdpLogoffUrl()&&(h=!0,CTXS.Authentication.setBrowserCloseRequiredToEndSession(!1));var g=CTXS.Authentication.isBrowserCloseRequiredToEndSession()&&!CTXS.allowSmartcardRelogin&&!CTXS.allowReloginWithoutBrowserClose;f.icaSessionsClosed||d.errorMessages.push(c.localization.string("LogOffSessionsFailed"));if(h){if(f.icaSessionsClosed&&f.webSessionTerminated&&f.gatewaySessionTerminated){CTXS.Authentication.redirectBrowserToIdpLogoffUrl();
return}d.showLogonButton=!1;if(e&&(CTXS.Authentication.setBrowserCloseRequiredToEndSession(!0),f.icaSessionsClosed)){CTXS.Authentication.redirectBrowserToIdpLogoffUrl();return}d.showIdpLogoffButton=!0;d.infoMessages.push(c.localization.string("ClickContinueToRedirectToIdpLogoffUrl"));d.idpLogoffCountdownTime=30;d.idpLogoffButtonText=c.localization.string("ContinueIdpLogoff");var l=CTXS.Authentication.getRedirectBrowserToIdpLogoffFunction();d.onIdpLogoffButtonClick=function(){l()}}else e?(d.errorMessages.push(c.localization.string("CloseYourBrowserToEndSession")),
d.showLogonButton=!1):k?(d.showLogonButton=!0,d.infoMessages.push(c.localization.string("CloseYourBrowserToProtectAccountSAML")),CTXS.Authentication.setBrowserCloseRequiredToEndSession(!1)):g&&(d.showLogonButton=!1,d.infoMessages.push(c.localization.string("CloseYourBrowserToProtectAccount")));d.title=0<d.errorMessages.length?b.failureMessage:b.successMessage;if(d.showLogonButton){var m=this._generateLogonButtonUrl(a);d.logonButtonText=CTXS.Store.isUnauthenticatedStore()?c.localization.string("BackToAppsAndDesktops"):
c.localization.string("LogOn");d.onLogonButtonClick=function(){CTXS.alternateEval('window.location.href ="'+m+'"')}}var v=CTXS.Authentication.getSavedAuthenticationMethod();v&&(d.showLogonMethodCheckbox=!0,d.logonMethodCheckboxLabel=c.localization.string("RememberLogonMethod"),d.onLogonMethodCheckboxClick=function(){this.checked?CTXS.Authentication.setSavedAuthenticationMethod(v):CTXS.Authentication.clearSavedAuthenticationMethod()});new CTXS.Widgets.LogoffWidget(this.$logoffComplete,d);this.$logoffProgress.hide();
this.logoffSpinner.stop(this.$spinner);this.$logoffComplete.show().ctxsPlaceFocusOnFirstElement();CTXS.Events.publish(CTXS.Events.ui.logoffComplete)},_generateLogonButtonUrl:function(c){c=c?CTXS.AccessGateway.getLogonPointUrl():CTXS.Location.href;-1<c.indexOf("#")&&(c=c.substr(0,c.indexOf("#")));return c}}})(jQuery);
(function(c){var f={title:null,content:null,errorMessages:[],infoMessages:[],showLogonButton:!0,logonButtonText:null,onLogonButtonClick:function(){},showLogonMethodCheckbox:!1,logonMethodCheckboxLabel:null,onLogonMethodCheckboxClick:function(){},showIdpRedirectButton:!1,idpLogoffButtonText:null,idpLogoffCountdownTime:0,onIdpLogoffButtonClick:function(){}};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.LogoffWidget=function(b,a){this.options=c.extend({},f,a);this.$container=
b;this._secondsRemainingUntilIdpLogoff=0;this._renderTitle();this._renderContent();this._renderLogonButton();this._renderIdpLogoffButtonAndStartRedirectTimer();this._renderLogonMethodCheckbox()};CTXS.Widgets.LogoffWidget.prototype={_renderTitle:function(){var b=this.$container.find(".logoff-complete-title");this.options.title?b.html(this.options.title).show():b.hide()},_renderContent:function(){var b=this.$container.find(".logoff-complete-content");if(this.options.content||0<this.options.errorMessages.length||
0<this.options.infoMessages.length){var a="";this.options.content&&(a+="<p>"+this.options.content+"</p>");c.each(this.options.errorMessages,function(b,c){a+="<p>"+c+"</p>"});var d=this._secondsRemainingUntilIdpLogoff;c.each(this.options.infoMessages,function(b,c){c=c.replace("{IDPLogoffSecondsRemaining}",d);a+="<p>"+c+"</p>"});b.html(a)}else b.hide()},_renderLogonButton:function(){var b=this,a=this.$container.find(".logon-button");if(this.options.showLogonButton)a.html(this.options.logonButtonText).show().on("click",
function(a){a.preventDefault();b.options.onLogonButtonClick()});else a.hide()},_renderIdpLogoffButtonAndStartRedirectTimer:function(){var b=this,a=this.$container.find(".idplogoff-button");this.options.showIdpLogoffButton?(a.html(this.options.idpLogoffButtonText).show().on("click",function(a){a.preventDefault();b.options.onIdpLogoffButtonClick()}),b._secondsRemainingUntilIdpLogoff=this.options.idpLogoffCountdownTime,0<b._secondsRemainingUntilIdpLogoff&&b._tickDownIdpLogoffTimer(b)):a.hide()},_tickDownIdpLogoffTimer:function(b){if(0<
b._secondsRemainingUntilIdpLogoff)b._renderContent(),b._secondsRemainingUntilIdpLogoff--,setTimeout(function(){b._tickDownIdpLogoffTimer(b)},1E3);else b.options.onIdpLogoffButtonClick()},_renderLogonMethodCheckbox:function(){var b=this.$container.find(".remember-logon-method");this.options.showLogonMethodCheckbox?(b.find("label").html(this.options.logonMethodCheckboxLabel),b.find("input").on("click",this.options.onLogonMethodCheckboxClick)):b.hide()}}})(jQuery);
(function(c){function f(){d();CTXS.Localization.init(CTXS.Environment.getPreferredLanguages(),a)}function b(){CTXS.trace("Configuration Failure");CTXS.Events.publish(CTXS.Events.session.terminate);CTXS.showTerminalErrorMessage(c.localization?c.localization.string("CannotCompleteYourRequest"):"Cannot complete your request.")}function a(){D.ctxsLocalize();!CTXS.Device.isNativeClient()&&CTXS.areCookiesDisabled()?(e(),c(".cookie-error-view").show()):CTXS.Plugins.initialize(CTXS.Config.getConfigValue("plugins"),
function(){CTXS.Device.isSupported()?CTXS.Device.isCitrixChromeApp()&&!CTXS.Html5Client.isTrustedChromeAppOrigin()?c(".chrome-App-Origin-Mismatch").show():(C=new CTXS.Controllers.LogoffController(B.find(".logoff-view"),CTXS.ExtensionsHead.webLogoffIcaAction(CTXS.Config.getConfigValue("userInterface.workspaceControl.logoffAction"))),CTXS.ExtensionsHead.beforeLogon(function(){CTXS.Device.isNativeClient()||"true"==CTXS.Config.getConfigValue("pluginAssistant.showAfterLogin")?l():CTXS.Device.isBrowserPluginSupported()?
Z.initialise(void 0):t.initialise()})):CTXS.showUnsupportedDeviceMessage()})}function d(){var a=CTXS.Html5Client.isMandatory(),b=CTXS.Config.getConfigValue("pluginAssistant.win32.path"),c=CTXS.Config.getConfigValue("pluginAssistant.win32.version"),d=CTXS.Config.getConfigValue("pluginAssistant.macOS.path"),g=CTXS.Config.getConfigValue("pluginAssistant.macOS.version"),e="true"===CTXS.Config.getConfigValue("pluginAssistant.enabled"),c=CTXS.Device.isWindowsPlatform()?c:g,b=(CTXS.Device.isWindowsPlatform()?
b:d)||"",d=function(){q?y():"true"==CTXS.Config.getConfigValue("pluginAssistant.showAfterLogin")?m():(B.find(".loading-screen").ctxsDisplayPane(),l())};CTXS.Device.isBrowserPluginSupported()?Z=new CTXS.Controllers.PluginMasterController({pluginAssistantIsEnabled:e,isHtml5ClientMandatory:a,serverVersion:c,clientInstallUrl:b,onComplete:d}):t=new CTXS.Controllers.ProtocolHandlerController({isProtocolHandlerEnabled:CTXS.Device.isProtocolHandlerSupported()&&"true"===CTXS.Config.getConfigValue("pluginAssistant.protocolHandler.enabled"),
isHtml5ClientMandatory:a,isHtml5FallbackAvailable:CTXS.Config.getConfigValue("pluginAssistant.html5.enabled")===CTXS.Html5Client.ENABLED_FALLBACK,isReceiverDownloadAllowed:e&&!CTXS.Device.isLinux()&&!CTXS.Device.isChromeOS(),getDetectionTicketUrl:CTXS.Config.getConfigValue("storeProxy.clientAssistantProxy.getDetectionTicketURL"),getDetectionStatusUrl:CTXS.Config.getConfigValue("storeProxy.clientAssistantProxy.getDetectionStatusURL"),clientInstallUrl:b,serverVersion:c,onComplete:d})}function e(){fa||
(CTXS.Environment.notifyWebUIReady(),CTXS.Events.publish(CTXS.Events.ui.ready),fa=!0)}function k(){CTXS.Device.isNativeClient()||(P=new CTXS.SessionMonitor(I,{notificationStringMinutes:c.localization.string("SessionExpiresInMinutes"),notificationStringSeconds:c.localization.string("SessionExpiresInSeconds"),refreshString:c.localization.string("Refresh"),sessionTimeoutInterval:CTXS.Config.getConfigValue("session.timeout"),suppressSessionTimeoutWarnings:CTXS.suppressSessionTimeoutWarnings||!1,performRefresh:function(){CTXS.WebApiClient.refreshSession(CTXS.Config.getConfigValue("storeProxy.keepAliveURL"))},
onSessionRefresh:function(){},onSessionExpiry:function(){s({icaSessionLogoffAction:CTXS.ICA_SESSION_LOGOFF_ACTION.NONE,successMessage:c.localization.string("SessionTimedOut"),failureMessage:c.localization.string("SessionTimedOut"),sessionExpired:!0})}}),P.start(),CTXS.Events.subscribe(CTXS.Events.session.refreshed,function(){P.refreshed()}));U=!0}function h(){l()}function g(){CTXS.Events.publish(CTXS.Events.error.terminalState)}function l(){CTXS.Bootstrapper.loadAggregatedStore(function(){CTXS.showTerminalErrorMessage(c.localization.string("CannotGetYourAppsFromStore"))})}
function m(){e();CTXS.ExtensionsHead.beforeDisplayHomeScreen(function(){B.find(".home-view").ctxsDisplayPane();z=new CTXS.Controllers.HomeController(B,CTXS.Store);q||(c(".initial-hide").removeClass("initial-hide"),CTXS.ExtensionAPI.resize(!0),CTXS.ExtensionsHead.postAppListLoaded(CTXS.Store),CTXS.ExtensionsHead.afterDisplayHomeScreen(),CTXS.Events.publish(CTXS.Events.ui.loaded),q=!0)})}function v(){c(window).on("resize",A);c(document).on("keydown keyup",E);B.on("selectstart",O);H.find(".about-button-back").on("click",
function(a){a.preventDefault();X.ctxsDisplayPane()})}function n(){CTXS.Events.subscribe(CTXS.Events.ui.showMessage,function(a,b){e();CTXS.ExtensionsHead.showMessageBox(b,function(){I&&I.show(b)})});CTXS.Events.subscribe(CTXS.Events.error.terminalState,function(){P&&P.stop();CTXS.Events.publish(CTXS.Events.session.terminate);CTXS.showTerminalErrorMessage(c.localization?c.localization.string("CannotCompleteYourRequest"):"Cannot complete your request.")});CTXS.Events.subscribe(CTXS.Events.resources.unauthorized,
G);CTXS.Events.subscribe(CTXS.Events.resources.challenged,function(){CTXS.showAuthenticationErrorMessage(!0)});CTXS.Events.subscribe(CTXS.Events.gateway.sessionTerminated,function(){CTXS.Device.isNativeClient()?CTXS.showAuthenticationErrorMessage(!0):window.location.href=CTXS.AccessGateway.getLogonPointUrl()});CTXS.Events.subscribe(CTXS.Events.store.initialised,function(){U||k();var a="true"==CTXS.Config.getConfigValue("pluginAssistant.showAfterLogin"),b="true"==CTXS.Config.getConfigValue("pluginAssistant.showOnlyIfRequiredByApps"),
c=CTXS.Store.requiresReceiver(),b=b&&!c;CTXS.Device.isNativeClient()||!a||b?m():CTXS.Device.isBrowserPluginSupported()?Z.initialise(!0):t.initialise()})}function G(a,b){CTXS.Device.isNativeClient()?CTXS.showAuthenticationErrorMessage(!1):x.authenticate(b)}function u(){CTXS.Events.subscribe(CTXS.Events.ui.logoffRequested,function(a,b){s(b)});CTXS.Events.subscribe(CTXS.Events.ui.logoffComplete,r);CTXS.Events.subscribe(CTXS.Events.ui.changeClient,function(){t.showUI(!0)});CTXS.Events.subscribe(CTXS.Events.ui.downloadClient,
function(){t.showDownloadOnlyUI()});CTXS.Events.subscribe(CTXS.Events.ui.changeClientOnly,function(){ba.showUI()});CTXS.Events.subscribe(CTXS.Events.ui.showPhoneAbout,function(){var a=H.find("#html5ThirdPartyNoticesPhoneBtn");CTXS.displayHTML5ThirdPartyNoticesLink(a);H.ctxsDisplayPane()})}function y(){B.find(".home-view").ctxsDisplayPane();z.initialiseWorkspaceControl();z.initialiseSettingsView();z.resize()}function s(a){P&&P.stop();CTXS.Events.publish(CTXS.Events.session.terminating);C.logOff(a)}
function r(){B.find(".fullscreen-pane").not(".logoff-view").add(B.find(".messageBoxPopup")).add(B.find(".dialogBox")).add(B.find(".ruler-container")).add(B.find(".myapps-ruler-container")).empty();c(window).off("resize");c(document).off("keydown keyup");var a=/^(trace|setCookie|removeCookie|Authentication|alternateEval|COOKIE_.*)$/i,b;for(b in CTXS)a.test(b)||delete CTXS[b]}function E(a){CTXS.Device.isNativeClient()&&a.which==c.ui.keyCode.BACKSPACE&&(c(a.target).is("input, textarea")||a.preventDefault())}
function A(){CTXS.trace("Got Resize Event");var a=Q;Q=CTXS.Device.getOrientation();if(CTXS.Device.isDesktop()||Q!=a)CTXS.trace("call _resize"),Q!=a?setTimeout(F,1):F()}function O(a){-1==c.inArray(a.target.tagName,ia)&&a.preventDefault()}function F(){z&&z.resize()}var z,x,C,I,Q=null,P,D=c("html"),B=c("body"),q=!1,Z=null,t=null,ba,H=B.find(".about-view"),X=B.find(".home-view"),fa=!1,U=!1,ia=["INPUT","SELECT","SPAN"];window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.MasterController=
{patch:function(a){eval(a)},initialise:function(){CTXS.trace("mastercontroller.initialize");CTXS.Device.isLegacyIE()&&D.addClass("isLegacyIE");CTXS.Environment.enableAppUpdates&&D.addClass("app-updates-supported");CTXS.isHighContrastEnabled()&&CTXS.Device.isIE11()&&D.addClass("high-contrast");D.addClass(CTXS.Device.isNativeClient()?"native-client":"web-browser");Q=CTXS.Device.getOrientation();I=new CTXS.Widgets.MessageWidget(c("#genericMessageBoxPopup"),c("#genericMessageBoxOverlay"));x=new CTXS.Controllers.AuthenticationController(B.find(".authentication-view"),
B.find(".explicit-auth-view"),B.find(".auth-password-expiry-view"),{onAuthenticationSuccess:k,onAuthenticationError:g,onComplete:h});CTXS.Device.supportsHighResDisplay()&&D.addClass("is-hdpi");ba=new CTXS.Controllers.ChangeClientController({onComplete:function(){y()}});v();n();u();CTXS.ExtensionsHead.postInitialize(function(){CTXS.Bootstrapper.loadConfiguration(f,b)})},revertToDefaultView:function(){z.setDefaultView()}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={pollIntervalMs:500,onPluginActivated:function(){}};CTXS.Widgets.PluginActivationWidget=function(b,a){this.$pluginActivationView=b;this.$pluginActivationElement=b.find(".activate-plugin-content");this.options=c.extend(f,a)};CTXS.Widgets.PluginActivationWidget.prototype={_showFirefoxUI:function(){var b='<object type="application/x-ica" class="activate-plugin-box firefox"><p>'+c.localization.string("ActivateCitrixPluginBrowser")+
'</p><param name="BackgroundColor" value="#484848"><param name="Border" value="0"><param name="CustomMessage" value=""><param name="UIActive" value="true"></object>',a=this.title+'<p class="activate-plugin-text detail-text">'+c.localization.string("AllowPluginToRun")+"</p>"+b;this.$pluginActivationElement.on("click",".activate-plugin-box",function(){c(this).replaceWith(b)});this.$pluginActivationElement.html(a)},_showChromeUI:function(){var b=this.title+'<p class="activate-plugin-text chrome detail-text">'+
c.localization.string("ChromePluginHelperMessage").format('<a class="link" href="http://support.citrix.com/article/CTX141137" target="_blank">CTX141137</a>')+"</p>";this.$pluginActivationElement.html(b)},_showSafariUI:function(){var b='<object type="application/x-ica" class="activate-plugin-box safari"><p>'+c.localization.string("ActivateCitrixPluginBrowser")+"</p></object>",b=this.title+'<p class=activate-plugin-text detail-text">'+c.localization.string("AllowPluginToRun")+"</p>"+b;this.$pluginActivationElement.html(b);
this.$pluginActivationElement.ctxsPlaceFocusOnFirstElement()},startPolling:function(){var b=this;this.pollIntervalId=setInterval(function(){CTXS.ICA.update();CTXS.ICA.isPluginBlocked||(clearInterval(b.pollIntervalId),b.options.onPluginActivated())},this.options.pollIntervalMs)},showUI:function(){var b=CTXS.Device.isFirefox()?"ActivateCitrixPlugin":"UnblockCitrixPlugin";this.title='<h1 class="main-text">'+c.localization.string(b)+"</h1>";this.startPolling();CTXS.Device.isFirefox()?this._showFirefoxUI():
CTXS.Device.isChrome()?this._showChromeUI():CTXS.Device.isSafari()&&this._showSafariUI();this.$pluginActivationView.ctxsDisplayPane()}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};var f=c("#plugin-assistance-download-unavailable"),b=c("#plugin-assistance-download"),a={upgrade:!1,serverVersion:"",pluginInstallUrl:"",onPluginAssistanceComplete:function(){}};CTXS.Controllers.PluginAssistantController=function(b){this.options=c.extend({},a,b);this.pluginPollingWidget=this.pluginDownloadWidget=null};CTXS.Controllers.PluginAssistantController.prototype={initialise:function(a){if(""===this.options.pluginInstallUrl)this._initialisePluginDownloadWidget(),
this.pluginDownloadWidget.showDownloadUnavailableUI(f);else{var c=CTXS.getCookie(CTXS.PluginDetectionConstants.COOKIE_PLUGIN_ASSISTANT_STATE);CTXS.Device.isIE()&&c===CTXS.PluginDetectionConstants.PLUGIN_ASSISTANT_INSTALLING?(this._initialisePluginPollingWidget(),this.pluginPollingWidget.showUI()):(this._initialisePluginDownloadWidget(),this.pluginDownloadWidget.showDownloadUI(b,a))}},_initialisePluginDownloadWidget:function(){this.pluginDownloadWidget=new CTXS.Widgets.PluginDownloadWidget({upgrade:this.options.upgrade,
pluginInstallUrl:this.options.pluginInstallUrl,onSkipInstall:c.proxy(this.onPluginAssistanceComplete,this),onPluginInstall:c.proxy(this.onPluginInstall,this)})},_initialisePluginPollingWidget:function(){var a=CTXS.Device.isIE()&&this.options.upgrade,b=a?c("#plugin-assistance-polling-ie-upgrade"):c("#plugin-assistance-polling"),k=a?b.find(".polling-plugin-ie"):b.find(".polling-plugin");this.pluginPollingWidget=new CTXS.Widgets.PluginPollingWidget(b,k,{isIEUpgrade:a,isPluginInstalled:c.proxy(this.isPluginInstalled,
this),onSkipPollingWait:c.proxy(this.onPluginAssistanceComplete,this),onPluginAssistanceComplete:c.proxy(this.onPluginAssistanceComplete,this)})},onPluginInstall:function(){CTXS.Device.isIE()&&CTXS.setCookie(CTXS.PluginDetectionConstants.COOKIE_PLUGIN_ASSISTANT_STATE,CTXS.PluginDetectionConstants.PLUGIN_ASSISTANT_INSTALLING);this._initialisePluginPollingWidget();this.pluginPollingWidget.showUI()},onPluginAssistanceComplete:function(){CTXS.setCookie(CTXS.PluginDetectionConstants.COOKIE_PLUGIN_ASSISTANT_STATE,
CTXS.PluginDetectionConstants.PLUGIN_ASSISTANT_DONE);this.options.onPluginAssistanceComplete()},isPluginInstalled:function(){CTXS.ICA.init();if(CTXS.ICA.icaPlugin.isInstalled()&&CTXS.ICA.isPluginScriptable){if(!this.options.upgrade||CTXS.isUpToDateVersion(CTXS.ICA.version,this.options.serverVersion))return CTXS.trace("Polling - Detected"),!0}else CTXS.trace("Polling - Not Detected");return!1}}})(jQuery);
(function(c){var f={pluginAssistantIsEnabled:!1,isHtml5ClientMandatory:!1,serverVersion:"",clientInstallUrl:"",onComplete:function(){}};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.PluginDetectionConstants={COOKIE_PLUGIN_ASSISTANT_STATE:"CtxsPluginAssistantState",PLUGIN_ASSISTANT_DONE:"Done",PLUGIN_ASSISTANT_INSTALLING:"Installing"};CTXS.pluginActivationUIEnabled=!0;CTXS.Controllers.PluginMasterController=function(b){this.options=c.extend({},f,b)};CTXS.Controllers.PluginMasterController.prototype=
{initialise:function(b){this.options.isHtml5ClientMandatory?this._onComplete():(this.isAfterLogon=b,CTXS.ICA.init(),this.pluginActivationWidget=new CTXS.Widgets.PluginActivationWidget(c("#plugin-activation"),{pollIntervalMs:500,onPluginActivated:c.proxy(this.onPluginActivationComplete,this)}),this.pluginAssistantController=new CTXS.Controllers.PluginAssistantController({upgrade:CTXS.ClientManager.isNativeClientUpgradeable(this.options.serverVersion),serverVersion:this.options.serverVersion,pluginInstallUrl:this.options.clientInstallUrl,
onPluginAssistanceComplete:c.proxy(this.onPluginAssistanceComplete,this)}),this.decideAction())},onPluginActivationComplete:function(){this.decideAction()},onPluginAssistanceComplete:function(){this.decideAction()},decideAction:function(){this._isPluginAssistanceRequired()?this._isPluginActivationRequired()?this.pluginActivationWidget.showUI():this._isPluginDetectionRequired()?this.pluginAssistantController.initialise(this.isAfterLogon):this._onComplete():this._onComplete()},_onComplete:function(){CTXS.setCookie(CTXS.PluginDetectionConstants.COOKIE_PLUGIN_ASSISTANT_STATE,
CTXS.PluginDetectionConstants.PLUGIN_ASSISTANT_DONE);this.options.onComplete()},_isPluginAssistanceRequired:function(){return this.options.pluginAssistantIsEnabled&&!this.options.isHtml5ClientMandatory&&!CTXS.Device.isMobileDevice()&&!CTXS.Device.isProtocolHandlerSupported()},_isPluginActivationRequired:function(){var b=(CTXS.Device.isFirefox()||CTXS.Device.isChrome()||CTXS.Device.isSafari())&&(CTXS.Device.isWindowsPlatform()||CTXS.Device.isMacOSX()||CTXS.Device.isLinux());return CTXS.ICA.isPluginBlocked&&
b&&CTXS.pluginActivationUIEnabled},_isPluginDetectionRequired:function(){var b=!CTXS.ICA.isInstalled&&!CTXS.ClientManager.isNativeClientPreferred()||CTXS.ClientManager.isNativeClientUpgradeable(this.options.serverVersion),a=!CTXS.Device.isUnsupportedMacOSXVersion()&&!(CTXS.Device.isIE()&&CTXS.Device.isWindowsRT())&&!CTXS.Device.isLinux(),c=CTXS.getCookie(CTXS.PluginDetectionConstants.COOKIE_PLUGIN_ASSISTANT_STATE)!==CTXS.PluginDetectionConstants.PLUGIN_ASSISTANT_DONE;return b&&a&&c}}})(jQuery);
(function(){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var c={isIEUpgrade:!1,isPluginInstalled:function(){},onSkipPollingWait:function(){},onPluginAssistanceComplete:function(){}};CTXS.Widgets.PluginPollingWidget=function(f,b,a){this.options=$.extend(c,a);this.$view=f;this.$element=b;this.$skipPollingWait=this.$element.find(".skip-polling-wait");this.pollingIntervalId=null;var d=this;this.options.isIEUpgrade&&(this.$securityDetails=this.$element.find(".securitydetails-popup-ie"),this.$securityDetailsLink=
this.$element.find(".securitydetailslink"),this.$securityDetailsLink.ctxsAddCustomTooltip(this.$securityDetails,this.$element));this.$skipPollingWait.click(function(a){a.preventDefault();d.skipPollingWait()})};CTXS.Widgets.PluginPollingWidget.prototype={showUI:function(){this.startPolling();this.$view.ctxsDisplayPane()},startPolling:function(){var c=this;this.pollingIntervalId=setInterval($.proxy(function(){c.options.isPluginInstalled()&&(clearInterval(c.pollingIntervalId),c.options.onPluginAssistanceComplete())},
this),1E3)},skipPollingWait:function(){clearInterval(this.pollingIntervalId);this.options.onSkipPollingWait()}}})();
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={onCheck:function(){},onUpgradeLater:function(){}};CTXS.Widgets.ProtocolHandlerCheckUpgradeWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$checkButton=this.$view.find(".installbutton");this.$upgradeLaterLink=this.$view.find(".checkupgrade-upgrade-later");this.$upgradeLaterLink.attr("title",c.localization.string("UpgradeLaterTip"));this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerCheckUpgradeWidget.prototype=
{showUI:function(){this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$checkButton.click(function(a){a.preventDefault();b.options.onCheck()});this.$upgradeLaterLink.click(function(a){a.preventDefault();b.options.onUpgradeLater()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.protocolHandlerPollInterval=1E3;CTXS.Controllers=CTXS.Controllers||{};var f={isProtocolHandlerEnabled:!1,clientInstallUrl:"",isHtml5ClientMandatory:!1,isHtml5FallbackAvailable:!1,isReceiverDownloadAllowed:!1,getDetectionTicketUrl:"",getDetectionStatusUrl:"",serverVersion:"",onComplete:function(){}};CTXS.Controllers.ProtocolHandlerController=function(b){this.options=c.extend({},f,b);this.$welcomeView=c("#protocolhandler-welcome");this.$detectView=c("#protocolhandler-detect");
this.$downloadView=c("#protocolhandler-download");this.$validateView=c("#protocolhandler-validate");this.$upgradeAvailableView=c("#protocolhandler-upgradeavailable");this.$checkUpgradeView=c("#protocolhandler-checkupgrade");this.$detectUpgradeView=c("#protocolhandler-detectupgrade");this.$noUpgradesView=c("#protocolhandler-noupgrades")};CTXS.Controllers.ProtocolHandlerController.prototype={initialise:function(){this.isClientDetectionEnabled()||(CTXS.removeCookie(CTXS.ClientDetection.COOKIE_IS_PASSTHROUGH),
CTXS.removeCookie(CTXS.ClientDetection.COOKIE_CLIENT_VERSION),CTXS.setCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE,"true",!0));this.upgradeNeeded=CTXS.ClientManager.isNativeClientUpgradeable(this.options.serverVersion);this._initialiseWelcomeWidget();this._initialiseDetectWidget();this._initialiseDownloadWidget();this._initialiseValidateWidget();this._initialiseUpgradeAvailableWidget();this._initialiseCheckUpgradeWidget();this._initialiseDetectUpgradeWidget();this._initialiseNoUpgradesWidget();
this.isClientDetectionWizardRequired()?this.showUI(!1):this._onComplete()},showUI:function(b){this.upgradeNeeded&&!b?(this.isUpgradeFlow=!0,this.checkUpgradeWidget.showUI()):(this.isUpgradeFlow=!1,this.welcomeWidget.showUI())},showDownloadOnlyUI:function(){this.detectWidget.showUI()},isClientDetectionEnabled:function(){return this.options.isProtocolHandlerEnabled&&!CTXS.Device.isMobileDevice()&&!this.options.isHtml5ClientMandatory},isUpgradeWizardRequired:function(){return this.upgradeNeeded&&"true"!=
CTXS.getCookie(CTXS.ClientDetection.COOKIE_HAS_UPGRADE_BEEN_SHOWN)},isClientDetectionWizardRequired:function(){return CTXS.Device.isProtocolHandlerSupported()&&(this.isUpgradeWizardRequired()||"true"!=CTXS.getCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE))},_initialiseWelcomeWidget:function(){this.welcomeWidget=new CTXS.Widgets.ProtocolHandlerWelcomeWidget(this.$welcomeView,{isHtml5FallbackAvailable:this.options.isHtml5FallbackAvailable,onDetect:c.proxy(this.onDetect,this),onUseLightVersion:c.proxy(this.onUseLightVersion,
this)})},_initialiseDetectWidget:function(){this.detectWidget=new CTXS.Widgets.ProtocolHandlerDetectWidget(this.$detectView,{isProtocolHandlerEnabled:this.options.isProtocolHandlerEnabled,isHtml5FallbackAvailable:this.options.isHtml5FallbackAvailable,isReceiverDownloadAllowed:this.options.isReceiverDownloadAllowed,clientInstallUrl:this.options.clientInstallUrl,onRetryDetection:c.proxy(this.onRetryDetection,this),onDownload:c.proxy(this.onDownload,this),onUseLightVersion:c.proxy(this.onUseLightVersion,
this),onAlreadyInstalled:c.proxy(this.onAlreadyInstalled,this)})},_initialiseDownloadWidget:function(){this.downloadWidget=new CTXS.Widgets.ProtocolHandlerDownloadWidget(this.$downloadView,{isHtml5FallbackAvailable:this.options.isHtml5FallbackAvailable,clientInstallUrl:this.options.clientInstallUrl,onInstallComplete:c.proxy(this.onInstallComplete,this),onUseLightVersion:c.proxy(this.onUseLightVersion,this)})},_initialiseValidateWidget:function(){this.validateWidget=new CTXS.Widgets.ProtocolHandlerValidateWidget(this.$validateView,
{isHtml5FallbackAvailable:this.options.isHtml5FallbackAvailable,onRetryDetection:c.proxy(this.onRetryDetection,this),onRetryDownload:c.proxy(this.onDownload,this),onUseLightVersion:c.proxy(this.onUseLightVersion,this),onAlreadyInstalled:c.proxy(this.onAlreadyInstalled,this)})},_initialiseCheckUpgradeWidget:function(){this.checkUpgradeWidget=new CTXS.Widgets.ProtocolHandlerCheckUpgradeWidget(this.$checkUpgradeView,{onCheck:c.proxy(this.onCheckForUpgrade,this),onUpgradeLater:c.proxy(this.onUpgradeLater,
this)})},_initialiseUpgradeAvailableWidget:function(){this.upgradeAvailableWidget=new CTXS.Widgets.ProtocolHandlerUpgradeAvailableWidget(this.$upgradeAvailableView,{onDownload:c.proxy(this.onDownload,this),onUpgradeLater:c.proxy(this.onUpgradeLater,this),onAlreadyInstalled:c.proxy(this.onAlreadyInstalled,this),onUseLightVersion:c.proxy(this.onUseLightVersion,this),isHtml5FallbackAvailable:this.options.isHtml5FallbackAvailable})},_initialiseDetectUpgradeWidget:function(){this.detectUpgradeWidget=new CTXS.Widgets.ProtocolHandlerDetectUpgradeWidget(this.$detectUpgradeView,
{onRetryDetection:c.proxy(this.onRetryDetection,this),onUpgradeLater:c.proxy(this.onUpgradeLater,this),onContinue:c.proxy(this.onDetectUpgradeContinue,this)})},_initialiseNoUpgradesWidget:function(){this.noUpgradesWidget=new CTXS.Widgets.ProtocolHandlerNoUpgradesWidget(this.$noUpgradesView,{onContinue:c.proxy(this.options.onComplete,this)})},onUpgradeLater:function(){this.cancelPolling();CTXS.setCookie(CTXS.ClientDetection.COOKIE_HAS_UPGRADE_BEEN_SHOWN,"true");this.options.onComplete()},onDetect:function(){this.detectWidget.showUI();
this.getClientDetectionTicket()},onCheckForUpgrade:function(){this.detectUpgradeWidget.showUI();this.getClientDetectionTicket()},onDetectUpgradeContinue:function(){this.cancelPolling();CTXS.removeCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE);this._clearDetectionCookies();this.onCheckComplete(!0)},onCheckComplete:function(b){this.upgradeNeeded?this.upgradeAvailableWidget.showUI(b):this.noUpgradesWidget.showUI()},onRetryDetection:function(){this.pollCancelled?this.getClientDetectionTicket():
this.invokeProtocolHandler()},onUseLightVersion:function(){this.cancelPolling();this._clearDetectionCookies();CTXS.setCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE,"true",!0);this._onComplete()},onAlreadyInstalled:function(){this.cancelPolling();this._clearDetectionCookies();CTXS.ClientManager.setNativeClientPreferred();CTXS.setCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE,"true",!0);this._onComplete()},onDownload:function(){this.cancelPolling();this.triggerDownload();this.options.isProtocolHandlerEnabled?
(this.downloadWidget.showUI(),this.isUpgradeFlow=!1):this._onComplete()},onCancelDetection:function(){this.cancelPolling();this.options.isProtocolHandlerEnabled?this.welcomeWidget.showUI():this._onComplete()},onInstallComplete:function(){this.validateWidget.showUI();this.getClientDetectionTicket()},triggerDownload:function(){location.href=this.options.clientInstallUrl},getClientDetectionTicket:function(){var b=this;this.pollCancelled=!1;CTXS.WebApiClient.getClientDetectionTicket(this.options.getDetectionTicketUrl,
function(a,c,e){b.postbackUrl=a.postbackUrl;b.ticket=a.clientDetectionTicket;b.staTicket=a.clientDetectionStaTicket;b.serverProtocolVersion=a.serverProtocolVersion;b.invokeProtocolHandler();b.pollForClientProperties()},function(a,c,e){CTXS.trace("failure calling GetDetectionTicket");b._onComplete()})},invokeProtocolHandler:function(){var b=0==this.postbackUrl.indexOf("https")?"https":"http",a=this.postbackUrl.replace(/^https?:/,"receiver:"),d="";this.staTicket&&(d="&staTicket={0}".format(encodeURIComponent(this.staTicket)));
b="action=detect&serverProtocolVersion={0}&transport={1}&ticket={2}{3}".format(encodeURIComponent(this.serverProtocolVersion),encodeURIComponent(b),encodeURIComponent(this.ticket),d);a=a+"/"+CTXS.urlSafeBase64Encode(b);CTXS.trace("Protocol handler parameter block: "+b);CTXS.trace("Invoking protocol handler with url: "+a);c("#protocolhandler-invoker").attr("href",a);document.getElementById("protocolhandler-invoker").click()},pollCancelled:!1,pollForClientProperties:function(){var b=this,a=CTXS.protocolHandlerPollInterval;
this.pollCancelled||(this.pollTimer=setTimeout(function(){CTXS.WebApiClient.getClientDetectionStatus(b.options.getDetectionStatusUrl,b.ticket,function(a,c,k){c="Receiver detected, Version={0}, Passthrough={1}, Passthrough Variable={2}".format(a.hdxVersion,a.hdxIsPassThrough,a.hdxIsPassThroughVariable);CTXS.trace(c);if(a.status==CTXS.WebApiClient.DETECTION_STATUS_WAITING)b.pollForClientProperties();else if(a.status==CTXS.WebApiClient.DETECTION_STATUS_SUCCESS)if(b.cancelPolling(),c="True"==a.hdxIsPassThrough||
"True"==a.hdxIsPassThroughVariable,CTXS.setCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE,"true",!0),CTXS.setCookie(CTXS.ClientDetection.COOKIE_IS_PASSTHROUGH,c?"true":"false",!0),CTXS.setCookie(CTXS.ClientDetection.COOKIE_CLIENT_VERSION,a.hdxVersion,!0),b.upgradeNeeded=CTXS.ClientManager.isNativeClientUpgradeable(b.options.serverVersion),b.upgradeNeeded||b.isUpgradeFlow)b.onCheckComplete(!1);else b._onComplete();else b.cancelPolling()},function(a,c,k){CTXS.trace("failure polling for detection status");
b._clearDetectionCookies();b._onComplete()})},a))},cancelPolling:function(){this.pollCancelled=!0;this.pollTimer&&clearTimeout(this.pollTimer)},_onComplete:function(){CTXS.setCookie(CTXS.ClientDetection.COOKIE_CLIENT_DETECTION_DONE,"true",!0);CTXS.setCookie(CTXS.ClientDetection.COOKIE_HAS_UPGRADE_BEEN_SHOWN,"true");this.options.onComplete()},_clearDetectionCookies:function(){CTXS.removeCookie(CTXS.ClientDetection.COOKIE_IS_PASSTHROUGH);CTXS.removeCookie(CTXS.ClientDetection.COOKIE_CLIENT_VERSION);
CTXS.removeCookie(CTXS.ClientManager.COOKIE_CLIENT_ALREADY_INSTALLED);CTXS.removeCookie(CTXS.ClientManager.COOKIE_USER_PREFERRED_CLIENT)}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={onRetryDetection:function(){},onUpgradeLater:function(){},onContinue:function(){}};CTXS.Widgets.ProtocolHandlerDetectUpgradeWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$continueButton=this.$view.find(".installbutton");this.$upgradeLaterLink=this.$view.find(".detectupgrade-upgrade-later");this.$upgradeLaterLink.attr("title",c.localization.string("UpgradeLaterTip"));this.$detectAgainLink=this.$view.find(".detectupgrade-detect-again");
this.$continueMessage=this.$view.find(".detectupgrade-continue-message");this.$windowAppearsMessage=this.$view.find(".windowAppearsMessage");CTXS.Device.isChrome()?(this.$windowAppearsMessage.html(c.localization.string("WhenWindowAppearsLaunchApplicationChrome")),this.$continueMessage.html(c.localization.string("IfNoWindowDetectAgain",CTXS.localizeAndBoldDetailText("Continue")))):CTXS.Device.isFirefox()&&(this.$windowAppearsMessage.html(c.localization.string("WhenWindowAppearsLaunchApplicationFireFox",
CTXS.localizeAndBoldDetailText("CitrixReceiverlauncher"),CTXS.localizeAndBoldDetailText("OpenLink"))),this.$continueMessage.html(c.localization.string("IfNoWindowDetectAgainUpgradeFirefox",CTXS.localizeAndBoldDetailText("CitrixReceiverlauncher"),CTXS.localizeAndBoldDetailText("Continue"))));this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerDetectUpgradeWidget.prototype={showUI:function(){this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$continueButton.click(function(a){a.preventDefault();
b.options.onContinue()});this.$upgradeLaterLink.click(function(a){a.preventDefault();b.options.onUpgradeLater()});this.$detectAgainLink.click(function(a){a.preventDefault();b.options.onRetryDetection()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={isProtocolHandlerEnabled:!1,isHtml5FallbackAvailable:!1,isReceiverDownloadAllowed:!1,clientInstallUrl:"",onRetryDetection:function(){},onDownload:function(){},onUseLightVersion:function(){},onAlreadyInstalled:function(){}};CTXS.Widgets.ProtocolHandlerDetectWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$element=b.find(".detect-container");this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerDetectWidget.prototype=
{showUI:function(){this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$installButton=this.$element.find(".installbutton");this.$installButton.attr("href",this.options.clientInstallUrl);this.$redetectLink=this.$element.find(".detect-retry-detection");this.$redetectLinkSeparator=this.$element.find(".detect-retry-detection-separator");this.$useLightLink=this.$element.find(".detect-use-light-version");this.$useLightLinkSeparator=this.$element.find(".detect-use-light-version-separator");
this.$alreadyInstalledLink=this.$element.find(".detect-already-installed");this.$alreadyInstalledLinkSeparator=this.$element.find(".detect-already-installed-separator");this.$chkLegalStatement=this.$element.find(".legalstatement-checkbox");this.$acceptTermsMessage=this.$element.find(".acceptterms-popup");this.$securityDetails=this.$element.find(".securitydetails-popup");this.$licenseAgreement=this.$element.find(".licenseagreement-popup");this.$licenseLink=this.$element.find(".licenseagreement-link");
this.$securityDetailsLink=this.$element.find(".securitydetailslink");this.$pluginassistantDetails=this.$element.find(".pluginassistant-details");this.$headingText=this.$element.find(".detect-heading");this.$ifAlreadyInstalledMessage=this.$element.find(".detect-if-already-installed");this.$noPromptMessage=this.$element.find(".detect-no-prompt");this.$securityDetailsLink.ctxsAddCustomTooltip(this.$securityDetails,this.$element);this.$licenseLink.ctxsAddCustomTooltip(this.$licenseAgreement,this.$element);
this.$installButton.ctxsAddCustomTooltipForButton(this.$acceptTermsMessage,this.$element);var a,d;CTXS.Device.isSpartan()?(a=c.localization.string("IfAlreadyInstalled",CTXS.localizeAndBoldDetailText("OK")),d=c.localization.string("NoWindowDownload")):CTXS.Device.isChrome()?(a=c.localization.string("IfAlreadyInstalled",CTXS.localizeAndBoldDetailText("LaunchApplication")),d=c.localization.string("NoWindowDownload")):CTXS.Device.isFirefox()&&(a=c.localization.string("IfAlreadyInstalledFirefox",CTXS.localizeAndBoldDetailText("CitrixReceiverlauncher"),
CTXS.localizeAndBoldDetailText("OpenLink")),d=c.localization.string("NoWindowDownloadFirefox",CTXS.localizeAndBoldDetailText("CitrixReceiverlauncher"),CTXS.localizeAndBoldDetailText("Cancel"),CTXS.localizeAndBoldDetailText("Download")));this.$ifAlreadyInstalledMessage.html(a);this.$headingText.text(c.localization.string("JustAMomentDetecting"));this.$noPromptMessage.html(d);this.options.isProtocolHandlerEnabled?this.options.isReceiverDownloadAllowed||(this.$pluginassistantDetails.hide(),this.$installButton.hide(),
this.$redetectLink.hide(),this.$redetectLinkSeparator.hide(),this.$securityDetailsLink.hide(),this.$alreadyInstalledLinkSeparator.hide(),this.options.isHtml5FallbackAvailable?this.$noPromptMessage.text(c.localization.string("IfNoWindowOptions")):(a='<span class="detail-text-highlight">{0}</span>'.format(c.localization.string("AlreadyInstalled")),this.$noPromptMessage.html(c.localization.string("IfNoWindowAlreadyInstalled",a)))):(this.$redetectLink.hide(),this.$redetectLinkSeparator.hide(),this.$ifAlreadyInstalledMessage.hide(),
this.$noPromptMessage.hide(),this.$headingText.text(c.localization.string("AcceptTermsMessage")));this.options.isHtml5FallbackAvailable||(this.$useLightLink.hide(),this.$useLightLinkSeparator.hide());this.$installButton.click(function(a){a.preventDefault();if(!c(this).hasClass("disabled"))b.options.onDownload()});this.$redetectLink.click(function(a){a.preventDefault();b.options.onRetryDetection()});this.$useLightLink.click(function(a){a.preventDefault();b.options.onUseLightVersion()});this.$alreadyInstalledLink.click(function(a){a.preventDefault();
b.options.onAlreadyInstalled()});this.$chkLegalStatement.change(function(){if(this.checked)b.onTermsAcceptance();else b.onTermsRejection()})},onTermsAcceptance:function(){this.$acceptTermsMessage.hide();this.$installButton.attr("href",this.options.pluginInstallUrl);this.$installButton.removeClass("disabled")},onTermsRejection:function(){this.$installButton.attr("href","#");this.$installButton.addClass("disabled")}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={clientInstallUrl:"",isHtml5FallbackAvailable:!1,onInstallComplete:function(){},onUseLightVersion:function(){}};CTXS.Widgets.ProtocolHandlerDownloadWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$element=b.find(".download-container");this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerDownloadWidget.prototype={showUI:function(){this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$completeLink=
this.$element.find(".download-complete");this.$retryLink=this.$element.find(".download-retry");this.$retryLink.attr("href",this.options.clientInstallUrl);this.$retryLinkSeparator=this.$element.find(".download-retry-separator");this.$useLightVersionLink=this.$element.find(".download-use-light-version");this.$installMessage=this.$element.find(".download-install-receiver");var a='<span class="detail-text-highlight">{0}</span>'.format(c.localization.string("Continue"));this.$installMessage.html(c.localization.string("InstallWhenDownloadComplete",
a));this.options.isHtml5FallbackAvailable||(this.$useLightVersionLink.hide(),this.$retryLinkSeparator.hide());this.$completeLink.click(function(a){a.preventDefault();b.options.onInstallComplete()});this.$useLightVersionLink.click(function(a){a.preventDefault();b.options.onUseLightVersion()});this.boundEvents=!0}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={onContinue:function(){}};CTXS.Widgets.ProtocolHandlerNoUpgradesWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$continueButton=this.$view.find(".installbutton");this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerNoUpgradesWidget.prototype={showUI:function(){this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$continueButton.click(function(a){a.preventDefault();b.options.onContinue()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={onDownload:function(){},onUpgradeLater:function(){},onAlreadyInstalled:function(){},onUseLightVersion:function(){},isHtml5FallbackAvailable:!1};CTXS.Widgets.ProtocolHandlerUpgradeAvailableWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$installButton=this.$view.find(".installbutton");this.$upgradeLaterLink=this.$view.find(".upgradeavailable-upgrade-later");this.$upgradeLaterLink.attr("title",c.localization.string("UpgradeLaterTip"));
this.$chkLegalStatement=this.$view.find(".legalstatement-checkbox");this.$acceptTermsMessage=this.$view.find(".acceptterms-popup");this.$securityDetails=this.$view.find(".securitydetails-popup");this.$licenseAgreement=this.$view.find(".licenseagreement-popup");this.$licenseLink=this.$view.find(".licenseagreement-link");this.$securityDetailsLink=this.$view.find(".securitydetailslink");this.$alreadyInstalledLink=this.$view.find(".upgradeavailable-already-installed");this.$alreadyInstalledSeparator=
this.$view.find(".upgradeavailable-already-installed-separator");this.$useLightVersionLink=this.$view.find(".upgradeavailable-use-light-version");this.$mainText=this.$view.find(".main-text");this.$securityDetailsLink.ctxsAddCustomTooltip(this.$securityDetails,this.$view);this.$licenseLink.ctxsAddCustomTooltip(this.$licenseAgreement,this.$view);this.$installButton.ctxsAddCustomTooltipForButton(this.$acceptTermsMessage,this.$view);this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerUpgradeAvailableWidget.prototype=
{showUI:function(b){b?(this.$mainText.html(c.localization.string("CannotDetectReceiverInstallAvailable")),this.$upgradeLaterLink.hide(),this.$alreadyInstalledLink.show(),this.options.isHtml5FallbackAvailable?(this.$useLightVersionLink.show(),this.$alreadyInstalledSeparator.show()):(this.$useLightVersionLink.hide(),this.$alreadyInstalledSeparator.hide())):(this.$mainText.html(c.localization.string("ProtocolHandlerUpgradeAvailable")),this.$upgradeLaterLink.show(),this.$useLightVersionLink.hide(),this.$alreadyInstalledLink.hide(),
this.$alreadyInstalledSeparator.hide());this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=this;this.$installButton.click(function(a){a.preventDefault();if(!c(this).hasClass("disabled"))b.options.onDownload()});this.$upgradeLaterLink.click(function(a){a.preventDefault();b.options.onUpgradeLater()});this.$useLightVersionLink.click(function(a){a.preventDefault();b.options.onUseLightVersion()});this.$chkLegalStatement.change(function(){if(this.checked)b.onTermsAcceptance();else b.onTermsRejection()});
this.$alreadyInstalledLink.click(function(a){a.preventDefault();b.options.onAlreadyInstalled()})},onTermsAcceptance:function(){this.$acceptTermsMessage.hide();this.$installButton.removeClass("disabled")},onTermsRejection:function(){this.$installButton.addClass("disabled")}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={isHtml5FallbackAvailable:!1,onRetryDetection:function(){},onRetryDownload:function(){},onUseLightVersion:function(){},onAlreadyInstalled:function(){}};CTXS.Widgets.ProtocolHandlerValidateWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$element=b.find(".validate-container");this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerValidateWidget.prototype={showUI:function(){this.$view.ctxsDisplayPane()},_bindToUIEvents:function(){var b=
this;this.$redetectLink=this.$element.find(".validate-retry-detection");this.$redownloadLink=this.$element.find(".validate-retry-download");this.$useLightLink=this.$element.find(".validate-use-light-version");this.$useLightLinkSeparator=this.$element.find(".validate-use-light-version-separator");this.$alreadyInstalledLink=this.$element.find(".validate-already-installed");this.$alreadyInstalledLinkSeparator=this.$element.find(".validate-already-installed-separator");this.$ifWasInstalledMessage=this.$element.find(".validate-was-installed");
this.$noPromptMessage=this.$element.find(".validate-no-window");var a,d;CTXS.Device.isSpartan()?(a=c.localization.string("IfWasInstalled",CTXS.localizeAndBoldDetailText("OK")),d=c.localization.string("IfNoWindowDetectAgain",CTXS.localizeAndBoldDetailText("DetectAgain"))):CTXS.Device.isChrome()?(a=c.localization.string("IfWasInstalled",CTXS.localizeAndBoldDetailText("LaunchApplication")),d=c.localization.string("IfNoWindowDetectAgain",CTXS.localizeAndBoldDetailText("DetectAgain"))):CTXS.Device.isFirefox()&&
(a=c.localization.string("IfAlreadyInstalledFirefox",CTXS.localizeAndBoldDetailText("CitrixReceiverlauncher"),CTXS.localizeAndBoldDetailText("OpenLink")),d=c.localization.string("IfNoWindowDetectAgainFirefox",CTXS.localizeAndBoldDetailText("CitrixReceiverlauncher"),CTXS.localizeAndBoldDetailText("Cancel"),CTXS.localizeAndBoldDetailText("DetectAgain")));this.$ifWasInstalledMessage.html(a);this.$noPromptMessage.html(d);this.options.isHtml5FallbackAvailable||(this.$useLightLink.hide(),this.$useLightLinkSeparator.hide());
this.$redetectLink.click(function(a){a.preventDefault();b.options.onRetryDetection()});this.$redownloadLink.click(function(a){a.preventDefault();b.options.onRetryDownload()});this.$useLightLink.click(function(a){a.preventDefault();b.options.onUseLightVersion()});this.$alreadyInstalledLink.click(function(a){a.preventDefault();b.options.onAlreadyInstalled()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};var f={isHtml5FallbackAvailable:!1,onDetect:function(){},onUseLightVersion:function(){}};CTXS.Widgets.ProtocolHandlerWelcomeWidget=function(b,a){this.options=c.extend(f,a);this.$view=b;this.$element=b.find(".welcome-container");this.$installButton=this.$element.find(".welcome-use-native-client");this.$fullExperienceMessage=this.$element.find(".welcome-for-full-experience");this.$footer=this.$element.find(".footer");if(this.options.isHtml5FallbackAvailable){var d;
d=CTXS.Device.isWindowsPlatform()?"ReceiverForWindows":CTXS.Device.isChromeOS()?"ReceiverForAndroid":CTXS.Device.isLinux()?"ReceiverForLinux":"ReceiverForMac";d=c.localization.string(d);d='<span class="detail-text-highlight">{0}</span>'.format(d);this.$fullExperienceMessage.html(c.localization.string("ForFullExperience",d))}else this.$fullExperienceMessage.text(c.localization.string("UseReceiver")),this.$footer.hide();this._bindToUIEvents()};CTXS.Widgets.ProtocolHandlerWelcomeWidget.prototype={showUI:function(){this.$view.ctxsDisplayPane()},
_bindToUIEvents:function(){var b=this;this.useNativeLink=this.$element.find(".welcome-use-native-client");this.$useLightLink=this.$element.find(".welcome-use-light-link");this.useNativeLink.click(function(a){a.preventDefault();b.options.onDetect()});this.$useLightLink.click(function(a){a.preventDefault();b.options.onUseLightVersion()})}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.MessageWidget=function(c,b){this.$messageBox=c;this.$overlay=b;this.$messageBoxTitle=this.$messageBox.find(".messageBoxTitle");this.$messageBoxText=this.$messageBox.find(".messageBoxText");this.$messageBoxButton=this.$messageBox.find(".messageBoxAction .button");this.$messageBoxCancelContainer=this.$messageBox.find(".messageBoxCancelAction");this.$messageBoxCancelButton=this.$messageBoxCancelContainer.find(".button");
this._bindToUIEvents()};CTXS.Widgets.MessageWidget.prototype={show:function(f){var b=this,a=c.extend({messageType:CTXS.MESSAGE_TYPE.ALERT,messageTitle:null,messageText:"",buttonLabel:c.localization.string("OK"),cancelButtonLabel:c.localization.string("Cancel"),buttonAction:null,cancelButtonAction:null},f);this.$messageBox.toggleClass("alert",a.messageType==CTXS.MESSAGE_TYPE.ALERT);this.$messageBox.toggleClass("workflow-approved",a.messageType==CTXS.MESSAGE_TYPE.WORKFLOW_APPROVED);this.$messageBoxText.empty();
this.$messageBoxTitle.empty();this.$messageBoxButton.off();this.$messageBoxCancelButton.off();null!=a.messageTitle?this.$messageBoxTitle.html(a.messageTitle).show():this.$messageBoxTitle.hide();this.$messageBoxText.html(a.messageText);this.$messageBoxButton.addClass("default").text(a.buttonLabel).one("click",function(c){c.preventDefault();b.hide();a.buttonAction&&a.buttonAction()});a.cancelButtonAction?(this.$messageBoxCancelContainer.show(),this.$messageBoxCancelButton.text(a.cancelButtonLabel).one("click",
function(c){c.preventDefault();b.hide();a.cancelButtonAction()})):this.$messageBoxCancelContainer.hide();this.$messageBox.ctxsCenter();CTXS.displayPopup(this.$overlay,this.$messageBox)},hide:function(){CTXS.fadePopup(this.$overlay,this.$messageBox)},updateMessageText:function(c){this.$messageBoxText.html(c)},_bindToUIEvents:function(){var f=this;f.$overlay.click(function(b){b.preventDefault()});f.$messageBox.on("keyup",function(b){b.keyCode===c.ui.keyCode.ESCAPE&&CTXS.isPopupVisible(f.$messageBox)&&
(f.$messageBoxCancelContainer.is(":visible")&&f.$messageBoxCancelButton.click(),f.hide())})}}})(jQuery);
(function(c){var f="placeholder"in document.createElement("input"),b={onTextEnter:function(a){},onTextClear:function(){},phonePane:".pullout-search-container",desktopPane:".header-search-container",overlay:".search-overlay",phoneCancelButton:".searchHideButton"};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.SearchBoxWidget=function(a,d){this.options=c.extend({},b,d);this.$searchContainer=a;this.$searchInput=a.find(".searchInput");this.$pseudoInput=null;this.$searchClearButton=
a.find(".searchClearButton");this.searchBoxChangeEvent="oninput"in this.$searchInput.get(0)?"input":"keyup";if(this.requiresPseudoPlaceholder=CTXS.Device.isIE()||!f){var e=CTXS.UI.useSmallUILayout()?this.$searchInput.filter(".phone-only"):this.$searchInput.not(".phone-only");this._convertToPseudoInput(e)}this.placeholderText=c.localization.string("SearchPlaceholder");this.$overlay=c(this.options.overlay);this._bindToUIEvents();this._bindToAppEvents();this.activate()};CTXS.Widgets.SearchBoxWidget.prototype=
{activate:function(){this.$searchInput.prop("disabled",!1);this.$searchContainer.addClass("active")},deactivate:function(){this.$searchInput.prop("disabled",!0);this.$searchContainer.removeClass("active")},clear:function(){this.$searchInput.val("")},focus:function(){(CTXS.UI.useSmallUILayout()?this.$searchInput.filter(".phone-only"):this.$searchInput.not(".phone-only")).focus()},hide:function(){CTXS.UI.useSmallUILayout()?c(this.options.phonePane).addClass("hide-search"):c(this.options.desktopPane).addClass("hidden");
this.deactivate()},show:function(){this.activate();CTXS.UI.useSmallUILayout()?c(this.options.phonePane).removeClass("hide-search"):c(this.options.desktopPane).removeClass("hidden")},cancelSearch:function(){this.clear();this._processSearchText(this.$searchInput.val());var a=CTXS.UI.useSmallUILayout()?this.$searchInput.filter(".phone-only"):this.$searchInput.not(".phone-only");this._applyPseudoPlaceholder(a);this.resizeSearchBox(this.spaceWidth);a.focus()},getText:function(){return this.$searchInput.filter(":visible").val()},
setText:function(a){this.$searchInput.val(a);CTXS.UI.useSmallUILayout()?this._applyPseudoPlaceholder(this.$searchInput.filter(".phone-only")):this._applyPseudoPlaceholder(this.$searchInput.not(".phone-only"));this._processSearchText(this.$searchInput.val())},setPlaceholderText:function(a){this.placeholderText=a;a=this._resizePlaceholderTextToFit(a);this.$searchInput.attr("title",a);this.$searchInput.attr("aria-label",a);this.$pseudoInput?this._setPseudoPlaceholderText(a):this.$searchInput.attr("placeholder",
a)},showSearchBox:function(a){this.$searchInput.show();this.resizeSearchBox(a)},hideSearchBox:function(){this.cancelSearch()},isSearching:function(){return c("body").hasClass("search-view")},_resizePlaceholderTextToFit:function(a){var b=this.$searchInput.width()-5,c=CTXS.UI.useSmallUILayout()?".search-ruler-container.phone-only":".search-ruler-container:not(.phone-only)",c=this.$searchContainer.find(c);return CTXS.truncateToFit(c,a,b,1,!1)},resizeSearchBox:function(a){if(!this.$searchContainer.not(".phone-only").is(":hidden")){var b=
parseInt(this.$searchInput.css("margin-left"),10),c=parseInt(this.$searchInput.css("margin-right"),10),b=a-b-c;this.spaceWidth=a;this.$searchInput.width(b+"px");this.$searchContainer.width(a+"px");this.requiresPseudoPlaceholder&&this.$pseudoInput.width(b+"px")}},_bindToAppEvents:function(){var a=this;CTXS.Events.subscribe(CTXS.Events.ui.showSearchView,function(){a._onSearchBoxChange()})},_bindToUIEvents:function(){var a=this;a._bindToSearchBoxChangeEvent();a.$searchInput.on("compositionstart",function(){CTXS.Device.isMobileDevice()&&
a._unbindFromSearchBoxChangeEvent()});a.$searchInput.on("compositionend",function(){CTXS.Device.isMobileDevice()&&a._bindToSearchBoxChangeEvent()});a.$searchClearButton.on("click",function(b){b.preventDefault();a.cancelSearch()});a.$searchInput.on("search",function(b){a._processSearchText(this.value);this.blur()});a.$searchInput.on("keypress",function(b){13===b.keyCode&&(a._processSearchText(this.value),this.blur())});if(CTXS.UI.useSmallUILayout())c(a.options.phoneCancelButton).on("click",function(b){b.preventDefault();
a.cancelSearch()})},_bindToSearchBoxChangeEvent:function(){var a=this;a.$searchInput.on(a.searchBoxChangeEvent,function(){a._onSearchBoxChange()})},_onSearchBoxChange:function(){var a=CTXS.UI.useSmallUILayout()?this.$searchInput.filter(".phone-only"):this.$searchInput.not(".phone-only");this._applyPseudoPlaceholder(a);this._processSearchText(a.val())},_unbindFromSearchBoxChangeEvent:function(){this.$searchInput.off(this.searchBoxChangeEvent)},_processSearchText:function(a){0<a.length?(CTXS.trace("Search for:"+
a),CTXS.UI.useSmallUILayout()&&this.$overlay.hide(),this.$searchContainer.addClass("with-text"),this.resizeSearchBox(this.spaceWidth),CTXS.StoreViewManager.setCurrentScroll(),this.options.onTextEnter(a)):(CTXS.trace("Clear Search"),CTXS.UI.useSmallUILayout()&&this.$overlay.show(),this.$searchContainer.removeClass("with-text"),this.resizeSearchBox(this.spaceWidth),this.options.onTextClear(),this.$searchInput.filter(":visible").focus())},_convertToPseudoInput:function(a){var b=a.attr("placeholder");
if(b){var c=a.attr("id")+"-placeholder",k='<div class="pseudo-input '+(a.attr("class")||"")+'"></div>';a.wrap(k);a.after('<span id="'+c+'" class="pseudo-input">'+b+"</span>");a.attr("title",b);a.attr("placeholder","");this.$pseudoInput=a.parent().find("#"+c);this.$pseudoInput.on("click",function(b){this.blur();a.focus()});this._applyPseudoPlaceholder(a)}},_setPseudoPlaceholderText:function(a){this.$pseudoInput.text(a)},_applyPseudoPlaceholder:function(a){null!==this.$pseudoInput&&(a.val()?this.$pseudoInput.removeClass("show"):
this.$pseudoInput.addClass("show"))}}})(jQuery);
(function(c){var f={pullOutButton:"",pushBackButton:"",animationTime:500,animationStyle:"swing",searchInput:"",horizontalSpacingReferenceElement:"",referenceOnLeft:!0,rulerElement:"",bufferGap:5,onSearchShow:c.noop,onSearchHide:c.noop};CTXS.Widgets.SearchHeaderWidget=function(b,a){this.options=c.extend({},f,a);this.$searchContainer=b;this.$searchInput=b.find(this.options.searchInput);this.$referenceElement=c(this.options.horizontalSpacingReferenceElement);this._updateBoxWidth();this._bindToUIEvents();
this.animating=!1};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.SearchHeaderWidget.prototype={_clearStyling:function(b){b.removeAttr("style")},_getMinimumWidth:function(){return parseInt(this.$searchContainer.find(this.options.rulerElement).css("min-width"),10)},_getMaxiumWidth:function(){return parseInt(this.$searchContainer.find(this.options.rulerElement).css("max-width"),10)},_getHorizontalAvailableSpace:function(){var b=0<this.$referenceElement.children(":visible").length,
a=this.$searchContainer.is(":visible"),d=b?this.$referenceElement.children(":visible:last"):this.$referenceElement,b=a?this.$searchContainer:c(this.options.pullOutButton),a=d.outerWidth(),d=d.offset().left,e=b.outerWidth(),b=b.offset().left+(e-this.options.bufferGap);return this.options.referenceOnLeft?b-(a+d):d-b},_calculateWidth:function(){var b=this._getMinimumWidth(),a=this._getMaxiumWidth(),c=this._getHorizontalAvailableSpace();return c>=a?a:c<=b?b:c},_updateBoxWidth:function(){this.boxWidth=
this._calculateWidth()},_preAnimationCleanUp:function(){this.animating=!0},_postAnimationCleanUp:function(){this.animating=!1},_pullOutSearchBox:function(b){var a=this;this._preAnimationCleanUp();this._updateBoxWidth();this.$searchContainer.removeClass("hidden");c(a.options.pushBackButton).removeClass("hidden");CTXS.Device.getPlatform()===CTXS.Device.Platform.IOS&&(b.prop("disabled",!1),b.show().focus());c(this.options.pullOutButton).velocity({opacity:"0"},{duration:this.options.animationTime,easing:this.options.animationStyle,
complete:function(){c(a.options.pullOutButton).addClass("hidden")}});this.$searchContainer.velocity({width:this.boxWidth+"px"},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){a.$searchInput.show();b.prop("disabled",!1);b.focus();a.options.onSearchShow(a.boxWidth)}});CTXS.isHighContrastEnabled()?this._postAnimationCleanUp():c(this.options.pushBackButton).velocity({opacity:"1"},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){a._postAnimationCleanUp()}})},
_pushBackSearchBox:function(){var b=this;this.$searchInput.hide().prop("disabled",!0);this.options.onSearchHide();this._preAnimationCleanUp();c(this.options.pullOutButton).removeClass("hidden");c(this.options.pullOutButton).velocity({opacity:"1"},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){b._postAnimationCleanUp()}});this.$searchContainer.velocity({width:"0"},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){b.$searchContainer.addClass("hidden")}});
c(this.options.pushBackButton).velocity({opacity:"0"},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){c(b.options.pushBackButton).addClass("hidden");b._clearStyling(c(b.options.pushBackButton))}})},_bindToUIEvents:function(){var b=this;c(b.options.pullOutButton).on("click",function(a){a.preventDefault();b.animating||b._pullOutSearchBox(b.$searchInput.eq(0))});c(b.options.pushBackButton).on("click",function(a){a.preventDefault();b.animating||(b.animating=
!0,b._pushBackSearchBox())})}}})(jQuery);
(function(c){var f={contextualWindows:["myHome","myApps","desktops"]};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.SearchPaneController=function(b,a,d,e){var k=this;this.options=c.extend({},f,e);this.store=d;this.$searchContainerObject=a;this.searchBoxWidget=b;CTXS.UI.useSmallUILayout()?this.animationWidget=new CTXS.Widgets.SlidingSearchWidget(c(".pullout-search-container"),c(".search-overlay"),{pullOutButton:"#searchBtnPhone",pushBackButton:".searchHideButton",
searchInput:".searchInput",onSearchActive:function(){CTXS.Events.publish(CTXS.Events.ui.slidingSearchActive)},onSearchCancel:function(){CTXS.Events.publish(CTXS.Events.ui.slidingSearchCancelled)}}):this.animationWidget=new CTXS.Widgets.SearchHeaderWidget(c(".header-search-container .search-container"),{animationTime:250,pullOutButton:"#searchBtn",pushBackButton:"#searchHeaderHideBtn",searchInput:".searchInput",rulerElement:".search-ruler-container",horizontalSpacingReferenceElement:".tablet-only.view-buttons",
onSearchShow:function(a){k._onShowSearch(a)},onSearchHide:function(){k.searchBoxWidget.hideSearchBox()}});this._bindToAppEvents()};CTXS.Controllers.SearchPaneController.prototype={isSearchOngoing:function(){return this.searchBoxWidget.isSearching()},_isContextualSearch:function(){return!1},_onShowSearch:function(b){this.searchBoxWidget.showSearchBox(b);this._setPlaceholderText()},_resizeSearchBox:function(b){this.searchBoxWidget.resizeSearchBox(b);this._setPlaceholderText()},_traceResults:function(b,
a){var d=b;a=c.extend([],a);d+=" "+a.length+" results: ";c.each(a,function(a,b){d+="{ "+a+": "+b.encodedName+"}, "});CTXS.trace(d)},doSearch:function(b){return this._isContextualSearch()?this._doContextualSearch(b):this._doUniversalSearch(b)},_doContextualSearch:function(b){var a=[];switch(this._getCurrentView()){case "myHome":this.searchType="myHome";a=this.store.searchForMyApps(b);break;case "myApps":this.searchType="myApps";a=this.store.searchForMyApps(b);break;case "desktops":this.searchType=
"desktops";a=this.store.searchForDesktops(b);break;default:this.searchType="store",a=this.store.searchForApps(b)}return 0===a.length?[]:[{groupType:"all",apps:a}]},_doUniversalSearch:function(b){var a=[],c=this.store.searchForMyApps(b);0<c.length&&a.push({groupType:"favourites",apps:c});this._traceResults('Results for the string "'+b+'" for the Favourites:\n',c);c=this.store.searchForUnfavoritedDesktops(b);0<c.length&&a.push({groupType:"unfavouritedDesktops",apps:c});this._traceResults('Results for the string "'+
b+'" for the Desktops:\n',c);c=this.store.searchForUnfavoritedApps(b);0<c.length&&a.push({groupType:"unfavouritedApps",apps:c});this._traceResults('Results for the string "'+b+'" for Apps:\n',c);return a},clearWidgets:function(){this.searchBoxWidget.clear()},resize:function(){this._setPlaceholderText();if(!CTXS.UI.useSmallUILayout()){var b=this.animationWidget._calculateWidth();this._resizeSearchBox(b)}},_bindToAppEvents:function(){var b=this;CTXS.Events.subscribe(CTXS.Events.ui.showMyHome,function(){b._regenerateView("myHome")});
CTXS.Events.subscribe(CTXS.Events.ui.showMyApps,function(){b._regenerateView("myApps")});CTXS.Events.subscribe(CTXS.Events.ui.showDesktops,function(){b._regenerateView("desktops")});CTXS.Events.subscribe(CTXS.Events.ui.showAllApps,function(){b._regenerateView("store")});CTXS.Events.subscribe(CTXS.Events.ui.showTasks,function(){b._regenerateView("tasks")});CTXS.Events.subscribe(CTXS.Events.ui.showSettings,function(){b._regenerateView("settings")});CTXS.Events.subscribe(CTXS.Events.session.terminate,
function(){b.searchBoxWidget.deactivate()})},_setPlaceholderText:function(){var b=c.localization.string("SearchPlaceholder");if(this._isContextualSearch())switch(this._getCurrentView()){case "myHome":b=c.localization.string("SearchFavoritesPlaceholder");break;case "myApps":b=c.localization.string("SearchFavoritesPlaceholder");break;case "desktops":b=c.localization.string("SearchDesktopsPlaceholder");break;default:b=c.localization.string("SearchAppsPlaceholder")}this.searchBoxWidget.setPlaceholderText(b)},
_regenerateView:function(b){CTXS.UI.useSmallUILayout()||this.searchBoxWidget.cancelSearch();this._setPlaceholderText();this._ableToSearch(b)?this.searchBoxWidget.show():this.searchBoxWidget.hide()},_ableToSearch:function(b){b=b||this._getCurrentView();return!this._isContextualSearch()||-1!==c.inArray(b,this.options.contextualWindows)},_getCurrentView:function(){var b=c("body");return b.hasClass("myhome-view")?"myHome":b.hasClass("myapps-view")?"myApps":b.hasClass("desktops-view")?"desktops":b.hasClass("store-view")?
"store":b.hasClass("tasks-view")?"tasks":b.hasClass("settings-view")?"settings":b.hasClass("search-view")||b.hasClass("appinfo-view")?this.searchType:null}}})(jQuery);
(function(c){var f={settings:[],dropDownOverlay:{},defaultDisplayName:c.localization.string("Menu"),displayName:c.localization.string("Menu"),defaultGroupOrder:["Account","Apps","General","Custom","Advanced"],showAccountSettingsAction:function(a){}},b={displayText:"",toolTip:"",id:null,onClick:c.noop,url:null,priority:!1,group:"General"};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.SettingsController=function(a,b,e){this.options=c.extend({},f,e);this.ungroupedSettings=
this.options.settings;this.groupedSettings=this.getGroupedSettings(this.options.settings);this.settingsWidget=new CTXS.Widgets.SettingsWidget(a,{groupedSettings:this.groupedSettings,ungroupedSettings:this.ungroupedSettings});this.dropDownWidget=new CTXS.Widgets.DropDownMenuWidget(b,this.options.dropDownOverlay,{menuItems:this.filterPrioritySettings(this.options.settings),menuItemClass:"theme-highlight-color"});this.updateUserDisplayName(this.options.displayName)};CTXS.Controllers.SettingsController.prototype=
{filterPrioritySettings:function(a){var b=[],e=this;b.push(this._getAccountSettingsItem());c.each(this.getUngroupedSettings(a),function(a,h){var g=c.extend({},e.settingsWidget.getDefaultSetting(),h);g.priority&&b.push(g)});return b},getGroupedSettings:function(a){var d=[],e=this,k={name:"Account",settings:[]},h={name:"Apps",settings:[]},g={name:"Advanced",settings:[]},l={name:"General",settings:[]},m=[];c.each(a,function(a,d){var f=c.extend({},b,d);switch(f.group){case "Account":k.settings.push(f);
break;case "Apps":h.settings.push(f);break;case "Advanced":g.settings.push(f);break;case "":case "General":l.settings.push(f);break;default:e._customGroupExists(m,f.group)?m=e._pushSettingToCustomGroup(m,f):m.push(e._getSettingsGroupObject(f.group,f))}});c.each(this.options.defaultGroupOrder,function(a,b){switch(b){case "Account":0<k.settings.length&&d.push(k);break;case "Apps":0<h.settings.length&&d.push(h);break;case "Advanced":0<g.settings.length&&d.push(g);break;case "General":0<l.settings.length&&
d.push(l);break;case "Custom":0<m.length&&(d=d.concat(m))}});return d},getUngroupedSettings:function(a){var b=[];if(c.isArray(a))return a;c.each(a,function(a,k){c.isArray(k)&&(b=b.concat(k))});return b},resize:function(){this.settingsWidget&&this.settingsWidget.resize()},updateUserDisplayName:function(a){a?this.dropDownWidget.updateUserDisplayName(a):this.dropDownWidget.updateUserDisplayName(this.options.defaultDisplayName)},_getSettingsGroupObject:function(a,b){return{name:a,settings:[b]}},_pushSettingToCustomGroup:function(a,
b){var e=c.map(a,function(a,c){if(a.name===b.group)return c}),e=0<e.length?e[0]:-1;-1!==e&&a[e].settings.push(b);return a},_customGroupExists:function(a,b){var e=!1;c.each(a,function(a,c){if(c.name===b)return e=!0,!1});return e},_getAccountSettingsItem:function(){var a=this;return{displayText:c.localization.string("SettingsMenuOption"),id:"ShowAccountSettingsBtn",onClick:function(b){a.options.showAccountSettingsAction(b.currentTarget)},priority:!0}}}})(jQuery);
(function(c){var f={groupedSettings:[],ungroupedSettings:[],initialViewMode:"list",menuItemIdPrefix:"settingsView"},b={displayText:"",toolTip:"",id:null,section:"",onClick:c.noop,url:null,priority:!1,icon:null};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.SettingsWidget=function(a,b){this.options=c.extend({},f,b);this.viewMode=this.options.initialViewMode;this.$viewSelector=c(".settings-view-toggle");this.initialised=!1;this.$settingsView=a;this._generateHtml();this.initialised=
!0;this._bindToUIEvents()};CTXS.Widgets.SettingsWidget.prototype={getDefaultSetting:function(){return b},toggleViewMode:function(){switch(this.viewMode){case "grid":this.viewMode="list";this.$viewSelector.removeClass("grid");break;default:this.viewMode="grid",this.$viewSelector.addClass("grid")}this._generateHtml()},_generateHtml:function(){this.$settingsView.empty();var a=this;c.each(this.options.groupedSettings,function(d,e){var k=e.name,h=e.settings;if(c.isArray(h)&&0!==h.length){var g="{0}SettingsGroup".format(k),
g=c.localization.string(g)?c.localization.string(g):k,l=c("<p/>");l.addClass("settings-group-header");l.addClass(k);l.text(g);a.$settingsView.append(l);h&&0<h.length&&c.each(h,function(d,g){var l=c.extend({},b,g);a._applyViewModeClass();"grid"===a.viewMode?a._generateCardHtml(l,a):a._generateListHtml(l,a)})}else CTXS.trace("Settings group {0} was skipped as it had no items in it".format(k))})},_applyViewModeClass:function(){this.$settingsView.toggleClass("grid","grid"===this.viewMode);this.$settingsView.toggleClass("list",
"list"===this.viewMode)},_generateSelectedHighlight:function(){return c("<div />").addClass("selectedHighlightPlaceholder").addClass(" theme-highlight-background-color")},_generateListHtml:function(a){var b=c("<a />");a.id&&b.attr("id",this.options.menuItemIdPrefix+a.id);b.addClass("settingsViewBtn theme-highlight-color");b.append(this._generateSelectedHighlight());var e=c("<div />");e.addClass("settingsViewBtn-txtContainer");var k=c("<div />"),h=a.displayText;k.addClass("settingsViewBtn-caption");
k.text(a.displayText);e.append(k);k=c("<div />");k.addClass("settingsViewBtn-tooltip");a.toolTip&&(a.toolTip instanceof Function?k.html(a.toolTip()):k.html(a.toolTip),e.append(k),b.addClass("with-tooltip"),h="{0} - {1}".format(h,a.toolTip));b.append(e);b.attr("aria-label",h);this._createAction(b,a);this.$settingsView.append(b)},_generateCardHtml:function(a){var b=c('<a class="settings-card"/>');a.id&&b.attr("id",this.options.menuItemIdPrefix+a.id);b.attr("aria-label",a.displayText);if(a.toolTip){var e;
e=a.toolTip instanceof Function?a.toolTip():a.toolTip;e=c("<div/>").html(e).text();b.attr("title",e)}e=c('<div class="icon"/>');a.icon?e.addClass(a.icon):e.addClass("embedded-defaultSetting");b.append(e);e=c('<div class="text theme-highlight-color"/>');e.text(a.displayText);b.append(e);this._createAction(b,a);this.$settingsView.append(b)},_createAction:function(a,b){b.url?a.attr("href",b.url):b.onClick!==c.noop&&(a.click(function(a){a.preventDefault();b.onClick(a)}),a.attr("href","#"))},_bindToUIEvents:function(){var a=
this;this.$viewSelector.on("click",function(b){a.toggleViewMode()})}}})(jQuery);
(function(c){var f={pullOutButton:"",pushBackButton:"",animationTime:500,animationStyle:"swing",searchInput:"",onSearchActive:function(){},onSearchCancel:function(){}};CTXS.Widgets.SlidingSearchWidget=function(b,a,d){this.options=c.extend({},f,d);this.$phonePane=b;this.$overlay=a;this.$searchInput=b.find(this.options.searchInput);this._bindToUIEvents()};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.SlidingSearchWidget.prototype={_pullOutSearchBox:function(b){var a=this;CTXS.Device.getPlatform()===
CTXS.Device.Platform.IOS&&(b.prop("disabled",!1),b.focus(),a.$phonePane.css("position","fixed"));this.$overlay.show();this.$phonePane.velocity({left:0},{duration:this.options.animationTime,easing:this.options.animationStyle,queue:!1});this.$overlay.velocity({opacity:.5},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){b.prop("disabled",!1);b.focus();a.$phonePane.css("position","absolute");a.options.onSearchActive()}})},_pushBackSearchBox:function(){var b=
this,a=b.$searchInput.eq(0);a.prop("disabled",!0);a.blur();this.$phonePane.velocity({left:"100%"},this.options.animationTime,this.options.animationStyle);this.$overlay.velocity({opacity:0},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){b.options.onSearchCancel()}});this.$overlay.hide(0)},_bindToUIEvents:function(){var b=this;c(b.options.pullOutButton).on("click",function(a){a.preventDefault();b._pullOutSearchBox(b.$searchInput.eq(0))});c(b.options.pushBackButton).on("click",
function(a){a.preventDefault();b._pushBackSearchBox()});b.$overlay.on("click",function(a){a.preventDefault();b._pushBackSearchBox()})}}})(jQuery);
(function(c){var f={slideAnimationDuration:400,slideAnimationStyle:"ease"};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.SlidingMenuWidget=function(b,a,d,e,k){this.options=c.extend({},f,k);this.$content=b;this.$menu=a;this.menuWidth=this.$menu.width();this.$clickTrigger=d;this.$contentOverlay=e;this.originalContentXPosition=this.$content.position().left;this.animating=!1;this.enabled=!0;this._bindToUIEvents()};CTXS.Widgets.SlidingMenuWidget.prototype={show:function(){if(this.enabled){var b=
this,a=this.originalContentXPosition+this.menuWidth;this.$menu.show();this.$content.velocity({left:a},{duration:this.options.slideAnimationDuration,easing:this.options.slideAnimationStyle,complete:function(){b.showing=!0;b.animating=!1}});this.$contentOverlay.show().velocity({left:a,opacity:.6},this.options.slideAnimationDuration,this.options.slideAnimationStyle)}},hide:function(){var b=this;this.$content.velocity({left:this.originalContentXPosition},{duration:this.options.slideAnimationDuration,
easing:this.options.slideAnimationStyle,complete:function(){b.$menu.hide();b.showing=!1}});this.$contentOverlay.velocity({left:this.originalContentXPosition,opacity:0},{duration:this.options.slideAnimationDuration,easing:this.options.slideAnimationStyle,complete:function(){b.$contentOverlay.hide();b.animating=!1}})},isEnabled:function(){return this.enabled},setEnabled:function(b){this.enabled=b},updateUserDisplayName:function(b){this.$menu.find(".user-display-name").text(b)},_bindToUIEvents:function(){var b=
this;this.$clickTrigger.on("click",function(a){a.preventDefault();b.animating||b.showing||(b.animating=!0,b.show())});this.$menu.add(this.$contentOverlay).on("click",function(a){a.preventDefault();!b.animating&&b.showing&&(b.animating=!0,b.hide())})}}})(jQuery);
(function(c){var f={showButton:"",pushBackButton:"",animationTime:400,animationStyle:"easeInOutCubic",underlineElement:"",onActivate:function(){},onCancel:function(){},views:["store","desktop"],registerAnimationFinish:c.noop};CTXS.Widgets.SlidingSubMenuWidget=function(b,a,d,e){this.options=c.extend({},f,e);this.$storeView=d;this.$visibilityElement=b;this.$closingElement=a;this.$slidingElement=d;this.$underlineElement=c(this.options.underlineElement);this.height=this.$visibilityElement.height();this._configureRuler(this.options.views[0],
this.$slidingElement);this.initialTop=this._getInitialTop();this.newTop=this.height+this.initialTop;this._addSlidingStyle();this._bindToUIEvents()};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.SlidingSubMenuWidget.prototype={togglePane:function(b){this.$visibilityElement.is(":visible")?this.hidePane(b):this.showPane(b)},hidePaneIfVisible:function(b){this.$visibilityElement.is(":visible")?this.hidePane(b):this.hidePaneNoAnimate(b)},showPaneIfVisible:function(){this.$visibilityElement.is(":visible")&&
this.showNoAnimate()},showNoAnimate:function(){this.$slidingElement.addClass("slide");this.$underlineElement.toggleClass("theme-highlight-border-color",!0)},hideNoAnimate:function(){this.$slidingElement.removeClass("slide");this.$underlineElement.toggleClass("theme-highlight-border-color",!1);this.$slidingElement.velocity("stop")},showPane:function(b){var a=this;this.$underlineElement.toggleClass("theme-highlight-border-color",!0);this.$slidingElement.velocity({top:"{0}px".format(this.newTop)},{duration:this.options.animationTime,
easing:this.options.animationStyle,complete:function(){a.$visibilityElement.addClass("show");a.$closingElement.addClass("show");a.$slidingElement.addClass("slide");a._resize();a._postAnimationCleanUp(b)}})},hidePane:function(b){var a=this;a.$closingElement.removeClass("show");this.$underlineElement.toggleClass("theme-highlight-border-color",!1);this.$slidingElement.velocity({top:"{0}px".format(this.initialTop)},{duration:this.options.animationTime,easing:this.options.animationStyle,complete:function(){a.$visibilityElement.removeClass("show");
a.$slidingElement.removeClass("slide");a._postAnimationCleanUp(b)}})},hidePaneNoAnimate:function(b){this.$visibilityElement.removeClass("show");this.$underlineElement.removeClass("theme-highlight-border-color");this.$slidingElement.removeClass("slide");this._postAnimationCleanUp(b)},updateSlidingStyle:function(){this.height=this.$visibilityElement.height();this.initialTop=this.$slidingElement.position().top;this.newTop=this.height+this.initialTop;this._addSlidingStyle()},_resize:function(){var b=
this.$visibilityElement.find(".appFiltersView:visible"),a=0;CTXS.isScrollable(b)&&(a=CTXS.scrollbarWidth(b,this.$visibilityElement),a=0<a?a:17);this.$closingElement.css("right",a)},_getInitialTop:function(){return this._getTopFromRuler(this.options.views[0])},_configureRuler:function(b){if("undefined"==typeof this.$ruler){var a=c("<div/>").addClass("ruler-container sub-menu");b=c("<div/>").addClass(b+"-view");c("<div/>").addClass(this.$slidingElement.attr("class")).appendTo(b);b.appendTo(a);a.appendTo(c("body"));
this.$ruler=c(a)}},_getSlidingRulerElement:function(b){this._configureRuler(b);return this.$ruler.find("."+b+"-view "+this._getSelectorStringFromClass(this.$slidingElement))},_getSelectorStringFromClass:function(b){return"."+b.attr("class").replace(/\s/g,".")},_getHeightFromRuler:function(b){b=this._getSlidingRulerElement(b);return 0===b.length?0:b.height()},_getTopFromRuler:function(b){b=this._getSlidingRulerElement(b);return 0===b.length?0:parseInt(b.css("top"),10)},_addSlidingStyle:function(){var b=
this._getSelectorStringFromClass(this.$slidingElement),a=CTXS.UI.useSmallUILayout()?CTXS.UI.useSmallTiles()?".small":".small.largeTiles":".large",d="{0} {1}.slide".format(a,b),b="{0} .appinfo-view {1}.slide".format(a,b),d="{0}, {1} { top: {2}px; }".format(d,b,this.newTop);c("<style>{0}</style>".format(d)).appendTo("head")},_clearStyling:function(){this.$slidingElement.removeAttr("style")},_postAnimationCleanUp:function(b){this._clearStyling();this.options.registerAnimationFinish();c.isFunction(b)&&
b()},_bindToUIEvents:function(){var b=this;b.$closingElement.on("click",function(a){a.preventDefault();b.options.onCancel()})}}})(jQuery);
(function(c){var f={duration:700,easing:[3],backgroundPositionShift:"-75px"};window.CTXS=window.CTXS||{};CTXS.AnimatedSpinner=function(b){this.options=c.extend({},f,b)};CTXS.AnimatedSpinner.prototype={start:function(b,a){a&&a.show();b.velocity("stop",!0);b.css("backgroundPosition","0");this._animate(b)},stop:function(b,a){b.velocity("stop",!0);a&&a.hide()},_animate:function(b){var a=this;b.velocity({backgroundPosition:this.options.backgroundPositionShift},{easing:this.options.easing,duration:this.options.duration,
complete:function(){b.css("backgroundPosition","0");a._animate(b)}})}}})(jQuery);
(function(c){function f(){ca=ea=T=null}function b(a){Y.showFolderToolbar(a)}function a(){Y.hideFolderToolbar()}function d(){var a=[],b=w.getCategoryHierarchyForApps();if(0<b.length&&CTXS.Store.isFolderViewEnabled()){var d=c.localization.string("Categories"),g=ma.find(".categoriesContainer"),l=new CTXS.Widgets.AppFiltersWidget(g,b,function(a){return a.getDisplayName()},function(a){return a.count},function(a){O(a)});a.push({name:"categories",label:d,selector:".categories",hideForDesktops:!0,widget:l,
showFilterWidget:function(){CTXS.UI.useSmallTiles()?(I(1),E()):l.show()},hideFilterWidget:function(){l.hide()}})}b=w.getApplicationBundles();if(0<b.length){var d=c.localization.string("Bundles"),g=ma.find(".bundlesContainer"),h=new CTXS.Widgets.AppFiltersWidget(g,b,function(a){return a.title},function(a){return a.apps.length},function(a){CTXS.UI.useSmallTiles()||(L.previousOption=L.activeOption);r(a)});a.push({name:"bundles",label:d,selector:".bundles",hideForDesktops:!0,widget:h,showFilterWidget:function(){CTXS.UI.useSmallTiles()?
(I(1),CTXS.ExtensionsHead.preRedraw(),t(),M.hide(),0<w.getApplicationBundles().length&&p.showCollectionList(),CTXS.ExtensionsHead.postRedraw()):h.show()},hideFilterWidget:function(){h.hide()}})}return a}function e(){var a=[];a.push({name:"allApps",label:function(){var a=0;switch(CTXS.currentView){case "store":a=w.getAllApps().length;break;case "desktops":a=w.getDesktops().length}return c.localization.string("AllAppsWithCount",a)},selector:".allApps",isDefault:!0,showFilter:function(){I(1);switch(CTXS.currentView){case "store":p.showApps(w.getAllApps());
break;case "desktops":p.showApps(w.getDesktops())}}});CTXS.Store.isSelfServiceEnabled()&&a.push({name:"myApps",label:function(){var a=0;switch(CTXS.currentView){case "store":a=w.getMyApps(!0).length;break;case "desktops":a=w.getMyApps(!1,!0).length}return c.localization.string("FavouritesWithCount",a)},selector:".myApps",showFilter:function(){T=ca=null;switch(CTXS.currentView){case "store":p.showApps(w.getMyApps(!0));I(w.getMyApps(!0).length);break;case "desktops":p.showApps(w.getMyApps(!1,!0)),I(w.getMyApps(!1,
!0).length)}}});return a}function k(a,b){R&&(R.removeClass("show"),R=null);var d=w.getAppByShortId(a);if(d.canOpen())d.ismobileapp&&!d.installed?w.installApp(d,function(){w.launchApp(d)}):w.launchApp(d);else{var g,l=null;g=d.getState();g==CTXS.App.State.REQUESTABLE?(g=c.localization.string("Request"),l=function(){w.addApp(d)}):g==CTXS.App.State.PENDING?g=c.localization.string("Pending"):g==CTXS.App.State.DENIED?g=c.localization.string("Denied"):(g=c.localization.string("Install"),l=function(){w.addApp(d)});
var h=b.find(".action-menu");0==h.length&&(b.append("<div class='action-menu theme-highlight-border-color'></div>"),h=b.find(".action-menu"));l?h.html("<a href='#' class='theme-highlight-color'>"+g+"</a>"):h.html("<div class='theme-highlight-color'>"+g+"</div>");R&&R.removeClass("show");R=h;oa=l;h.addClass("show")}}function h(a){a=w.getAppByShortId(a);a.getState()===CTXS.App.State.ADDED?(CTXS.trace("Removing app from favourites:"+a.id),w.removeApp(a)):(CTXS.trace("Adding app from favourites:"+a.id),
(a.canBeAdded()||a.canBeRequested())&&w.addApp(a));p.disableAppFavorite(a)}function g(a){R&&(R.removeClass("show"),R=null);a=w.getAppByShortId(a);CTXS.Events.publish(CTXS.Events.ui.getAppInfoDetails,a)}function l(a){null!=CTXS.Category_ByIndex(a).parentCategory?(K.hideButtonsExcept(K.Buttons.Folders),K.hideSeparator()):(K.stopHidingButtons(),K.showSeparator())}function m(){la.requestAccountManagementUI()}function v(){CTXS.UI.useSmallUILayout()&&S.hide()}function n(){}function G(){t();v();M.hide();
p.clearUI()}function u(){if(T)r(T);else if(null!==ea?(E(),p.createGroupsForSubCategories([],CTXS.Category_ByIndex(ea),0),p.navigateToFolder(ea),ea=null):(a(),L.previousOption?L.showOption(L.previousOption):L.showOption(L.activeOption)),ca){O(ca);var b=L.options.tabs.filter(function(a){return"categories"===a.name});if(0<b.length&&L.returning){L.previousOption&&L.toolbarWidget.options.setActiveOption(L.previousOption);for(var c=-1,d=0;d<b[0].widget.filters.length;d++)if(b[0].widget.filters[d]===ca){c=
d;break}b[0].widget.setActiveFilterItem(ca,c)}}}function y(){CTXS.ExtensionsHead.preRedraw();t();CTXS.UI.useSmallUILayout()&&S.show();M.hide();ka.html(c.localization.string("AllApps"));CTXS.ExtensionsHead.postRedraw()}function s(){if(T&&ja){var a=!1;c.each(T.apps,function(){if(c(this)[0].canBeAdded())return a=!0,!1});a?ja.show():ja.hide()}}function r(a){T=a;CTXS.Events.publish(CTXS.Events.ui.showBundleDetails);CTXS.ExtensionsHead.preRedraw();t();v();M.hide();var b=c.trim(ga.attr("class").replace(/appBundle\d+/g,
""));ga.attr("class",b);ga.addClass(a.tileid);ga.find(".applicationBundleHeaderTitle").html(a.title);ga.find(".applicationBundleHeaderText").html(a.description);na.find("#bundleDetailBack").off("click").on("click",function(a){a.preventDefault();T=null;L.returning=!0;CTXS.Controllers.ViewController.forceRedrawOnBack();CTXS.Controllers.ViewController.revertView();L.previousOption=null});ja=na.find("#bundleAddAll");s();ja.off("click").on("click",function(b){b.preventDefault();c.each(a.apps,function(){var a=
c(this)[0];a.canBeAdded()&&w.addApp(a)})});p.showApps(a.apps);CTXS.ExtensionsHead.postRedraw()}function E(a){CTXS.ExtensionsHead.preRedraw();t();M.hide();var b=w.getAppHierachy();p.showAppsInFolderView(b);if(a&&(K.selectButton(K.Buttons.Folders),Y.selectButton(Y.Buttons.Folders),"\\"!=a)){a=a.split("\\");for(var c=0;c<a.length;c++)b&&(b=b.subcategories[a[c]]);b&&p.navigateToFolder(b.index)}CTXS.ExtensionsHead.postRedraw()}function A(){}function O(a){CTXS.ExtensionsHead.preRedraw();t();M.hide();ca=
a;T=null;var b=[];p.createGroupsForSubCategories(b,a,0);p.filterStoreApps(a.apps,b);CTXS.ExtensionsHead.postRedraw()}function F(){CTXS.ExtensionsHead.preRedraw();x();M.hide();var a=w.getMyApps();p.showMyApps(a);I(a.length);CTXS.ExtensionsHead.postRedraw()}function z(){CTXS.ExtensionsHead.preRedraw();if(T)r(T);else{M.show();var a=w.getMyApps();p.showApps(a,c.localization.string("QuickAccess"));ua.toggleClass("show",0==a.length);(a=CTXS.UserInfo.getName())?N(a):(N(),w.loadUserDisplayName())}CTXS.ExtensionsHead.postRedraw()}
function x(){T=ca=ea=null;L.previousOption=null;L.returning=!1;t()}function C(a){p.foldersWidget.updateToolbar(a)}function I(a){va.toggleClass("show",0==a);switch(CTXS.currentView){case "store":pa.text(c.localization.string("AddFavoritesTitleAppsOnly"));qa.text(c.localization.string("AddFavoritesDescriptionAppsOnlySubmenu"));ra.text(c.localization.string("AddFavoritesDescriptionPhoneAppsOnlySubmenu"));break;case "desktops":pa.text(c.localization.string("AddFavoritesTitleDesktopsOnly")),qa.text(c.localization.string("AddFavoritesDescriptionDesktopsOnlySubmenu")),
ra.text(c.localization.string("AddFavoritesDescriptionPhoneDesktopsOnlySubmenu"))}}function Q(){CTXS.Events.subscribe(CTXS.Events.store.appAddStarting,function(a,b){p.disableAppFavorite(b)});CTXS.Events.subscribe(CTXS.Events.store.appRemoveStarting,function(a,b){p.disableAppFavorite(b)});CTXS.Events.subscribe(CTXS.Events.store.appInstallStarting,function(a,b){D(a,b)});CTXS.Events.subscribe(CTXS.Events.store.appStatusChange,D);CTXS.Events.subscribe(CTXS.Events.store.appAddFailure,D);CTXS.Events.subscribe(CTXS.Events.store.appRevertFailure,
D);CTXS.Events.subscribe(CTXS.Events.resources.launchStatus,B);CTXS.Events.subscribe(CTXS.Events.ui.showAppDetails,function(){"search"==CTXS.Controllers.ViewController.getSavedView()?(K.$searchBackButton.addClass("show"),K.$searchInformation.addClass("show"),K.$container.addClass("show"),K.$container.addClass("search")):(K.$searchBackButton.removeClass("show"),K.$searchInformation.removeClass("show"),K.$container.removeClass("show"),K.$container.removeClass("search"))});CTXS.Events.subscribe(CTXS.Events.ui.showCategorizedApps,
A);CTXS.Events.subscribe(CTXS.Events.ui.showMyApps,F);CTXS.Events.subscribe(CTXS.Events.ui.showMyHome,z);CTXS.Events.subscribe(CTXS.Events.ui.showAllApps,function(){K.stopHidingButtons();K.showSeparator();y()});CTXS.Events.subscribe(CTXS.Events.ui.showDesktops,function(){CTXS.ExtensionsHead.preRedraw();x();M.hide();var a=c.localization.string("Desktops");ka.html(a);CTXS.ExtensionsHead.postRedraw()});CTXS.Events.subscribe(CTXS.Events.ui.showFiles,function(){CTXS.ExtensionsHead.preRedraw();x();M.hide();
CTXS.ExtensionsHead.postRedraw()});CTXS.Events.subscribe(CTXS.Events.ui.showTasks,function(){CTXS.ExtensionsHead.preRedraw();x();M.hide();p.showTasks();CTXS.ExtensionsHead.postRedraw()});CTXS.Events.subscribe(CTXS.Events.ui.showSettings,function(){CTXS.ExtensionsHead.preRedraw();x();M.hide();p.clearUI();L.slidingWidget.hidePaneNoAnimate();ka.html(c.localization.string("Settings"));CTXS.ExtensionsHead.postRedraw()});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetailsDropdown,function(a,b){p.openDetails(b.instant,
b.previousDetailsTop,b.scrollTo,b.$appsContainer)});CTXS.Events.subscribe(CTXS.Events.resources.powerOffStatus,q);CTXS.Events.subscribe(CTXS.Events.ui.showAppUpdates,n);CTXS.Events.subscribe(CTXS.Events.ui.clearSearchResults,ba);CTXS.Events.subscribe(CTXS.Events.ui.customView,G);CTXS.Events.subscribe(CTXS.Events.session.terminate,function(){p.clearUI()});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetailsLoadingSpinner,fa);CTXS.Events.subscribe(CTXS.Events.ui.hideAppDetailsLoadingSpinner,U);CTXS.Events.subscribe(CTXS.Events.resources.endRefreshApps,
function(){var a=w.getApplicationBundles();M.update(a)});CTXS.Events.subscribe(CTXS.Events.ui.changeCardSize,X);CTXS.Events.subscribe(CTXS.Events.resources.userDisplayNameSupplied,function(a,b){N(b)})}function P(){aa.click(function(a){a.preventDefault&&a.preventDefault();a=S.getText();CTXS.Controllers.ViewController.changeView("store");S.setText(a);S.focus()});c("body").on("click touch",function(a){R&&(R.removeClass("show"),0!=c(a.target).closest(R[0]).length&&(a.preventDefault(),a.stopPropagation(),
oa&&oa()),R=null)})}function D(a,b){p.updateAppState(b);s()}function B(a,b){var c=b.res,d=b.status;d==CTXS.LAUNCH_STARTING?(p.hideAppReadyToLaunchUI(c),p.showAppSpinner(c)):d==CTXS.LAUNCH_SUCCESS||d==CTXS.LAUNCH_FAILURE?p.hideAppLaunchSpinner(c):d==CTXS.LAUNCH_READY&&(p.hideAppLaunchSpinner(c),p.showAppReadyToLaunchUI(c))}function q(a,b){b.status==CTXS.POWEROFF_STARTING?p.showAppSpinner(b):b.status==CTXS.POWEROFF_FAILURE&&p.hideAppLaunchSpinner(b)}function Z(a){CTXS.ExtensionsHead.preRedraw();K.unselectAllButtons();
M.fadeOut();var b=da.doSearch(a);if(0==b.length)p.clearUI(),"store"==da.searchType?aa.hide():0<CTXS.Store.searchForApps(a).length?aa.show():aa.hide(),W.hide().addClass("active").fadeIn(400);else{W.stop(!0,!0).hide().removeClass("active");for(var d=[],g=0;g<b.length;g++){var l=b[g];switch(l.groupType){case "favourites":d.push({displayName:c.localization.string("QuickAccess"),apps:l.apps,count:l.apps.length});break;case "unfavouritedDesktops":d.push({displayName:c.localization.string("Desktops"),apps:l.apps,
count:l.apps.length});break;case "unfavouritedApps":d.push({displayName:c.localization.string("AllApps"),apps:l.apps,count:l.apps.length});break;default:d.push({displayName:c.localization.string("ContextualSearchTitle"),apps:l.apps,count:l.apps.length})}}p.filterStoreApps(b.length?b[0].apps:null,d);H();c(".storeViewSection")[0].scrollTop=0}CTXS.Events.publish(CTXS.Events.ui.showSearchResults,{apps:b});CTXS.ExtensionsHead.preRedraw();for(g=d=0;g<b.length;g++)d+=b[g].apps.length;M.hide();K.updateSearchInformation(a,
d);CTXS.ExtensionsHead.postRedraw()}function t(){W.stop(!0,!0).hide().removeClass("active");da.clearWidgets()}function ba(){var a=p.getCurrentFolderIndex();CTXS.Store.isFolderViewEnabled()&&null!=a&&da.isSearchOngoing()&&(ea=p.getCurrentFolderIndex());CTXS.Controllers.ViewController.cancellingSearch();CTXS.StoreViewManager.revertView();CTXS.Controllers.ViewController.searchCancelled()}function H(a){p&&p.resize(a);da&&da.resize();L.positionSelect()}function X(){H(!0)}function fa(a,b){p.showAppSpinner(b)}
function U(a,b){p.hideAppSpinner(b)}function ia(a,b,d){var g=w.getAppByShortId(a);w.updateAppPosition(a,b,d,function(a){a==CTXS.SUBSCRIPTION_FAILURE?(CTXS.trace("update position failed for app: "+g),CTXS.Environment.showDialog({messageText:c.localization.string("CannotMoveApp"),id:"MoveAppFailed"}),CTXS.Controllers.ViewController.changeView(CTXS.currentView)):a==CTXS.SUBSCRIPTION_PENDING||a==CTXS.SUBSCRIPTION_SILENTFAILURE?(CTXS.trace("update position failed silently for app: "+g),CTXS.Controllers.ViewController.changeView(CTXS.currentView)):
a==CTXS.SUBSCRIPTION_SUCCESS&&CTXS.trace("updated position ="+g.position)})}function N(a){a=a?c.localization.string("WelcomeUser",a):c.localization.string("Welcome");sa.html(a)}var ha,W,aa,J,V,w,p,M,Y,S,K,L,ga,na,ka,sa,da,la,ta=!1,ea=null,ca=null,R,oa,ma,ua,va,pa,qa,ra,ja,T=null;window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.StoreAppListViewController={patch:function(a){eval(a)},initialise:function(n,G,t,q,s,z,A,H,D,F,B){ha=n;W=G;ua=F;va=B;pa=B.find("#no-fav-filter-msg-title");
qa=B.find("#no-fav-filter-msg-desc");ra=B.find("#no-fav-filter-msg-desc-phone");aa=W.find(".all-app-results");J=c("head");V=c("body");ga=z;na=A;n=CTXS.UI.useSmallUILayout()?"#folderViewPhoneBackButton":"#folderViewBackButton";t.find(n);ka=t.find(".toolbar-header");sa=t.find(".toolbar-home-header");ma=c(".sliding-submenu-section");w=D;M=new CTXS.Widgets.ApplicationBundlesWidget(s,J,w.getApplicationBundles(),{useSmallTiles:CTXS.UI.useSmallTiles(),repeatTiles:CTXS.UI.repeatAppGroupTiles,minimumAvailableWidth:CTXS.UI.getMinimumAvailableWidth(),
onClickBundle:function(a){r(a)}});Y={};s=CTXS.UI.useSmallUILayout()?q.find(".store-toolbar-phone-content"):t.find(".submenu-tabs-container");L=new CTXS.Controllers.AppViewToolbarController(s,ma,c(".storeViewSection"),u,C,f,{filters:e(),tabs:d(),closeBtnClass:".sliding-submenu-close-btn",underlineHighlightClass:".toolbar",useSubMenu:!CTXS.UI.useSmallTiles()});p=new CTXS.Widgets.AppListViewWidget(V,ha,new CTXS.AnimatedSpinner,w.getCategoryHierarchyForApps(),w.getApplicationBundles(),L.toolbarWidget.showAllButtons.bind(L.toolbarWidget),
{onActionLinkClick:k,onDetailsLinkClick:g,onTaskLinkClick:m,onFolderNavigation:l,updateAppPosition:ia,canReorderApps:w.canReorderApps(),onFolderNameUpdate:b,onFolderNameHide:a,onFavoriteClick:h,onCollectionClick:function(a){r(a)}});Y=new CTXS.Widgets.StoreNavigationWidget(q,{controlMenuButtons:!1,menuButtonController:L,useFolderView:CTXS.Store.isFolderViewEnabled(),onAllAppsClick:c.noop,onFoldersClick:c.noop,onFeaturedClick:c.noop,onTopRatedClick:c.noop,onFolderBackClick:function(){p.navigateBack()},
folderBackButton:n});S=new CTXS.Widgets.SearchBoxWidget(H,{onTextEnter:Z,onTextClear:function(){CTXS.Events.publish(CTXS.Events.ui.clearSearchResults)}});H.find("input");da=new CTXS.Controllers.SearchPaneController(S,H,w);la=new CTXS.Controllers.AccountManagementController(c("#genericDialogBox"),{overlaySelector:"#genericDialogBoxOverlay",onAuthenticationError:function(){CTXS.Environment.showDialog({messageText:c.localization.string("CannotCompleteYourRequest")})}});K=new CTXS.Widgets.StoreNavigationWidget(t,
{buttonCssClass:".toolbar-button",separatorCssClass:".toolbar-button-separator",useFolderView:CTXS.Store.isFolderViewEnabled(),onAllAppsClick:function(){y()},onFoldersClick:function(){E()},onTopRatedClick:function(){CTXS.ExtensionsHead.preRedraw();x();M.hide();v();p.showApps(w.getTopRated());CTXS.ExtensionsHead.postRedraw()},onFeaturedClick:function(){CTXS.ExtensionsHead.preRedraw();x();p.showApps(w.getRecommendedApps());CTXS.ExtensionsHead.postRedraw()},onSearchBackClick:function(){S.cancelSearch()},
onFolderBackClick:function(){p.navigateBack()},folderBackButton:n});ta?CTXS.trace("storeviewcontroller calling initialize more than once (ignored)"):(Q(),P(),ta=!0)},resize:H,resetCancelSearch:x,setContent:function(a){CTXS.ExtensionsHead.preRedraw();t();M.hide();v();p.updateUI(a);CTXS.ExtensionsHead.postRedraw()},showFolder:E,showSelectedApps:function(a){CTXS.ExtensionsHead.preRedraw();x();M.hide();p.showApps(a);CTXS.ExtensionsHead.postRedraw()},setAccountManagementURL:function(a){la&&la.setAccountManagementURL(a)},
updateNewInstallStatus:function(){p.updateNewInstalledApps();p.updateNewInstallStatus()},updateNewInstalledClass:function(){p.updateNewInstalledApps();p.updateNewInstalledClass()}}})(jQuery);
(function(c){var f={buttonCssClass:"",separatorCssClass:"",controlMenuButtons:!0,menuButtonController:null,useFolderView:!1,onAllAppsClick:function(){},onCategoriesClick:function(){},onFeaturedClick:function(){},onFoldersClick:function(){},onTopRatedClick:function(){},onSearchBackClick:function(){},onFolderBackClick:function(){},searchBackButton:"#searchBack",searchInformation:".searchInformation",folderBackButton:""};window.CTXS=window.CTXS||{};CTXS.Widgets=CTXS.Widgets||{};CTXS.Widgets.StoreNavigationWidget=
function(b,a){this.options=c.extend({},f,a);this.$container=b;this.$allButtons=this.$container.find(this.options.buttonCssClass);this.$separators=this.$container.find(this.options.separatorCssClass);this.$searchBackButton=this.$container.find(this.options.searchBackButton);this.$searchInformation=this.$container.find(this.options.searchInformation);this.$folderBackButton=this.$container.find(this.options.folderBackButton);this.options.useFolderView||this.disableButton(this.Buttons.Folders);this._bindToUIEvents()};
CTXS.Widgets.StoreNavigationWidget.prototype={Buttons:{AllApps:".allapps-view",Folders:".folder-view"},hideToolbar:function(){this.$container.hide()},showToolbar:function(){this.$container.show()},selectButton:function(b){this.unselectAllButtons();this.$container.find(b).addClass("selected theme-highlight-color").removeClass("toolbar-button-unselected").attr("aria-selected",!0)},disableButton:function(b){this.$container.find(b).hide().addClass("toolbar-button-disabled")},hideButton:function(b){this.$container.find(b).hide()},
hideButtonsExcept:function(b){this.$container.find(this.options.buttonCssClass).not(b).css("display","none")},stopHidingButtons:function(){var b=this.$container.find(this.options.buttonCssClass).not(".toolbar-button-disabled"),a=this.$container.find(".toolbar-button-custom"),c=this.$container.find(this.Buttons.Folders);0==a.length&&c.hasClass("toolbar-button-disabled")?(this.hideButton(this.Buttons.AllApps),this.hideSeparator()):b.css("display","")},unselectAllButtons:function(){this.options.controlMenuButtons?
this.$allButtons.removeClass("selected theme-highlight-color").addClass("toolbar-button-unselected").attr("aria-selected",!1):CTXS.trace("Do Nothing")},hideSeparator:function(){this.options.controlMenuButtons?this.$separators.hide():CTXS.trace("Do Nothing")},updateSearchInformation:function(b,a){var d=c.localization.string("SearchResults",b,a),e=c(".searchinformation-ruler-container"),k=this.$container.width()-parseFloat(this.$searchInformation.css("padding-right")),d=CTXS.truncateToFit(e,d,k,1,!0);
this.$searchInformation.text(d)},showSeparator:function(){if(this.options.controlMenuButtons){if(!CTXS.UI.useSmallUILayout()){var b=this.$container.find(this.options.separatorCssClass);this.$container.find(this.Buttons.AllApps).is(":hidden")||b.show()}}else CTXS.trace("Do Nothing")},showFolderToolbar:function(b){CTXS.UI.useSmallUILayout()&&(this.$container.addClass("folder-tree"),this.$container.find(".toolbar-foldername-text").html(b))},hideFolderToolbar:function(){this.$container.removeClass("folder-tree");
this.$container.find(".toolbar-foldername-text").empty()},_bindToUIEvents:function(){var b=this,a;for(a in b.Buttons)if(b.Buttons.hasOwnProperty(a)){var c=b.Buttons[a],e="on"+a+"Click";b.$container.find(c).on("click",b._makeButtonClickHandler(c,e))}b.$searchBackButton.on("click",function(a){a.preventDefault();b.options.onSearchBackClick()});b.$folderBackButton.on("click",function(a){a.preventDefault();b.options.onFolderBackClick()})},_makeButtonClickHandler:function(b,a){var c=this;return function(e){e.preventDefault();
c.selectButton(b);c.options[a]()}}}})(jQuery);
(function(c){function f(a){d=a;m||(h=k=null)}function b(){if(k)return c(".appInfoView.scrollable:visible");switch(d){case a.ALL_APPS:case a.DESKTOPS:case a.MY_APPS:case a.MY_HOME:return c("section.scrollable.storeViewSection");case a.SETTINGS:return c(".settingsView.scrollable");default:return null}}var a={CATEGORY:"category",ALL_APPS:"apps",DESKTOPS:"desktops",SEARCH_RESULTS:"search",MY_APPS:"my-apps",MY_HOME:"my-home",SETTINGS:"settings",FILES:"files"},d=null,e=null,k=null,h=null,g=null,l=null,
m=!1;window.CTXS=window.CTXS||{};CTXS.StoreViewManager={patch:function(a){eval(a)},Views:a,initialise:function(){CTXS.Events.subscribe(CTXS.Events.ui.showCategorizedApps,function(){f(a.CATEGORY)});CTXS.Events.subscribe(CTXS.Events.ui.showAllApps,function(){f(a.ALL_APPS)});CTXS.Events.subscribe(CTXS.Events.ui.showDesktops,function(){f(a.DESKTOPS)});CTXS.Events.subscribe(CTXS.Events.ui.showMyApps,function(){f(a.MY_APPS)});CTXS.Events.subscribe(CTXS.Events.ui.showMyHome,function(){f(a.MY_HOME)});CTXS.Events.subscribe(CTXS.Events.ui.showSettings,
function(){f(a.SETTINGS)});CTXS.Events.subscribe(CTXS.Events.ui.showFiles,function(){f(a.FILES)});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetails,function(b,c){d!==a.SEARCH_RESULTS&&(k=c)});CTXS.Events.subscribe(CTXS.Events.ui.hideAppDetails,function(){d!==a.SEARCH_RESULTS&&(k=null)});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetailsDropdown,function(b,c){d!==a.SEARCH_RESULTS&&(h=c.$appsContainer.closest(".storeapp").data("shortid"))});CTXS.Events.subscribe(CTXS.Events.ui.hideAppDetailsDropdown,
function(){d!==a.SEARCH_RESULTS&&(h=null)});CTXS.Events.subscribe(CTXS.Events.ui.showSearchResults,function(){d!==a.SEARCH_RESULTS&&(c("section.scrollable.storeViewSection").scrollTop(0),e=d,d=a.SEARCH_RESULTS)})},getCurrentView:function(){return d},revertView:function(){if(d==a.SEARCH_RESULTS){m=!0;switch(e){case a.ALL_APPS:CTXS.Events.publish(CTXS.Events.ui.showAllApps);break;case a.DESKTOPS:CTXS.Events.publish(CTXS.Events.ui.showDesktops);break;case a.MY_APPS:CTXS.Events.publish(CTXS.Events.ui.showMyApps);
break;case a.MY_HOME:CTXS.Events.publish(CTXS.Events.ui.showMyHome);break;case a.SETTINGS:CTXS.Events.publish(CTXS.Events.ui.showSettings);break;case a.FILES:CTXS.Events.publish(CTXS.Events.ui.showFiles);default:CTXS.Events.publish(CTXS.Events.ui.showCategorizedApps)}if(k)CTXS.Events.publish(CTXS.Events.ui.showAppDetails,k);else if(h){var f=c('.storeapp[data-shortid="'+h+'"] ');CTXS.Events.publish(CTXS.Events.ui.showAppDetailsDropdown,{instant:!0,previousDetailTop:null,scrollTo:!1,$appsContainer:f})}null!==
g&&(f=b())&&f.scrollTop(g);null!==l&&(f=c(".store-toolbar-phone"),f.length&&f.scrollLeft(l));l=g=null;m=!1}},setCurrentScroll:function(){if(!m){var h=b(),e=c(".store-toolbar-phone");h&&h.length&&d!==a.SEARCH_RESULTS&&(g=h.scrollTop());e.length&&(l=e.scrollLeft())}}}})(jQuery);
(function(c){function f(a,c,e,k){a=decodeURI(b(a));CTXS.trace("recolor image: "+a);CTXS.Environment.recolorImage(a,c,e,k)}function b(a){a=c.trim(a);"url("==a.substring(0,4)&&(a='"'==a[4]||"'"==a[4]?a.substring(5,a.indexOf(a[4],5)):a.substring(4,a.length-1));return a}window.CTXS=window.CTXS||{};window.CTXS.recolorImages=function(){if(CTXS.Device.isNativeClient()||!CTXS.Device.isLegacyIE()){var a=c("#recolor-actions"),b=CTXS.parseColor(a.css("color"));b&&(f(a.css("background-image"),b,".theme-highlight-sprite",
!1),a=c(".folderTemplate"),f(a.css("background-image"),b,".folder .storeapp-icon",!0),f(a.css("background-image"),b,".large .appFiltersItem-Icon",!0));b=c(".theme-header-color:first");if(b=CTXS.parseColor(b.css("color")))a=c(".view-sprite:first"),f(a.css("background-image"),b,".view-sprite",!1)}};window.CTXS.updateSpriteColor=function(a,b,e,k){try{var h;if(k){var g=document.createElement("canvas"),l=g.getContext("2d");g.width=a.width;g.height=a.height;l.clearRect(0,0,a.width,a.height);l.drawImage(a,
0,0);var m=l.getImageData(0,0,g.width,g.height),f=parseInt(b[0],10),n=parseInt(b[1],10),G=parseInt(b[2],10);for(a=0;a<m.data.length;a+=4){var u=m.data[a+3];CTXS.Device.supportsTranslucentRecoloring()||(u=128<u?255:0);var y=m.data[a];m.data[a]=Math.round(f*y/255);m.data[a+1]=Math.round(n*y/255);m.data[a+2]=Math.round(G*y/255);m.data[a+3]=u}l.putImageData(m,0,0);h=g.toDataURL()}else{var s=document.createElement("canvas"),r=s.getContext("2d");s.width=a.width;s.height=a.height;r.clearRect(0,0,a.width,
a.height);r.drawImage(a,0,0);r.globalCompositeOperation="source-in";r.fillStyle="rgb("+b[0]+", "+b[1]+", "+b[2]+")";r.rect(0,0,a.width,a.height);r.fill();r.restore();h=s.toDataURL()}c("<style>{0}</style>".format(e+" { background-image: url('"+h+"'); }")).appendTo("head")}catch(E){CTXS.trace("Error recoloring sprite "+E)}};window.CTXS.setDirectXImagePaths=function(){if(CTXS.Device.isLegacyIE()){for(var a=c("#bundle-actions"),d="",e,k=1;10>k;k++)if(a.attr("class","bundleDetail appBundle"+k),e=b(a.css("background-image")))e=
"filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src = '{0}', sizingMethod = 'scale');".format(e),d+=".bundleDetail.appBundle{0} { {1} }\n".format(k,e);d&&(CTXS.trace("Adding DirectX filter CSS rules: "+d),c("<style>{0}</style>".format(d)).appendTo("head"))}};window.CTXS.patch_Sprites=function(a){eval(a)}})(jQuery);
(function(c){function f(b){var e="<style>";a(b,function(a){e+=a;c(e).appendTo("head")})}function b(b){var e="<style>";a(b,function(a){e+="@media (-ms-high-contrast: active) {"+a+"}</style>";c(e).appendTo("head")})}function a(a,b){try{var k=a.css("background-image");if(k&&"none"!==k){var h=k.replace("url(","").replace(")","").replace(/\"/gi,"").replace("file\\\\\\",""),h=h.substr(h.lastIndexOf("receiver/images/common"));CTXS.Environment.sendHttpRequest({type:"GET",url:h,data:null,suppressEvents:!0,
error:function(a,b){CTXS.trace("Error embedding SVG: "+h);CTXS.trace("TextStatus: "+b)},refreshSession:!1,complete:function(g,m){if(200!==g.status){CTXS.trace("Error embedding SVG (complete): "+h);CTXS.trace("TextStatus: "+m);var k=".embedded-"+c(a).attr("class").split(" ")[0];a.text()&&(k=a.text());k="<style>"+k+" { background-image:"+a.css("background-image")+"; }</style>";c(k).appendTo("head")}else{for(var f=c.parseXML(g.responseText),k=c(a).attr("class").split(" "),G=c(".high-contrast-colors"),
u=0;u<k.length;u++)switch(k[u]){case "theme-highlight-color":c(f).find(".theme-highlight-color").attr("stroke",a.css("color"));break;case "theme-header-color":a.hasClass("fill")?c(f).find(".theme-header-color").attr("fill",a.css("color")):c(f).find(".theme-header-color").attr("stroke",a.css("color"));break;case "theme-highlight-background-color":c(f).find(".theme-highlight-background-color").attr("fill",a.css("background-color"));break;case "high-contrast-only-recolor":case "high-contrast-recolor":CTXS.isHighContrastEnabled()&&
(a.hasClass("fill")&&c(f).find(".theme-highlight-background-color[fill]").attr("fill",a.css("color")),c(f).find(".theme-highlight-background-color[stroke]").attr("stroke",a.css("color")),a.hasClass("bg-fill")&&c(f).find(".high-contrast-colors.background[fill]").attr("fill",G.css("background-color")),a.hasClass("bg-stroke")&&c(f).find(".high-contrast-colors.background[stroke]").attr("stroke",G.css("background-color")),c(f).find(".unselected").attr("opacity","0.5"))}f=window.btoa((new XMLSerializer).serializeToString(f));
switch(!0){case 0===k[0].indexOf("embedded-"):case a.hasClass("high-contrast-only-recolor"):k="."+k[0];a.hasClass("grid")&&(k+=".grid");a.hasClass("largeTiles")&&(k=".largeTiles "+k);break;default:k=".embedded-"+k[0]}a.text()&&(k=a.text());b(k+" { background-image: url('data:image/svg+xml;base64,"+f+"'); }</style>")}}})}}catch(g){CTXS.trace("Error embedding SVG "+g)}}window.CTXS=window.CTXS||{};window.CTXS.embedSvgs=function(){var a=c("#embed-svg-actions:first"),e=CTXS.isHighContrastEnabled();a&&
a.children().each(function(){var a=c(this);switch(!0){case a.hasClass("high-contrast-only-recolor"):if(!e)break;case e&&a.hasClass("high-contrast-recolor"):b(a);break;default:f(a)}})}})(jQuery);
(function(c){var f={SMALL:"small",LARGE:"large"},b={TILE:"tile",SMALL:"small",LARGE:"large"};window.CTXS=window.CTXS||{};CTXS.UI={LAYOUT:f,CARD_SIZE:b,repeatAppGroupTiles:!0,useSmallUILayout:function(){return window.useSmallUI},useSmallTiles:function(){return window.useSmallTiles},useSmallCards:function(){return this.useSmallTiles()?!1:window.useSmallCards},getCardSize:function(){return this.useSmallTiles()?b.TILE:this.useSmallCards()?b.SMALL:b.LARGE},getLayout:function(){return this.useSmallUILayout()?
f.SMALL:f.LARGE},getMinimumAvailableWidth:function(){return window.minimumAvailableWidth},changeCardSize:function(){this.useSmallUILayout()||this.useSmallTiles()||(window.useSmallCards=!window.useSmallCards,c("html").toggleClass("largeCards",!window.useSmallCards).toggleClass("smallCards",window.useSmallCards),CTXS.Events.publish(CTXS.Events.ui.changeCardSize))}};c.extend(c.fn,{ctxsDisplayPane:function(){c(".fullscreen-pane").hide();this.show();return this},ctxsCenter:function(){return this.ctxsCenterHorizontally().ctxsCenterVertically()},
ctxsCenterHorizontally:function(){return this.each(function(){var a=c(this),b=a.outerWidth()/2*-1;a.css({left:"50%","margin-left":b+"px"})})},ctxsCenterVertically:function(){return this.each(function(){var a=c(this),b=a.outerHeight()/2*-1;a.css({top:"50%","margin-top":b+"px"})})},ctxsBindFocusWithin:function(a){a=a||{};var b=a.selector||":tabbable",e=this;a=c(this).add(a.overlay);a.ctxsUnbindFocusWithin();c.each(e.find(b),function(a,b){c(b).data("focusTabOrder",a)});e.is(b)&&e.data("focusTabOrder",
0);a.on("keydown.cycle",function(a){if(a.keyCode==c.ui.keyCode.TAB){a.preventDefault();var h=e.find(b),g=c(document.activeElement).data("focusTabOrder");!a.shiftKey||document.activeElement!=h.first().get(0)&&"undefined"!==typeof g?a.shiftKey?h.eq(g-1).focus():document.activeElement==h.last().get(0)||"undefined"===typeof g?h.first().focus():h.eq(g+1).focus():h.last().focus()}return!0});return this},ctxsUnbindFocusWithin:function(a){return c(this).add(a).off("keydown.cycle")},ctxsEnableArrowNavigation:function(a){a=
a||{};var b=this.find(a.selector||":tabbable"),e=b.length;this.on("keydown.arrows",function(a){if(a.keyCode==c.ui.keyCode.DOWN||a.keyCode==c.ui.keyCode.UP){var h=c.inArray(document.activeElement,b);a.keyCode==c.ui.keyCode.DOWN?c(b[(h+1)%e]).focus():a.keyCode==c.ui.keyCode.UP&&c(b[(e+(h-1))%e]).focus()}});return this},ctxsDisableArrowNavigation:function(){return this.off("keydown.arrows")},ctxsUnbindHoverFocusEvents:function(){this.off("mouseenter.unify");this.off("focusin.unify");this.off("focusout.unify");
return this},ctxsPlaceFocusOnFirstElement:function(a){a=a||{};this.find(a.selector||":focusable").first().focus();return this},ctxsAddCustomTooltip:function(a,b){function e(h,g){b.find(".pluginassistant-popup").hide();200<c(window).height()-g?a.css({left:h,top:g}).show():a.css({left:h,top:k.offset().top-a.height()-40}).show()}var k=this;this.on("mouseleave focusout",function(){a.hide()});this.on("mouseenter",function(a){var b=c(this);e(a.pageX,b.offset().top+b.outerHeight(!0)+20)});this.on("click",
function(b){b.preventDefault();b=c(this);a.is(":visible")?a.hide():e(k.offset().left,b.offset().top+b.outerHeight(!0))});a.hide()},ctxsRemoveCustomTooltip:function(){this.off("mouseleave focusout");this.off("mouseenter");this.off("click")},ctxsAddCustomTooltipForButton:function(a,b){var e=this;this.on("mouseleave focusout",function(){a.hide()});this.on("mouseenter",function(k){var h=c(this);h.hasClass("disabled")&&(k=h.offset().left+h.width()/2,h=h.offset().top-a.outerHeight(!0),b.find(".pluginassistant-popup").hide(),
200<c(window).height()-h?a.css({left:k,top:h}).show():a.css({left:k,top:h-e.height()-40}).show())});a.hide()},ctxsObliteratePassword:function(){return this.each(function(){var a=c(this);if(a.is('input[type="password"]')){var b=a.val();0<b.length&&(b=Array(b.length+1).join("*"),a.val(b))}})}})})(jQuery);
(function(c){var f=0;window.CTXS=c.extend(window.CTXS||{},{patch_UtilitiesUi:function(b){eval(b)},MESSAGE_TYPE:{NONE:"none",ALERT:"alert",WORKFLOW_APPROVED:"workflow approved"},showAuthenticationErrorMessage:function(b){b=b?c.localization.string("LogonHasExpired"):c.localization.string("PleaseLogOnToContinue");CTXS.Events.publish(CTXS.Events.session.terminate);CTXS.Environment.showDialog({messageText:b,buttonLabel:c.localization.string("LogOn"),buttonAction:CTXS.Environment.requestWebStoreRefresh,
id:"LogOn"})},showUnsupportedDeviceMessage:function(){CTXS.Environment.showDialog({messageTitle:c.localization.string("UnsupportedDevice"),messageText:c.localization.string("UnsupportedDeviceMessage"),id:"UnsupportedDeviceMessage"})},showTerminalErrorMessage:function(b){CTXS.Environment.showDialog({messageText:b,buttonAction:CTXS.Environment.requestWebStoreRefresh,id:"terminal"})},isHighContrastEnabled:function(){var b=c('<div class="high-contrast-check">');c("body").append(b);var a="none"===b.css("background-image");
b.remove();return a||window.matchMedia&&window.matchMedia("(-ms-high-contrast: active)").matches},refreshStore:function(){CTXS._isRefreshOK()&&CTXS.Environment.requestWebStoreRefresh()},_isRefreshOK:function(){if(0===f)return f=(new Date).getTime(),!0;var b=(new Date).getTime();return 2E3<=b-f?(f=b,!0):!1},displayPopup:function(b,a){a.fadeIn(500,function(){b.show();a.ctxsPlaceFocusOnFirstElement()}).ctxsBindFocusWithin({overlay:b})},instantDisplayPopup:function(b,a){a.fadeIn(.5,function(){b.show();
a.ctxsPlaceFocusOnFirstElement()}).ctxsBindFocusWithin({overlay:b})},fadePopup:function(b,a,d){a.fadeOut(500,function(){b.is("#genericMessageBoxOverlay")&&0<c(".aboutBox, .messageBoxPopup").filter(":visible").length||b.hide();d&&d()})},hidePopup:function(b,a){a.hide();b.hide()},isPopupVisible:function(b){return b.is(":visible")},popupsEnabled:function(b){var a=window.open("","testwindow","height=1,width=1,left=700000,top=7000000,menubar=no,scrollbars=no,status=no,resizable=no,toolbar=no");setTimeout(function(){a&&
0!==a.outerHeight?a&&a.close():(a&&a.close(),CTXS.Environment.showDialog({messageText:b,id:"PopupBlocker"}))},25)},removeIframeFromView:function(b){b=c(b).find(".frameLink");0<b.length&&b.remove()},addIframeToView:function(b,a){var d='<iframe class="frameLink scrollable" src="'+b+'" />',e=c(a);if(0!==e.length){var k=e.find(".frameLink");0!==k.length?k.attr("src")!==b&&k.attr("src",b):e.append(d)}},_getSubstringUnicode:function(b,a,c){var e=b.length;c="undefined"===typeof c?e:c;if(a>e||c>e||c<a||a===
c)return b;var k=a,h=c;0<a&&(k=this._isSurrogateCharacter(b,a)?a-1:a);0<c&&c<e&&(h=this._isSurrogateCharacter(b,c)?c-1:c);return b.substring(k,h)},_isSurrogateCharacter:function(b,a){var c=b.charCodeAt(a-1);return 55296<=c&&56319>=c},truncateToFit:function(b,a,d,e,k){if(!(b instanceof jQuery))return CTXS.trace("TruncateToFit - invalid ruler container provided."),a;if(0===d)return CTXS.trace("TruncateToFit - Container provided with a maxWidth value of 0: {0}".format(b.selector)),"";var h=b.find(":first-child"),
g=b.data("lineHeight");g||(g=h.text("x").outerHeight(),b.data("lineHeight",g));var l=g*e,m=a,f="",n="";b.width(d).css("white-space",1<e?"normal":"nowrap");h.css("line-height",g+"px");h.text(a);k?(f=m.match(/\(\d+\)$/)[0],n=this._getSubstringUnicode(a,0,a.lastIndexOf(f))):(f=this._getSubstringUnicode(m,m.length-3),m=this._getSubstringUnicode(m,0,m.length-6));b=null;e=h.outerWidth();for(g=h.outerHeight();g>l+1||e>d;)!b&&g>l?(b=g/l,m=this._getSubstringUnicode(m,0,m.length/b*1.4)):!b&&e>d&&(b=e/d,m=this._getSubstringUnicode(m,
0,m.length/b*1.4)),k?(n=this._getSubstringUnicode(n,0,n.length-1),a=c.trim(n)+"... "+f):(m=this._getSubstringUnicode(m,0,m.length-1),a=m+"..."+f),h.text(a),e=h.outerWidth(),g=h.outerHeight();return a},displayHTML5ThirdPartyNoticesLink:function(b){if(CTXS.ClientManager.getLaunchMethod()!=CTXS.LaunchMethod.HTML5||CTXS.Device.isCitrixChromeApp())b.hide();else{var a=CTXS.primaryStore.baseUrl+b.attr("href");b.attr("href",a).show()}},localizeAndBoldDetailText:function(b){return'<span class="detail-text-highlight">{0}</span>'.format(c.localization.string(b))},
isScrollable:function(b){return 0<b.length?b[0].scrollHeight>b[0].clientHeight:!1},scrollbarWidth:function(b,a){var c=b.width()+b.position().left;return a.width()+a.position().left-c},throttle:function(b,a){var c,e=null;return function(){var f=Date.now();c&&f&&f<c+a?(clearTimeout(e),e=setTimeout(function(){c=f;b()},a+c-f)):(clearTimeout(e),c=f,b())}},isVisibleWithinScrollPane:function(b,a){var d=b.offset().top,e=d+b.height(),f=a.offset().top,h=f+a.height(),g=d<f,d=!g&&d<h,h=e>h,e=!h&&e>f,l=b.offset().left,
m=l+b.width(),v=a.offset().left,n=v+a.width(),f=l<v,l=!f&&l<n,n=m>n,m=!n&&m>v;return b.is(":visible")&&(d||e||g&&h)&&(l||m||f&&n)&&0===c(".overlay:visible").length}})})(jQuery);
(function(c){function f(){m.on("click",function(a){a.preventDefault();CTXS.Controllers.StoreAppListViewController.resetCancelSearch();CTXS.Events.publish(CTXS.Events.ui.showMyHome)});v.on("click",function(a){a.preventDefault();CTXS.Events.publish(CTXS.Events.ui.showMyApps)});n.on("click",function(a){a.preventDefault();CTXS.Controllers.StoreAppListViewController.resetCancelSearch();CTXS.Events.publish(CTXS.Events.ui.showAllApps)});u.on("click",function(a){a.preventDefault();CTXS.Controllers.StoreAppListViewController.resetCancelSearch();
CTXS.Events.publish(CTXS.Events.ui.showDesktops)});G.on("click",function(a){a.preventDefault();CTXS.Events.publish(CTXS.Events.ui.showAppUpdates)});y.on("click",function(a){a.preventDefault();CTXS.Events.publish(CTXS.Events.ui.showTasks)});s.on("click",function(a){a.preventDefault();CTXS.Events.publish(CTXS.Events.ui.showFiles)})}function b(b,c){F=!1;b===q.HOME?CTXS.Events.publish(CTXS.Events.ui.showMyHome):b===q.MY_APPS?CTXS.Events.publish(CTXS.Events.ui.showMyApps):b===q.APPS?CTXS.Events.publish(CTXS.Events.ui.showAllApps):
b===q.DESKTOPS?CTXS.Events.publish(CTXS.Events.ui.showDesktops):b===q.APP_UPDATES?CTXS.Events.publish(CTXS.Events.ui.showAppUpdates):b===q.APP_INFO?CTXS.Events.publish(CTXS.Events.ui.showAppDetails):b===q.BUNDLE_DETAILS?CTXS.Events.publish(CTXS.Events.ui.showBundleDetails):b===q.SEARCH?CTXS.Events.publish(CTXS.Events.ui.showSearchView):b===q.SETTINGS?CTXS.Events.publish(CTXS.Events.ui.showSettings):b===q.FILES?CTXS.Events.publish(CTXS.Events.ui.showFiles):c&&a(b,c)}function a(a,b){CTXS.trace("ViewController switch to view :"+
a+" "+b);A=a;CTXS.ExtensionsHead.preRedraw();for(var d=l[0].className.split(/\s+/),g=0;g<d.length;g++){var h=d[g];"-view"==h.substring(h.length-5)&&l.removeClass(h)}a!==q.APP_INFO&&a!==q.SEARCH&&(r.removeClass(E),r.attr("aria-selected",!1));P||a===q.BUNDLE_DETAILS||a===q.SEARCH||(I=[]);CTXS.currentView=a;d=a+"-view";l.addClass(d);r.filter("."+d).addClass(E);r.filter("."+d).attr("aria-selected",!0);b&&CTXS.Events.publish(CTXS.Events.ui.customView,b);var m=c("#toolbar"),e;if(m.is(":visible")&&(d=c(".search-container.active"),
d.is(":visible")&&25<d.offset().top-m.offset().top)){CTXS.trace("hide/show toolbar");(e=m.attr("style"))||(e="");m.css("display","none");window.setTimeout(function(){m.attr("style",e);CTXS.trace("call extensions postredraw 1");CTXS.ExtensionsHead.postRedraw()},1);return}CTXS.trace("call extensions postredraw 2");CTXS.ExtensionsHead.onViewChange(a,b);CTXS.ExtensionsHead.postRedraw();CTXS.ExtensionAPI.resize(!0)}function d(){CTXS.Events.subscribe(CTXS.Events.ui.showMyHome,function(){a(q.HOME,null,!0)});
CTXS.Events.subscribe(CTXS.Events.ui.showMyApps,function(){a(q.MY_APPS,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showAllApps,function(){a(q.APPS,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showDesktops,function(){a(q.DESKTOPS,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showTasks,function(){a(q.TASKS,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showFiles,function(){a(q.FILES,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showAppUpdates,function(){a(q.APP_UPDATES,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetails,
function(){A!==q.APP_INFO&&(O.push(A),k());a(q.APP_INFO,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showAppDetailsDropdown,function(a,b){if(A!==q.BUNDLE_DETAILS){var c=b.$appsContainer.closest(".storeapp").data("shortid");I.push(c);null!==Q&&Q++}});CTXS.Events.subscribe(CTXS.Events.ui.hideAppDetailsDropdown,function(){A!==q.BUNDLE_DETAILS&&I.pop()});CTXS.Events.subscribe(CTXS.Events.ui.showBundleDetails,function(){A!==q.BUNDLE_DETAILS&&(O.push(A),k());a(q.BUNDLE_DETAILS,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showSearchResults,
function(){A!==q.SEARCH&&(O.push(A),Q=C=0);a(q.SEARCH,null,!0)});CTXS.Events.subscribe(CTXS.Events.ui.showSettings,function(){a(q.SETTINGS,null,!0)});CTXS.Events.subscribe(CTXS.Events.session.terminate,g)}function e(a){switch(a){case q.HOME:case q.MY_APPS:case q.APPS:case q.DESKTOPS:case q.TASKS:case q.BUNDLE_DETAILS:case q.SEARCH:return c("section.scrollable.storeViewSection");case q.APP_INFO:return c(".appInfoView.scrollable:visible");case q.SETTINGS:return c(".settingsView.scrollable");default:return null}}
function k(){if(!P){var a=e(A),b=c(".store-toolbar-phone:visible");a&&x.push(a.scrollTop());null!==C&&C++;b.length&&(z=b.scrollLeft())}}function h(){return O[O.length-1]}function g(){r.off("click").removeAttr("href")}var l,m,v,n,G,u,y,s,r,E="selected",A,O=["myhome"],F=!1,z=null,x=[],C=null,I=[],Q=null,P=!1,D,B={isMyHomeViewVisible:!0,isMyAppsViewVisible:!0,isAllAppsViewVisible:!0,isDesktopsViewVisible:!0,isFilesViewVisible:!0,isTasksViewVisible:!0},q={APP_INFO:"appinfo",APP_UPDATES:"updates",APPS:"store",
BUNDLE_DETAILS:"bundledetail",DESKTOPS:"desktops",FILES:"files",HOME:"myhome",MY_APPS:"myapps",SEARCH:"search",SETTINGS:"settings",TASKS:"tasks"};window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.ViewController={patch:function(a){eval(a)},initialise:function(a,b,g,h,e,k,q,E,x,z,A){D=c.extend({},B,A);l=a;m=g;v=h;n=e;G=k;u=q;s=x;y=E;r=b;f();d();r.attr("href","#");a=z.getUpgradeApps().length;0<a&&G.attr("data-updates",9<a?9:a).addClass("updates-available");m.toggle(D.isMyHomeViewVisible);
v.toggle(D.isMyAppsViewVisible);n.toggle(D.isAllAppsViewVisible);u.toggle(D.isDesktopsViewVisible);s.toggle(D.isFilesViewVisible);y.toggle(D.isTasksViewVisible)},changeView:b,revertView:function(){P=!0;var d=O.pop();F?b(d):a(d);if(0<I.length){var g=I.pop(),g=c('.storeapp[data-shortid="'+g+'"] ');CTXS.Events.publish(CTXS.Events.ui.showAppDetailsDropdown,{instant:!0,previousDetailTop:null,scrollTo:!1,$appsContainer:g});Q&&Q--}0<x.length&&(g=x.pop(),d=e(d),C&&C--,d&&d.scrollTop(g));null!==z&&c(".store-toolbar-phone:visible").scrollLeft(z);
CTXS.Controllers.StoreAppListViewController.updateNewInstalledClass();CTXS.Controllers.StoreAppListViewController.updateNewInstallStatus();P=!1},forceRedrawOnBack:function(){F=!0},redrawOnBack:function(){var a=h();F=a===q.HOME||a===q.MY_APPS},getSavedView:h,searchCancelled:function(){0<x.length&&null!=C&&x.splice(x.length-1,C);0<I.length&&null!=Q&&I.splice(I.length-1,I);C=Q=null;P=!1},cancellingSearch:function(){P=!0}}})(jQuery);
(function(c){window.CTXS=window.CTXS||{};CTXS.Controllers=CTXS.Controllers||{};CTXS.Controllers.WorkflowNotificationController=function(c){this.store=c;this._renderInitialView()};CTXS.Controllers.WorkflowNotificationController.prototype={_renderInitialView:function(){var f=this.store.getWorkflowApprovedApps(),b=this.store.getWorkflowDeniedApps(),a="",d=this;0<f.length&&0<b.length?(a=this._composeApprovedMsg(f)+"<br/><br/>"+this._composeDeniedMsg(b),CTXS.Environment.showDialog({messageType:CTXS.MESSAGE_TYPE.WORKFLOW_APPROVED,
messageText:a,buttonAction:function(){d.store.revertDeniedApps()},id:"workflowApprovedAndDenied"})):1==f.length?(a=this._composeApprovedMsg(f),CTXS.Environment.showDialog({messageType:CTXS.MESSAGE_TYPE.WORKFLOW_APPROVED,messageText:a,buttonLabel:c.localization.string("Add"),buttonAction:function(){d.store.addApprovedApps()},id:"workflowApproved"})):1<f.length?(a=this._composeApprovedMsg(f),CTXS.Environment.showDialog({messageType:CTXS.MESSAGE_TYPE.WORKFLOW_APPROVED,messageText:a,id:"workflowApproved"})):
0<b.length&&(a=this._composeDeniedMsg(b),CTXS.Environment.showDialog({messageText:a,buttonAction:function(){d.store.revertDeniedApps()},id:"workflowDenied"}))},_composeApprovedMsg:function(f){return this._composeWorkflowMessage(f,c.localization.string("SingleApprovedApp"),c.localization.string("MultiApprovedApps"))},_composeDeniedMsg:function(f){return this._composeWorkflowMessage(f,c.localization.string("SingleDeniedApp"),c.localization.string("MultiDeniedApps"))},_composeWorkflowMessage:function(f,
b,a){var d=c.map(f,function(a){return a.encodedName}).join(", ");return(1<f.length?a:b)+'<br/><span class="workflow-app-list">'+d+"</span>"}}})(jQuery);
(function(c){var f=(new Date).getTime(),b={};CTXS.NativeHelper={patch:function(a){eval(a)},storeCallback:function(a){if(null==a)return 0;f++;var c={};c.id=String(f);c.obj=a;b[c.id]=c;return c.id},retrieveCallback:function(a,c){var e=b[a];if(e)return c||delete b[a],e.obj;CTXS.trace("No callback found in retrieveCallback id="+a);return null},toNativeId:function(a){var b=a.id;a.store.id&&(b=a.store.id+"@@"+b);return b},toWebId:function(a){var b=a.indexOf("@@");-1!=b&&(a=a.substring(b+2));return a},toStoreId:function(a){var b=
a.indexOf("@@");return-1==b?"":a.substring(0,b)},handlePatch:function(){if(CTXS.NativeCapabilities&&CTXS.NativeCapabilities.patch){CTXS.trace("Found patch block");var a=CTXS.NativeCapabilities.patch;if(a.css){var b=document.createElement("style");b.type="text/css";b.innerText=a.css;c("head").append(b)}a.html&&c("body").append(a.html);a.script&&(b=document.createElement("script"),b.type="text/javascript",b.innerText=a.script,c("body").append(b));if(a.stop)return!1}return!0},toXmlString:function(a){var b;
try{b=window.ActiveXObject?a.xml:(new XMLSerializer).serializeToString(a)}catch(c){CTXS.trace("XMLSerialization Exception - return null"),b=null}return b},loadAppListForStore:function(a,b){CTXS.Environment.localStorageGetItem("enum-"+a.id,function(e){var f;try{f=JSON.parse(e)}catch(h){CTXS.trace("Local storage exception "+h),f=null}var g={};if(null!=f)for(e=0;e<f.resources.length;e++)f.resources[e].store=a,g[f.resources[e].id]=f.resources[e];CTXS.Environment.localStorageGetItem("enumdelta-"+a.id,
function(a){var h=null;if(a)try{h=JSON.parse(a)}catch(e){CTXS.trace("Local storage exception "+e)}if(null!=h)for(a=0;a<h.resources.length;a++){var n=h.resources[a],G=g[n.id];G&&(c.extend(G,n),G.modified=!0)}b(f)})})},saveAppListFromStore:function(a,b){var c;for(c=0;c<b.resources.length;c++)b.resources[c].store=null;var f=JSON.stringify(b);for(c=0;c<b.resources.length;c++)b.resources[c].store=a;CTXS.Environment.localStorageSetItem("enum-"+a.id,f);CTXS.Environment.localStorageSetItem("enumdelta-"+a.id,
"")},saveModifiedAppListFromStore:function(a){for(var b,c={resources:[]},f=0;2>f;f++){var h=0==f?CTXS.Store.getAllApps():CTXS.Store.getDesktops();for(b=0;b<h.length;b++){var g=h[b];g.store==a&&g.modified&&c.resources.push({id:g.id,subscriptionstatus:g.subscriptionstatus,subscriptionproperties:g.subscriptionproperties,position:g.position})}}b=JSON.stringify(c);CTXS.Environment.localStorageSetItem("enumdelta-"+a.id,b)}}})(jQuery);
(function(c){function f(a){var b=c.localization.string(a);return b?b:a}function b(a,b){return null==a||a==c.noop||CTXS.ExtensionsHead._debug?a:function(){try{return CTXS.trace("call extension for "+b),a.apply(CTXS.Extensions,arguments)}catch(c){CTXS.trace("Error in extension for "+b+" ex="+c),CTXS.ExtensionsHead._errors&&window.alert&&window.alert("Error in extension for "+b+" ex="+c)}}}function a(a,b,c,d){for(var g=!1,l=[],h,e=0;e<c.length-1;e++)l.push(c[e]);h=c[c.length-1];l.push(function(){g=!0;
return h()});try{return CTXS.trace("call extension: "+d),b.apply(a,l)}catch(f){if(g)throw f;CTXS.trace("Error in CTXS.Extensions."+d+" ex="+f);CTXS.ExtensionsHead._errors&&window.alert("Error in extension "+d+" ex="+f);return h?h():null}}function d(b,d,g){var l,h;b?(h=!0,l=b.fn,b=b.obj):(l=CTXS.Extensions[d],b=CTXS.Extensions,h=-1==c.inArray(l,CTXS.Extensions._defaultFns));if(CTXS.ExtensionsHead._debug||!h)return l.apply(b,g);if(CTXS.ExtensionsHead._functionPrototypes[d]==CTXS.Extensions._callLast)return a(b,
l,g,d);var e;h=b;try{CTXS.trace("call extension: "+d),e=l.apply(h,g)}catch(f){CTXS.trace("Error in CTXS.Extensions."+d+" ex="+f),CTXS.ExtensionsHead._errors&&window.alert("Error in extension "+d+" ex="+f),e=null}return e}function e(a){return function(){return d(CTXS.ExtensionsHead._pluginFns[a],a,arguments)}}function k(a){return function(b,c){for(var g=CTXS.ExtensionsHead._pluginFns[b];a!=g.obj;)g=g.next;return d(g.next,b,c)}}window.CTXS=window.CTXS||{};var h=null,g=null;CTXS.ExtensionAPI={patch:function(a){eval(a)},
addPlugin:function(a){if(document.currentScript){var b=document.currentScript.getAttribute("data-plugin");b&&b!=a.name&&(CTXS.trace("WARNING: Plugin name mismatch. ScriptTag says:"+b+" explicit:"+a.name),a.name||(a.name=b))}CTXS.Plugins.runPluginInOrder(a.name,function(b){a.chain=k(a);for(var d in a){var g=a[d];if(c.isFunction(g)&&c.isFunction(CTXS.Extensions[d])){var l=CTXS.ExtensionsHead._pluginFns[d];if(l){for(;l.next;)l=l.next;l.next={obj:a,fn:g}}else CTXS.ExtensionsHead._pluginFns[d]={obj:a,
fn:g}}}a.initialize&&a.initialize(b)})},addCustomCredentialHandler:function(a){CTXS.AuthExtensions.addCustomCredentialHandler(a)},addCustomAuthLabelHandler:function(a){CTXS.AuthExtensions.addCustomLabelHandler(a)},showMessage:function(a){a.localize&&(a.messageText=f(a.messageText),a.messageTitle=f(a.messageTitle),a.okButtonText=f(a.okButtonText),a.cancelButtonText=f(a.cancelButtonText));var c={};c.messageText=a.messageText;c.messageType=a.isalert?CTXS.MESSAGE_TYPE.ALERT:CTXS.MESSAGE_TYPE.NONE;a.messageTitle&&
(c.messageTitle=a.messageTitle);a.okButtonText&&(c.buttonLabel=a.okButtonText);a.cancelButtonText&&(c.cancelButtonLabel=a.cancelButtonText);c.cancelButtonAction=b(a.cancelAction,"messageBox cancel");c.buttonAction=b(a.okAction,"messageBox ok");c.id=a.isalert?"custom-alert":"custom";CTXS.Environment.showDialog(c)},resize:function(a){var b=0,d=0,l=c(".store-toolbar"),e=c("#pluginTop"),f=c("#pluginBottom");l.is(":visible")&&(b+=l.outerHeight(!0));e.is(":visible")&&(b+=e.outerHeight(!0));f.is(":visible")&&
(d+=f.outerHeight(!0));a&&null==h&&0==b&&0==d||(a=b+" "+d,g!=a&&(g=a,b=".large .storeViewSection {top: "+(b+71)+"px;bottom:"+d+"px;}\n.large .filesViewSection {top: "+(b+71)+"px;bottom:"+d+"px;}\n.small .myhome-view .storeViewSection {top: "+(b+56)+"px;bottom:"+(d+0)+"px;}\n.small .myapps-view .storeViewSection {top: "+(b+56)+"px;bottom:"+(d+0)+"px;}\n.small .files-view .storeViewSection {top: "+(b+56)+"px;bottom:"+(d+0)+"px;}\n.small .store-view .storeViewSection  {top: "+(b+104)+"px;bottom:"+(d+
0)+"px;}\n.small.largeTiles .myhome-view .storeViewSection {top: "+(b+64)+"px;bottom:"+(d+0)+"px;}\n.small.largeTiles .myapps-view .storeViewSection {top: "+(b+64)+"px;bottom:"+(d+0)+"px;}\n.small.largeTiles .files-view .storeViewSection {top: "+(b+64)+"px;bottom:"+(d+0)+"px;}\n.small.largeTiles .store-view .storeViewSection  {top: "+(b+112)+"px;bottom:"+(d+0)+"px;}\n.large .appinfo-view .storeViewSection {top:"+(b+71)+"px;bottom:"+d+"px;}\n.large .bundledetail-view .storeViewSection {top:"+(b+119)+
"px;bottom:"+d+"px;}\n.small .appinfo-view .appInfoView {top:"+(b+101)+"px;bottom:"+d+"px;}\n.small .bundledetail-view .storeViewSection {top:"+(b+104)+"px;bottom:"+d+"px;}\n.small.largeTiles .bundledetail-view .storeViewSection {top:"+(b+112)+"px;bottom:"+d+"px;}\n",null==h?(h=document.createElement("style"),h.type="text/css",CTXS.Device.isLegacyIE()&&h.styleSheet?h.styleSheet.cssText=b:h.innerHTML=b,document.getElementsByTagName("head")[0].appendChild(h)):CTXS.Device.isLegacyIE()&&h.styleSheet?
h.styleSheet.cssText=b:h.innerHTML=b))},trace:function(a,b){CTXS.trace(a,b)},refresh:function(){CTXS.Environment.refresh()},changeView:function(a,b){CTXS.Controllers.ViewController.changeView(a,b)},navigateToFolder:function(a){CTXS.Controllers.StoreAppListViewController.showFolder(a)},addToolbarButton:function(a,d,g,l){a||(a="R"+Math.random().toString().substring(2));c(".store-toolbar .addBefore").before("<a role='tab' aria-selected='false' class='toolbar-button toolbar-button-custom theme-highlight-color theme-highlight-hover-color theme-highlight-border-color "+
a+"' href='#'>"+d+"</a><div class='toolbar-button-separator'></div>");c(".store-toolbar-phone .phone-toolbar-button:last").before('<a href="#" role="tab" aria-selected="false" class="phone-toolbar-button toolbar-button-custom theme-highlight-color '+a+'"><span class="theme-highlight-border-color">'+d+"</span></a>");var h=c(".store-toolbar-phone .phone-toolbar-button");h.css("width",100/h.length+"%");l=b(l,"toolbar button "+d);c("."+a).on("click",function(a){a.preventDefault();g&&(c(".store-toolbar .toolbar-button").removeClass("selected"),
c(".store-toolbar-phone .phone-toolbar-button").removeClass("selected"),c(this).addClass("selected"),CTXS.Controllers.StoreAppListViewController.setContent(g));l&&l(a)})},addViewButton:function(a,b,d){d||(d=b);c(".tablet-only .toggle-view-button:last").after('<a role="tab" aria-selected="false" class="toggle-view-button '+a+'-view theme-header-selection-color"><div class="view-sprite"></div><span class="theme-header-color">'+b+"</span></a>");c(".phone-only .toggle-view-button:last").after('<a role="tab" aria-selected="false" class="toggle-view-button primary menu-action theme-header-color '+
a+'-view theme-header-selection-color"><div class="action-icon-container"><div class="action-icon view-sprite"></div></div><span class="action-text">'+b+"</span></a>");c("."+a+"-view").on("click",function(b){b.preventDefault();CTXS.ExtensionAPI.changeView(a,d)})},addInfoButton:function(a,d,g){a||(a="R"+Math.random().toString().substring(2));g=b(g,"info button "+d);d='<a href="#" class="theme-highlight-color theme-highlight-border-color appInfoActionButton '+a+'">'+d+"</a>";c(".appInfoActions a:last").after(d);
c("."+a).on("click",function(a){a.preventDefault();g&&g(a)})},addHelpButton:function(a){CTXS.UI.useSmallUILayout()?c(".help-button").removeClass("hide").click(a):c(".help-icon").css("display","inline-block").click(a)},localStorageGetItem:function(a,b){CTXS.Environment.localStorageGetItem(a,b)},localStorageSetItem:function(a,b,c){CTXS.Environment.localStorageSetItem(a,b,c)},openUrl:function(a){CTXS.Environment.openUrl(a)},proxyRequest:function(a,b){a.suppressEvents=!0;var d=function(){c.ctxsAjax(a)};
b?CTXS.Environment.goOnline(CTXS.primaryStore,d):d()},enableSubscriptionProperties:function(){CTXS.Environment.useExtendedResourceDetails=!0},updateSubscriptionProperties:function(a,d){d=d?b(d,"subscription properties callback"):c.noop;CTXS.Environment.updateSubscriptionProperties(a,function(){d();a.modified=!0;CTXS.Environment.updateOfflineCache(a.store)})},launch:function(a){CTXS.Store.launchApp(a)},showSelectedApps:function(a){CTXS.Controllers.StoreAppListViewController.showSelectedApps(a)}};CTXS.ExtensionsHead=
{_debug:CTXS.isUrlParamDefined("-debug"),_errors:CTXS.isUrlParamDefined("-errors")&&window.alert,isDefined:function(a){return this._pluginFns[a]?!0:(a=CTXS.Extensions[a])&&-1==c.inArray(a,CTXS.Extensions._defaultFns)},_pluginFns:{},_functionPrototypes:c.extend({},CTXS.Extensions)};for(var l in CTXS.Extensions)c.isFunction(CTXS.Extensions[l])&&(CTXS.ExtensionsHead[l]=e(l))})(jQuery);
(function(c){function f(a,b,c){CTXS.Environment.goOnline(a,function(){a&&"PNA"==a.type?CTXS.PNAClient.getConfig(a,b,c):CTXS.WebApiClient.getConfig(a==CTXS.primaryStore&&CTXS.Environment.configurationUrl?CTXS.Environment.configurationUrl:a.baseUrl+"Home/Configuration",b,c)},c)}function b(a,b,c){CTXS.Environment.goOnline(a,function(){if("PNA"==a.type)CTXS.PNAClient.requestResources(a,null,b,c);else{var d=[CTXS.RESOURCE_DETAILS.DEFAULT];("full"==CTXS.Config.getConfigValue("storeProxy.resourcesProxy.resourceDetails",
"default")||CTXS.Environment.useExtendedResourceDetails||CTXS.Device.isCitrixChromeApp())&&d.push(CTXS.RESOURCE_DETAILS.FULL);var e=a.baseUrl+CTXS.Config.getConfigValue("storeProxy.resourcesProxy.listURL",null,a);CTXS.ResourcesClient.requestResources(a,e,d,b,c)}},c)}function a(a,b){CTXS.Environment.goOnline(a.store,function(){CTXS.AppInstall.getInstallUrl(a,function(d){CTXS.Config.isMdmMode()&&CTXS.Events.publish(CTXS.Events.ui.showAutoMessage,{messageText:c.localization.string("WaitAppInstallMessage")});
b(CTXS.SUCCESS);a.mobilelink&&CTXS.Device.getPlatform()==CTXS.Device.Platform.IOS||CTXS.Events.publish(CTXS.Events.store.mobileAppInstall,d)},function(){b(CTXS.FAILURE)})},function(){b(CTXS.FAILURE)})}function d(a,b){CTXS.Environment.goOnline(a.store,function(){CTXS.ItmsAppInstall.getInstallUrl(a,function(a){CTXS.Events.publish(CTXS.Events.store.mobileAppInstall,a);window.setTimeout(function(){b(CTXS.SUCCESS)},3E3)},function(){b(CTXS.FAILURE)})},function(){b(CTXS.FAILURE)})}function e(a){a&&a.preventDefault&&
a.preventDefault()}window.CTXS=window.CTXS||{};CTXS.Environment=c.extend(CTXS.Environment,{patch:function(a){eval(a)},disableDragDrop:function(){try{document.addEventListener?(document.addEventListener("drop",e),document.addEventListener("dragstart",e)):document.attachEvent&&(document.attachEvent("drop",e),document.attachEvent("dragstart",e))}catch(a){CTXS.trace("failed to disable drag drop "+a)}},initialize:function(a){CTXS.primaryStore=CTXS.primaryStore||CTXS.Config;CTXS.primaryStore.id="";CTXS.primaryStore.baseUrl=
"";CTXS.Environment.disableDragDrop();a()},includeAppInStore:function(a){var b=a.content&&!a.ismobileapp;return a.supportsIcaLaunch||b},canLaunchResource:function(a){var b=a.supportsIcaLaunch||a.content;a=a.requiresvpn&&CTXS.Environment.isGatewaySession()||a.disabled||!a.clienttypes;return b&&!a},treatAsAdded:function(a){return a.supportsSubscription?a.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED:!0},getConfiguration:function(a,b,d){CTXS.trace("Environment.getConfiguration() store="+a.id+
" workOffline="+a.workOffline);if(CTXS.Environment.enableOffline&&CTXS.Environment.localStorageGetItem){var e=function(c){var d=CTXS.NativeHelper.toXmlString(c);CTXS.Environment.localStorageSetItem("config-"+a.id,d);b(c)};a.workOffline?CTXS.Environment.localStorageGetItem("config-"+a.id,function(k){k?(k=c.parseXML(k),b(k)):(CTXS.trace("failed to find offline data - try online"),a.firstUseHint=!0,f(a,e,d))}):f(a,e,d)}else f(a,b,d)},enumerateResources:function(a,c,d){if(CTXS.Environment.enableOffline){var e=
function(b){CTXS.NativeHelper.saveAppListFromStore(a,b);c(b)};a.workOffline?CTXS.NativeHelper.loadAppListForStore(a,function(f){null!=f?("PNA"==a.type&&(CTXS.trace("--- load offline PNA images"),CTXS.PNAClient.loadOfflineImages(a,f)),c(f)):b(a,e,d)}):b(a,e,d)}else b(a,c,d)},getListOfAvailableSessions:function(a,b,c){(new CTXS.SessionsServiceClient).listAvailableSessions(a,{resourceTypes:"Citrix.MPS.Application"},b,c)},performSubscribe:function(a,b){CTXS.Environment.goOnline(a.store,function(){"PNA"==
a.store.type?CTXS.PNAClient.performSubscribe(a,b):CTXS.ResourcesClient.subscription(a,"subscribe",b)},function(){b(CTXS.SUBSCRIPTION_FAILURE)})},performUnsubscribe:function(a,b){CTXS.Environment.goOnline(a.store,function(){"PNA"==a.store.type?CTXS.PNAClient.performUnsubscribe(a,b):CTXS.ResourcesClient.subscription(a,"unsubscribe",b)},function(){b(CTXS.SUBSCRIPTION_FAILURE)})},performUpdatePosition:function(a,b){CTXS.Environment.goOnline(a.store,function(){"PNA"==a.store.type?CTXS.PNAClient.performUpdatePosition(a,
b):a.supportsSubscription&&CTXS.ResourcesClient.subscription(a,"update",b)},function(){b(CTXS.SUBSCRIPTION_FAILURE)})},updateSubscriptionProperties:function(a,b){b||(b=c.noop);"PNA"!=a.store.type&&a.supportsSubscription?CTXS.ResourcesClient.subscription(a,"update",function(a){a==CTXS.SUBSCRIPTION_FAILURE?b(CTXS.FAILURE):b(CTXS.SUCCESS)}):b(CTXS.FAILURE)},notifySubscriptionStateChange:null,installApp:function(b,c){b.supportsStandardInstallation?a(b,c):b.supportsItmsInstallation?d(b):(b.publicappstoreurl&&
CTXS.Events.publish(CTXS.Events.store.linkToPublicAppStore,b.publicappstoreurl),c(CTXS.SUCCESS))},cancelAppInstall:null,launchApp:function(a,b){CTXS.Environment.goOnline(a.store,function(){CTXS.launchResource(a,b?b.isAutoLaunch:!1,b?b.chromeAppOptions:null)},function(){CTXS.setLaunchStatus(a,CTXS.LAUNCH_FAILURE)})},launchViaIcaUrl:function(a,b,c){return!1},removeApp:function(a,b){CTXS.Environment.performUnsubscribe(a,function(c){c==CTXS.SUBSCRIPTION_SUCCESS?CTXS.Environment.uninstallApp(a,b):b(c)})},
uninstallApp:function(a,b){b(CTXS.SUBSCRIPTION_SUCCESS)},sendHttpRequest:function(a){return c.ajax(a)},loadScript:function(a,b){return c.ctxsAjax({dataType:"script",url:a,complete:b})},getUserDisplayName:function(a){CTXS.trace("CTXS.Environment.getUserDisplayName: requesting user display name from server");var b=CTXS.Config.getConfigValue("authManager.getUsernameURL");b&&CTXS.AuthClient.getUsername(CTXS.primaryStore.baseUrl+b,a)},showSettings:function(){},showStoreMenu:c.noop,showAboutBox:function(a,
b,c){CTXS.UI.useSmallTiles()?CTXS.Events.publish(CTXS.Events.ui.showPhoneAbout):(c.ctxsCenter(),a=c.find("#html5ThirdPartyNoticesBtn"),CTXS.displayHTML5ThirdPartyNoticesLink(a),CTXS.displayPopup(b,c))},showDialog:function(a){CTXS.Events.publish(CTXS.Events.ui.showMessage,a)},setPNASubscriptionStatus:function(a,b){a.subscriptionstatus=b;if(CTXS.Environment.localStorageSetItem)try{CTXS.Environment.localStorageSetItem("sub-"+a.id,a.subscriptionstatus)}catch(c){CTXS.trace("Local storage exception "+c)}},
getPNASubscriptionStatus:function(a){if(CTXS.Environment.localStorageGetItem)try{CTXS.Environment.localStorageGetItem("sub-"+a.id,function(b){b&&(a.subscriptionstatus=b)})}catch(b){CTXS.trace("Local storage exception "+b)}},pnaRequest:null,goOnline:function(a,b){b()},getInstalledApps:function(a,b){b()},notifyWebUILoading:function(){},getStoreDetails:function(a){a()},notifyWebUIReady:function(){},notifyRefreshStart:function(){},notifyRefreshDone:function(a,b,c){c(!0)},localStorageGetItem:null,localStorageSetItem:null,
loadAppIcon:function(a,b){if("PNA"==a.store.type)CTXS.PNAClient.requestImages(a,b);else c('<img src="'+a.iconurl+'"></img>').one("load",function(){b(a)})},isGatewaySession:function(){return CTXS.AccessGateway.isGatewaySession()},enableAnimations:!0,enableAppUpdates:!1,enableOffline:!1,openUrl:function(a){window.open(a,"_blank")},writeTraceMessage:function(a,b,c,d){CTXS.writeTraceMessage(a,b,c,d)},getPreferredLanguages:function(){return CTXS.Config.getConfigValue("session.userLanguages")},recolorImage:function(a,
b,c,d){var e=new Image;e.onload=function(){CTXS.updateSpriteColor(this,b,c,d)};e.src=a},useExtendedResourceDetails:!1,logOff:function(){CTXS.Events.publish(CTXS.Events.ui.logoffRequested)},updateOfflineCache:function(a){CTXS.Environment.enableOffline&&CTXS.NativeHelper.saveModifiedAppListFromStore(a)},requestWebStoreRefresh:function(){window.location.reload()},requestShowMyAppsView:function(){},getLanguagePreference:null});try{"localStorage"in window&&null!=window.localStorage&&(CTXS.Environment.localStorageGetItem=
function(a,b){var c;try{c=window.localStorage.getItem(a)}catch(d){CTXS.trace("Local Storage Exception reading "+a),c=null}b&&b(c)},CTXS.Environment.localStorageSetItem=function(a,b,c){try{window.localStorage.setItem(a,b)}catch(d){CTXS.trace("Local storage Exception writing "+a)}c&&c()})}catch(k){}})(jQuery);
(function(c){function f(a,b){CTXS.trace("Raw capabilties:"+a);try{CTXS.NativeCapabilities=JSON.parse(a)}catch(c){CTXS.trace("Failed to parse OS capabilities:"+c)}CTXS.NativeCapabilities.enableOffline&&(CTXS.Environment.enableOffline=!0);CTXS.ExtensionsHead.noteNativeClient(CTXS.NativeCapabilities);CTXS.NativeHelper.handlePatch(CTXS.NativeCapabilities.patch)&&CTXS.wrapExceptions({fn:b,debug:"processCaps"})}function b(a){if(CTXS.Environment.hasNativeFunction("postSubscriptionChange")){var b=CTXS.NativeHelper.toNativeId(a);
this.callNativeContainer("postSubscriptionChange",b,a.status,a.position)}}function a(a,b,c){b=b.split(";");for(var d=[],e=0;e<b.length;e++){var f=b[e];f?d.push(CTXS.NativeHelper.toWebId(f)):d.push(null)}for(var e=CTXS.Store.getAllApps(),f=CTXS.Store.getDesktops(),h=0;2>h;h++)for(var k=0==h?e:f,s=0;s<k.length;s++){var r=k[s];if(r.store==a){for(var E=!1,A=0;A<b.length;A++)if(r.id==b[A]||r.id==d[A]){E=!r.installed;r.installed=!0;E&&CTXS.Events.publish(CTXS.Events.store.appStatusChange,r);E=!0;break}E||
(E=r.installed||c&&r.subscriptionstatus!=CTXS.SUBSCRIPTION_STATUS.NOTSUBSCRIBED,r.installed=!1,c&&(r.subscriptionstatus=CTXS.SUBSCRIPTION_STATUS.NOTSUBSCRIBED),E&&CTXS.Events.publish(CTXS.Events.store.appStatusChange,r))}}}if(CTXS.Device.isNativeClient()){CTXS.trace("Initializing base native environment");CTXS.WebCapabilities=CTXS.WebCapabilities||{};CTXS.WebCapabilities.version="1.1";CTXS.WebCapabilities.menuItems=["about","refresh","preferences","logoff"];var d=CTXS.Environment;CTXS.Environment=
c.extend({},d,{_messagesForNativeContainer:[],_$iframe:null,_messagecounter:0,NATIVESEP:String.fromCharCode(1),bridge:{sync_getCapabilities:function(a){return window.external.sync_getCapabilities(a)},sync_getFileUri:function(a){return window.external.sync_getFileUri(a)},sync_setPNASubscriptionStatus:function(a,b){return window.external.sync_setPNASubscriptionStatus(a,b)},sync_getPNASubscriptionStatus:function(a){return window.external.sync_getPNASubscriptionStatus(a)},sync_getItem:function(a){return window.external.sync_getItem(a)},
sync_setItem:function(a,b){return window.external.sync_setItem(a,b)},sync_refreshDone:function(a,b){return window.external.sync_RefreshDone(a,b)},getCapabilities:function(a,b){window.external.getCapabilities(a,b)},noteRefreshDone:function(a,b){window.external.noteRefreshDone(a,b)},refreshDone:function(a,b,c){window.external.refreshDone(a,b,c)},getStoreDetails:function(a){window.external.getStoreDetails(a)},ajax:function(a,b,c,d,e,f){window.external.ajax(a,b,c,d,e,f)},settingsMenu:function(a,b,c,d){window.external.settingsMenu(a,
b,c,d)},settingsMenu2:function(a,b,c,d,e,f){window.external.settingsMenu2(a,b,c,d,e,f)},storeMenu:function(a,b,c,d){window.external.storeMenu(a,b,c,d)},aboutBox:function(a,b,c,d){window.external.aboutBox(a,b,c,d)},errorDialog:function(a,b,c,d,e){window.external.errorDialog(a,b,c,d,e)},subscribe:function(a,b){window.external.subscribe(a,b)},unsubscribe:function(a,b){window.external.unsubscribe(a,b)},updatePosition:function(a,b,c){window.external.updatePosition(a,b,c)},updateSubscriptionProperties:function(a,
b,c){window.external.updateSubscriptionProperties(a,b,c)},uninstallApp:function(a,b){window.external.uninstallApp(a,b)},installApp:function(a,b){window.external.installApp(a,b)},removeApp:function(a,b){window.external.removeApp(a,b)},launchApp:function(a,b){window.external.launchApp(a,b)},getFileUri:function(a,b){window.external.getFileUri(a,b)},setPNASubscriptionStatus:function(a,b,c){window.external.setPNASubscriptionStatus(a,b,c)},getPNASubscriptionStatus:function(a,b){window.external.getPNASubscriptionStatus(a,
b)},pnaRequest:function(a,b,c,d,e){window.external.pnaRequest(a,b,c,d,e)},pnaSimpleRequest:function(a,b,c,d){window.external.pnaSimpleRequest(a,b,c,d)},goOnline:function(a,b){window.external.goOnline(a,b)},getInstalledApps:function(a,b){window.external.getInstalledApps(a,b)},getInstalledApps2:function(a,b,c){window.external.getInstalledApps(a,b,c)},getItem:function(a,b){window.external.getItem(a,b)},setItem:function(a,b,c){window.external.setItem(a,b,c)},openUrl:function(a){window.external.openUrl(a)},
recolorImage:function(a,b,c,d,e,f){window.external.recolorImage(a,b,c,d,e,f)},writeTraceMessage:function(a,b,c,d){window.external.writeTraceMessage(a,b,c,d)},loading:function(){window.external.loading()},ready:function(){window.external.ready()},noteRefreshStart:function(){window.external.noteRefreshStart()},sync_getUserDisplayName:function(){return window.external.sync_getUserDisplayName()},getUserDisplayName:function(a){window.external.getUserDisplayName(a)},postSubscriptionChange:function(a,b,
c){window.external.postSubscriptionChange(a,b,c)},loadAppIcon:function(a,b,c){window.external.loadAppIcon(a,b,c)},logOff:function(){window.external.logOff()},launchViaIcaUrl:function(a,b){window.external.launchViaIcaUrl(a,b)}},WebEnvironment:d,notifyNativeContainerOfPendingMessages:function(a){1==a.length&&(CTXS.trace("*** Notify native container of message(s)"),this._$iframe||(this._$iframe=c('<iframe style="display:none"></iframe>'),c("body").append(this._$iframe)),this._$iframe.attr("src","fromjs://biff?"+
this._messagecounter++))},callNativeContainer:function(a,b){for(var c=[],d=1,e=arguments.length;d<e;d++)c.push(arguments[d]);if(this.bridge)this.bridge[a]&&("writeTraceMessage"!=a&&CTXS.trace("*** call native ext:"+a),this.bridge[a].apply(this.bridge,c));else{"writeTraceMessage"!=a&&CTXS.trace("*** call native indirect:"+a);d=a+this.NATIVESEP;for(e=0;e<c.length;e++)d+=(null==c[e]?"":c[e].toString())+this.NATIVESEP;this._messagesForNativeContainer.push(d);this.notifyNativeContainerOfPendingMessages(this._messagesForNativeContainer)}},
hasNativeFunction:function(a){return null!=CTXS.NativeCapabilities&&null!=CTXS.NativeCapabilities.functions&&-1!=c.inArray(a,CTXS.NativeCapabilities.functions)},initialize:function(a){var b=this;d.initialize(function(){var c=JSON.stringify(CTXS.WebCapabilities);if(b.useSyncInitialize)c=CTXS.Environment.bridge.sync_getCapabilities(c),f(c,a);else{var d=CTXS.NativeHelper.storeCallback(a);b.callNativeContainer("getCapabilities",c,d)}})},notifyWebUILoading:function(){CTXS.Environment.hasNativeFunction("loading")&&
this.callNativeContainer("loading")},notifyWebUIReady:function(){CTXS.Environment.hasNativeFunction("ready")&&this.callNativeContainer("ready")},notifyRefreshStart:function(){CTXS.Environment.hasNativeFunction("noteRefreshStart")&&this.callNativeContainer("noteRefreshStart")},notifyRefreshDone:function(a,b,c){CTXS.Environment.hasNativeFunction("sync_refreshDone")?(a=this.callNativeContainer("sync_refreshDone",a,b),c(a)):CTXS.Environment.hasNativeFunction("refreshDone")?(c=CTXS.NativeHelper.storeCallback(c),
this.callNativeContainer("refreshDone",a,b,c)):CTXS.Environment.hasNativeFunction("noteRefreshDone")?(this.callNativeContainer("noteRefreshDone",a,b),c(!0)):d.notifyRefreshDone(a,b,c)},canLaunchResource:function(a){return d.canLaunchResource(a)||a.ismobileapp},getStoreDetails:function(a){CTXS.Environment.hasNativeFunction("getStoreDetails")?(a=CTXS.NativeHelper.storeCallback(a),this.callNativeContainer("getStoreDetails",a)):d.getStoreDetails(a)},sendHttpRequest:function(a){if(CTXS.Environment.hasNativeFunction("ajax")){var b=
CTXS.NativeHelper.storeCallback(a),c=a.data;null==c||"undefined"===typeof a.data||""===a.data?c="":"string"!=typeof c&&(c=jQuery.param(c,a.traditional));var e=null,f;if(a.headers)for(f in a.headers)e=null==e?f+":"+a.headers[f]:e+"\n"+f+":"+a.headers[f];a.type=a.type||"GET";this.callNativeContainer("ajax",a.type,a.url,e,c,a.savedFileKey,b)}else d.sendHttpRequest(a)},loadScript:function(a,b){var d=c.Deferred(),e=function(){b&&b();d.resolve()},f=document.createElement("script");f.type="text/javascript";
f.async=!0;f.addEventListener?f.addEventListener("load",e):f.readyState&&(f.onreadystatechange=function(){"complete"!=f.readyState&&"loaded"!=f.readyState||e()});f.src=a;document.body.appendChild(f);return d.promise()},showSettings:function(a,b,e,f){if(CTXS.Environment.hasNativeFunction("settingsMenu2")){var h=document.documentElement.scrollLeft;h&&(a-=h,e-=h);this.callNativeContainer("settingsMenu2",a,b,e,f,c(window).width(),c(window).height())}else if(CTXS.Environment.hasNativeFunction("settingsMenu")){if(h=
document.documentElement.scrollLeft)a-=h,e-=h;this.callNativeContainer("settingsMenu",a,b,e,f)}else d.showSettings(a,b,e,f)},showStoreMenu:function(a,b,c,d){CTXS.Environment.hasNativeFunction("storeMenu")&&this.callNativeContainer("storeMenu",a,b,c,d)},showAboutBox:function(a,b,c){if(CTXS.Environment.hasNativeFunction("aboutBox")){var e=a.offset();b=e.left;c=e.top;var f=e.left+a.outerWidth();a=e.top+a.outerHeight();this.callNativeContainer("aboutBox",b,c,f,a)}else d.showAboutBox(a,b,c)},showDialog:function(a){if(!a.buttonLabel&&
!a.cancelButtonAction&&CTXS.Environment.hasNativeFunction("errorDialog")&&CTXS.ExtensionsHead.useNativeMessageBox(a.id||a.messageTitle||a.messageText)){var b=a.resource?CTXS.NativeHelper.toNativeId(a.resource):"",c=CTXS.NativeHelper.storeCallback(a);this.callNativeContainer("errorDialog",a.messageText,a.messageTitle,a.id,b,c)}else d.showDialog(a)},recolorImage:function(a,b,c,e){CTXS.Environment.hasNativeFunction("recolorImage")?this.callNativeContainer("recolorImage",a,b[0],b[1],b[2],e,c):d.recolorImage(a,
b,c,e)},performSubscribe:function(a,c){if(CTXS.Environment.hasNativeFunction("subscribe")){var e=CTXS.NativeHelper.storeCallback({resource:a,callback:c}),f=CTXS.NativeHelper.toNativeId(a);this.callNativeContainer("subscribe",f,e)}else d.performSubscribe(a,function(d){b(a);c&&c(d)})},performUnsubscribe:function(a,c){if(CTXS.Environment.hasNativeFunction("unsubscribe")){var e=CTXS.NativeHelper.storeCallback({resource:a,callback:c}),f=CTXS.NativeHelper.toNativeId(a);this.callNativeContainer("unsubscribe",
f,e)}else d.performUnsubscribe(a,function(d){b(a);c&&c(d)})},performUpdatePosition:function(a,c){if(CTXS.Environment.hasNativeFunction("updatePosition")){var e=CTXS.NativeHelper.storeCallback(c),f=CTXS.NativeHelper.toNativeId(a);this.callNativeContainer("updatePosition",f,f.position,e)}else d.performUpdatePosition(a,function(d){b(a);c&&c(d)})},updateSubscriptionProperties:function(a,b){if(CTXS.Environment.hasNativeFunction("updateSubscriptionProperties")){var c=CTXS.NativeHelper.toNativeId(a),e=CTXS.NativeHelper.storeCallback(b),
f="";if(a.subscriptionproperties)for(var h in a.subscriptionproperties)f=f+h+"="+a.subscriptionproperties[h]+"\n";a.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED&&a.position&&(f=f+"dazzle:position:"+a.position+"\nposition:"+a.position+"\n");this.callNativeContainer("updateSubscriptionProperties",c,f,e)}else d.updateSubscriptionProperties(a,b)},installApp:function(a,b){if(CTXS.Environment.hasNativeFunction("installApp")){var c=CTXS.NativeHelper.toNativeId(a),e=CTXS.NativeHelper.storeCallback(b);
this.callNativeContainer("installApp",c,e)}else d.installApp(a,b)},uninstallApp:function(a,b){if(CTXS.Environment.hasNativeFunction("uninstallApp")){var c=CTXS.NativeHelper.toNativeId(a),e=CTXS.NativeHelper.storeCallback(b);this.callNativeContainer("uninstallApp",c,e)}else d.uninstallApp(a,b)},removeApp:function(a,b){if(CTXS.Environment.hasNativeFunction("removeApp")){var c=CTXS.NativeHelper.toNativeId(a),e=CTXS.NativeHelper.storeCallback(b);this.callNativeContainer("removeApp",c,e)}else d.removeApp(a,
b)},launchApp:function(a){if(CTXS.Environment.hasNativeFunction("launchApp")){var b=CTXS.NativeHelper.storeCallback(a),c=CTXS.NativeHelper.toNativeId(a);CTXS.Events.publish(CTXS.Events.resources.launchStatus,{status:CTXS.LAUNCH_STARTING,res:a});this.callNativeContainer("launchApp",c,b)}else d.launchApp(a)},launchViaIcaUrl:function(a,b,c){return CTXS.Environment.hasNativeFunction("launchViaIcaUrl")?(a=CTXS.NativeHelper.storeCallback({resource:a,callback:c}),this.callNativeContainer("launchViaIcaUrl",
b,a),!0):d.launchViaIcaUrl(a,b,c)},getUserDisplayName:function(a){if(CTXS.Environment.hasNativeFunction("sync_getUserDisplayName")){var b=CTXS.Environment.bridge.sync_getUserDisplayName();a(b)}else if(CTXS.Environment.hasNativeFunction("getUserDisplayName"))a=CTXS.NativeHelper.storeCallback(a),this.callNativeContainer("getUserDisplayName",a);else if(!CTXS.primaryStore.workOffline)return d.getUserDisplayName(a)},getFileUri:function(a,b){if(CTXS.Environment.hasNativeFunction("sync_getFileUri")){var c=
CTXS.Environment.bridge.sync_getFileUri(a);b(c)}else c=CTXS.NativeHelper.storeCallback(b),this.callNativeContainer("getFileUri",a,c)},loadAppIcon:function(a,b){if("PNA"==a.store.type)CTXS.PNAClient.requestImages(a,b);else if(CTXS.Environment.hasNativeFunction("loadAppIcon")){var e=CTXS.NativeHelper.toNativeId(a),f=CTXS.NativeHelper.storeCallback({resource:a,callback:b});this.callNativeContainer("loadAppIcon",e,a.iconid,f)}else CTXS.Environment.hasNativeFunction("getFileUri")||CTXS.Environment.hasNativeFunction("sync_getFileUri")?
CTXS.Environment.getFileUri(a.iconid,function(d){d?(a.iconurl=d,CTXS.wrapExceptions({fn:b,args:[a],debug:"getfileuri"})):CTXS.Environment.goOnline(a.store,function(){CTXS.trace("Requesting app icon for "+a.encodedName+" from "+a.iconurl);c.ctxsAjax({type:"GET",url:a.iconurl,data:null,suppressEvents:!0,success:function(c){a.iconurl=c;b(a)},error:function(){CTXS.trace('Failed to load app icon for "'+a.encodedName+'" from '+a.iconurl)},refreshSession:!1,savedFileKey:a.iconid})})}):d.loadAppIcon(a,b)},
setPNASubscriptionStatus:function(a,b){if(CTXS.Environment.hasNativeFunction("sync_setPNASubscriptionStatus")){var c=CTXS.NativeHelper.toNativeId(a);a.status=CTXS.Environment.bridge.sync_setPNASubscriptionStatus(c,b)}else if(CTXS.Environment.hasNativeFunction("setPNASubscriptionStatus")){var c=CTXS.NativeHelper.toNativeId(a),e=CTXS.NativeHelper.storeCallback(a);this.callNativeContainer("setPNASubscriptionStatus",c,b,e)}else d.setPNASubscriptionStatus(a,b)},getPNASubscriptionStatus:function(a){if(CTXS.Environment.hasNativeFunction("sync_getPNASubscriptionStatus")){var b=
CTXS.NativeHelper.toNativeId(a);if(b=CTXS.Environment.bridge.sync_getPNASubscriptionStatus(b))a.status=b}else CTXS.Environment.hasNativeFunction("getPNASubscriptionStatus")?(b=CTXS.NativeHelper.toNativeId(a),a=CTXS.NativeHelper.storeCallback(a),this.callNativeContainer("getPNASubscriptionStatus",b,a)):d.getPNASubscriptionStatus(a)},pnaRequest:function(a,b,c,e,f,h){if(CTXS.Environment.hasNativeFunction("pnaRequest"))f=CTXS.NativeHelper.storeCallback({success:f,failure:h}),this.callNativeContainer("pnaRequest",
a.id,b,c,e,f);else if(CTXS.Environment.hasNativeFunction("pnaSimpleRequest")){if("enum"==b)a=a.Request.Enumeration.Location.Data;else if("launch"==b)a=a.Request.Launch.Location.Data;else if("reconnect"==b)a=a.Request.Reconnect.Location.Data;else throw"Bad PNA request type";b=CTXS.NativeHelper.storeCallback({success:f,failure:h});this.callNativeContainer("pnaSimpleRequest",a,c,e,b)}else d.pnaRequest(a,b,c,e,f,h)},goOnline:function(a,b,c){CTXS.Environment.hasNativeFunction("goOnline")?a.workOffline?
(c&&(a.goOnlineFailureCallbacks||(a.goOnlineFailureCallbacks=[]),a.goOnlineFailureCallbacks.push(c)),a.goOnlineCallbacks?(CTXS.trace("--- remember additional goOnline callback for "+a.id),a.goOnlineCallbacks.push(b)):(CTXS.trace("--- go online for store "+a.id),a.goOnlineCallbacks=[],a.goOnlineCallbacks.push(b),b=CTXS.NativeHelper.storeCallback(a),this.callNativeContainer("goOnline",a.id,b))):b():d.goOnline(a,b,c)},getInstalledApps:function(a,b){if(CTXS.Environment.hasNativeFunction("getInstalledApps2")){for(var c=
"",e=0;2>e;e++)for(var f=0==e?CTXS.Store.getAllApps():CTXS.Store.getDesktops(),h=0;h<f.length;h++)f[h].store!=a||f[h].subscriptionstatus!=CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED&&!f[h].mandatory||(""!=c&&(c+=";"),c+=CTXS.NativeHelper.toNativeId(f[h].id));e=CTXS.NativeHelper.storeCallback({callback:b,store:a,list:c});this.callNativeContainer("getInstalledApps2",a.id,c,e)}else CTXS.Environment.hasNativeFunction("getInstalledApps")?(c=CTXS.NativeHelper.storeCallback({callback:b,store:a}),this.callNativeContainer("getInstalledApps",
a.id,c)):d.getInstalledApps(a,b)},localStorageGetItem:function(a,b){if(CTXS.Environment.hasNativeFunction("sync_getItem")){var c=CTXS.Environment.bridge.sync_getItem(a);b&&CTXS.wrapExceptions({fn:b,args:[c],debug:"sync_getItem"})}else CTXS.Environment.hasNativeFunction("getItem")?(c=CTXS.NativeHelper.storeCallback(b),this.callNativeContainer("getItem",a,c)):d.localStorageGetItem(a,b)},localStorageSetItem:function(a,b,c){CTXS.Environment.hasNativeFunction("sync_setItem")?(this.callNativeContainer("sync_setItem",
a,b),c&&c()):CTXS.Environment.hasNativeFunction("setItem")?(c=CTXS.NativeHelper.storeCallback(c),this.callNativeContainer("setItem",a,b,c)):d.localStorageSetItem(a,b,c)},openUrl:function(a){CTXS.Environment.hasNativeFunction("openUrl")?this.callNativeContainer("openUrl",a):d.openUrl(a)},writeTraceMessage:function(a,b,c,e){CTXS.Environment.hasNativeFunction("writeTraceMessage")?this.callNativeContainer("writeTraceMessage",a,b,c,e):d.writeTraceMessage(a,b,c,e)},getPreferredLanguages:function(){var a=
d.getPreferredLanguages();CTXS.NativeCapabilities&&c.isArray(CTXS.NativeCapabilities.preferredLanguages)&&(a=CTXS.NativeCapabilities.preferredLanguages.join(","));return a},logOff:function(){CTXS.Environment.hasNativeFunction("logOff")?this.callNativeContainer("logOff"):d.logOff()}});window.ctxs_getNativeMessage=function(){var a=CTXS.Environment._messagesForNativeContainer,b;0==a.length?b="":(b=a[0],a.splice(0,1));CTXS.trace("*** Native client requested message. Send l="+a.length+" m="+b);return a.length+
CTXS.Environment.NATIVESEP+b};window.ctxs_ajax_complete=function(a,b,d,e,f){var h=null,k={};e=window.ctxs_retrieveChunkedData(e);try{h=CTXS.NativeHelper.retrieveCallback(a);if(!h)return;CTXS.trace("headers:"+f);if(f&&-1!=f.indexOf(CTXS.CHALLENGE_HEADER))if(h.store||(CTXS.trace("AJAX failed due to bad/missing cookie - no store info- assume primary "),h.store=CTXS.primaryStore),h.triedGoOnline)CTXS.trace("AJAX failed due to bad/missing cookie - already tried going online - fall through");else{CTXS.trace("AJAX failed due to bad/missing cookie - go online and retry");
h.triedGoOnline=!0;h.store.workOffline=!0;CTXS.Environment.goOnline(h.store,function(){CTXS.Environment.sendHttpRequest(h)},function(){h.complete({},"error")});return}"xml"==h.dataType&&(k.responseXML=c.parseXML(e));k.responseText=e;k.status=d;k.rawheaders=f;k.getResponseHeader=function(a){if(null!=this.rawheaders){null==this.headers&&(this.headers=this.rawheaders.split("\n"));a+=":";for(var b=0;b<this.headers.length;b++)if(this.headers[b].substring(0,a.length)==a)return this.headers[b].substring(a.length)}return null}}catch(y){CTXS.trace("Error processing ajax from call to "+
(null==h?a:h.url));CTXS.trace("Exception "+y);CTXS.trace("URL: "+(null==h?a:h.url));CTXS.trace(y.stack);return}try{h.complete(k,b)}catch(s){CTXS.trace("Error processing ajax complete"),CTXS.trace("Exception "+s),CTXS.trace("URL: "+h.url),CTXS.trace(s.stack)}};window.ctxs_goOnline_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);if(c)if(b==CTXS.SUCCESS){c.workOffline=!1;c==CTXS.primaryStore&&(CTXS.UserInfo.getName()||CTXS.Store.loadUserDisplayName());for(var d=0;d<c.goOnlineCallbacks.length;d++)CTXS.wrapExceptions({fn:c.goOnlineCallbacks[d],
debug:"goOnline_"+d});delete c.goOnlineCallbacks;delete c.goOnlineFailureCallbacks}else{CTXS.trace("got non-success callback from goOnline "+b);if(c.goOnlineFailureCallbacks){for(d=0;d<c.goOnlineCallbacks.length;d++)CTXS.wrapExceptions({fn:c.goOnlineFailureCallbacks[d],args:[b],debug:"goOnlineFailed_"+d});delete c.goOnlineFailureCallbacks}delete c.goOnlineCallbacks}};window.ctxs_installApp_complete=function(a,b){b||(b=CTXS.FAILURE);var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,
args:[b],debug:"installApp"})};window.ctxs_uninstallApp_complete=function(a,b){b=b==CTXS.SUCCESS?CTXS.SUBSCRIPTION_SUCCESS:b==CTXS.SILENTFAILURE?CTXS.SUBSCRIPTION_SILENTFAILURE:CTXS.SUBSCRIPTION_FAILURE;var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"uninstallApp"})};window.ctxs_removeApp_complete=function(a,b){b=b==CTXS.SUCCESS?CTXS.SUBSCRIPTION_SUCCESS:b==CTXS.SILENTFAILURE?CTXS.SUBSCRIPTION_SILENTFAILURE:CTXS.SUBSCRIPTION_FAILURE;var c=CTXS.NativeHelper.retrieveCallback(a);
c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"removeApp"})};window.ctxs_refreshDone_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"refreshDone"})};window.ctxs_getItem_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"lsGet"})};window.ctxs_setItem_complete=function(a){(a=CTXS.NativeHelper.retrieveCallback(a))&&CTXS.wrapExceptions({fn:a,debug:"lsSet"})};window.ctxs_launchApp_complete=
function(a,b){CTXS.trace("ctxs_launchApp_complete called id="+a+" state="+b);var c=CTXS.NativeHelper.retrieveCallback(a);null==c?CTXS.trace("did not find launch callback record - abort"):"fallback"==b?d.launchApp(c):CTXS.Events.publish(CTXS.Events.resources.launchStatus,{status:"failed"==b?CTXS.LAUNCH_FAILURE:CTXS.LAUNCH_SUCCESS,res:c})};window.ctxs_launchViaIcaUrl_complete=function(a,b,c){(a=CTXS.NativeHelper.retrieveCallback(a))&&CTXS.wrapExceptions({fn:a.callback,args:[a,a.resource,b,c],debug:"icaurl"})};
window.ctxs_errorDialog_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&("fallback"==b?d.showDialog(c):c.buttonAction&&c.buttonAction())};window.ctxs_recolorImage_complete=function(a,b){c("<style>{0}</style>".format(a+" { background-image: url('"+b+"'); }")).appendTo("head")};window.ctxs_unsubscribe_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);if(null==c)CTXS.trace("did not find callback record - abort");else{var d;"pending"==b?d=CTXS.SUBSCRIPTION_PENDING:
"subscribed"==b?d=CTXS.SUBSCRIPTION_FAILURE:"failure"==b?(d=CTXS.SUBSCRIPTION_FAILURE,b=null):"silentfailure"==b?(d=CTXS.SUBSCRIPTION_SILENTFAILURE,b=null):d=CTXS.SUBSCRIPTION_SUCCESS;c.resource.subscriptionstatus=b||c.resource.subscriptionstatus;c.callback&&CTXS.wrapExceptions({fn:c.callback,self:c,args:[d],debug:"unsub"})}};window.ctxs_subscribe_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);if(null==c)CTXS.trace("did not find callback record - abort");else{var d;"pending"==
b?d=CTXS.SUBSCRIPTION_PENDING:"unsubscribed"==b?d=CTXS.SUBSCRIPTION_FAILURE:"failure"==b?(d=CTXS.SUBSCRIPTION_FAILURE,b=null):"silentfailure"==b?(d=CTXS.SUBSCRIPTION_SILENTFAILURE,b=null):d=CTXS.SUBSCRIPTION_SUCCESS;c.resource.subscriptionstatus=b||c.resource.subscriptionstatus;c.callback&&CTXS.wrapExceptions({fn:c.callback,self:c,args:[d],debug:"sub"})}};window.ctxs_performUpdatePosition_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&(b="success"==b?CTXS.SUBSCRIPTION_SUCCESS:
"failure"==b?CTXS.SUBSCRIPTION_FAILURE:CTXS.SUBSCRIPTION_SILENTFAILURE,CTXS.wrapExceptions({fn:c,self:this,args:[b],debug:"updatePostition"}))};window.ctxs_updateSubscriptionProperties_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"updateSubscriptionProperties"})};window.ctxs_getInstalledApps_complete=function(b,c,d){CTXS.trace("ctxs_getInstalledApps_complete called applist="+c);if(b=CTXS.NativeHelper.retrieveCallback(b))a(b.store,c,
d),b.callback&&CTXS.wrapExceptions({fn:b.callback,self:b,debug:"installedApps"})};window.ctxs_getInstalledApps2_complete=function(b,c,d,e){CTXS.trace("ctxs_getInstalledApps2_complete called chnanges="+c+" applist="+d);if(b=CTXS.NativeHelper.retrieveCallback(b))(c="true"==String(c).toLowerCase())&&d!=b.list&&a(b.store,d,e),b.callback&&CTXS.wrapExceptions({fn:b.callback,self:b,debug:"installedApps2"})};window.ctxs_pnaRequest_complete=function(a,b,d){CTXS.trace("ctxs_pnaRequestDone called");a=CTXS.NativeHelper.retrieveCallback(a);
null==a?CTXS.trace("did not find callback record - abort"):b==CTXS.SUCCESS?(d=c.parseXML(d),CTXS.wrapExceptions({fn:a.success,self:a,args:d,debug:"pna"})):CTXS.wrapExceptions({fn:a.failure,self:a,debug:"pnaF"})};window.ctxs_getCapabilities_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&f(b,c)};window.ctxs_getFileUri_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"getFile"})};window.ctxs_getUserDisplayName_complete=
function(a,b){CTXS.trace("CTXS.Environment.getUserDisplayName [native]: Received display name: "+b);var c=CTXS.NativeHelper.retrieveCallback(a);c&&CTXS.wrapExceptions({fn:c,args:[b],debug:"getUserDisplayName"})};window.ctxs_setPNASubscriptionStatus_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&(c.status=b)};window.ctxs_getPNASubscriptionStatus_complete=function(a,b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&b&&(c.status=b)};window.ctxs_loadAppIcon_complete=function(a,
b){var c=CTXS.NativeHelper.retrieveCallback(a);c&&(c.resource.iconurl=b,CTXS.wrapExceptions({fn:c.callback,debug:"loadappicon"}))};window.ctxs_getStoreDetails_complete=function(a,b,c,d){CTXS.trace("Primary Store id="+b);CTXS.primaryStore=CTXS.primaryStore||CTXS.Config;CTXS.primaryStore.id=b;CTXS.primaryStore.baseUrl=c;CTXS.primaryStore.workOffline=d;CTXS.ExtensionsHead.noteNativeStore(CTXS.primaryStore);(a=CTXS.NativeHelper.retrieveCallback(a))&&CTXS.wrapExceptions({fn:a,debug:"getSD"})};window.ctxs_getStoreDetails_addSecondaryStore=
function(a,b,c,d){CTXS.trace("AddSecondaryStore("+a+","+b+","+c+")");var e={};e.id=a;e.baseUrl=b;e.type=c;e.workOffline=d;CTXS.Config.addSecondaryStore(a,e);CTXS.ExtensionsHead.noteNativeStore(e)};window.ctxs_async_giveFocus=function(){var a=document.activeElement;a&&window.setTimeout(function(){a.focus()},100)};window.ctxs_async_setUserName=function(a,b){CTXS.trace("ctxs_async_setUserName: Received display name: "+a);CTXS.Store.setUserDisplayName(a)};window.ctxs_async_setInstallProgress=function(a,
b){for(var c=CTXS.NativeHelper.toStoreId(a),d=CTXS.NativeHelper.toWebId(a),e=!1,f,h,k=0;2>k;k++){var s=0==k?CTXS.Store.getAllApps():CTXS.Store.getDesktops();for(f=0;f<s.length;f++)if(h=s[f],h.id==d&&(h.store.id==c||!h.store.id)){h.installProgress=b;e=!0;CTXS.Events.publish(CTXS.Events.store.appStatusChange,h);break}}e||CTXS.trace("app not found "+a)};window.ctxs_async_refresh=function(){CTXS.Environment.refresh()};window.ctxs_async_noteLogoff=function(a){};var e={},k=0;window.ctxs_sendChunkedData=
function(a,b){a?e[a]+=b:(a="CHUNK"+k++,e[a]=b);return a};window.ctxs_retrieveChunkedData=function(a){var b=e[a];return b?(delete e[a],b):a};var h=CTXS.getUrlParam("bridge");null!=h&&(CTXS.Environment.bridge=window[h]);h=CTXS.getUrlParam("notify");"url"==h&&(CTXS.Environment.bridge=null);"title"==h&&(CTXS.Environment.bridge=null,CTXS.Environment.notifyNativeContainerOfPendingMessages=function(a){1==a.length&&(CTXS.trace("*** Notify native container of message(s) (title)"),document.title="biff="+this._messagecounter++)});
"hash"==h&&(CTXS.Environment.bridge=null,CTXS.Environment.notifyNativeContainerOfPendingMessages=function(a){if(1==a.length){CTXS.trace("*** Notify native container of message(s) (hash)");a=window.location.hash||"";var b=a.indexOf("&biff=");-1!=b&&(a=a.substring(0,b));window.location.hash=a+"&biff="+this._messagecounter++}});CTXS.patch_NativeEnvironment=function(a){eval(a)}}})(jQuery);
(function(c){var f=CTXS.getUrlParam("native");if(f&&0==f.indexOf("android")){var b=CTXS.ExtensionsHead.noteNativeClient,a=CTXS.ExtensionsHead.postRedraw;CTXS.ExtensionsHead.noteNativeClient=function(d){d=d||{};d.features=d.features||{};if(!1!=d.features.enableTouchScrollTweak){var e=c(".scrollable.storeViewSection");e.on("scroll",function(){!1!=d.features.enableTouchScrollTweak&&1>e.scrollTop()&&e.scrollTop(1)});CTXS.ExtensionsHead.postRedraw=function(){!1!=d.features.enableTouchScrollTweak&&1>e.scrollTop()&&
e.scrollTop(1);a()}}b(d)};c.extend(CTXS.Environment,{useSyncInitialize:!0,enableAppUpdates:!0,useExtendedResourceDetails:!0,treatAsAdded:function(a){return a.supportsSubscription?a.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED:!0},includeAppInStore:function(a){var b=a.content;return a.ismobileapp?a.isAndroidApp&&!a.isiosApp:a.supportsIcaLaunch||b}})}})(jQuery);
(function(c){if(navigator.userAgent&&0<navigator.userAgent.indexOf("CitrixChromeApp")){var f=CTXS.Environment.getConfiguration;c.extend(CTXS.Environment,{getConfiguration:function(b,a,c){window.addEventListener("message",function(e){"ICA"==e.data?(CTXS.Html5Client.registerChromeApp(e.source,e.origin),CTXS.Html5Client.postHideAccountSettingsToChromeApp(),f(b,a,c)):CTXS.Html5Client.receiveMessageFromChromeApp(e)},!1)}})}})(jQuery);
(function(c){var f=CTXS.getUrlParam("native");f&&0==f.indexOf("ios")&&c.extend(CTXS.Environment,{enableAppUpdates:!0,useExtendedResourceDetails:!0,bridge:null,treatAsAdded:function(b){return b.supportsSubscription?b.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED:!0},includeAppInStore:function(b){var a=b.content;return b.ismobileapp?b.isiosApp&&!b.isAndroidApp:b.supportsIcaLaunch||a}})})(jQuery);
(function(c){var f=CTXS.getUrlParam("native");f&&0==f.indexOf("linux")&&c.extend(CTXS.Environment,{})})(jQuery);(function(c){var f=CTXS.getUrlParam("native");f&&0==f.indexOf("mac")&&c.extend(CTXS.Environment,{})})(jQuery);(function(c){var f=CTXS.getUrlParam("native");f&&0==f.indexOf("winphone")&&c.extend(CTXS.Environment,{enableAppUpdates:!0,treatAsAdded:function(b){return b.supportsStandardInstallation?b.installed:b.supportsSubscription?b.subscriptionstatus==CTXS.SUBSCRIPTION_STATUS.SUBSCRIBED:!0}})})(jQuery);
(function(c){var f=CTXS.getUrlParam("native");f&&0==f.indexOf("windows")&&(CTXS.trace("Initializing Windows native environment"),CTXS.Environment=c.extend(CTXS.Environment,{useSyncInitialize:!0,performSubscribe:function(b,a){if("PNA"==b.store.type){var c=CTXS.NativeHelper.storeCallback({resource:b,callback:a}),e=CTXS.NativeHelper.toNativeId(b);window.external.subscribe(e,c)}else CTXS.Environment.WebEnvironment.performSubscribe(b,a)}}),CTXS.trace("Initializing Windows native environment (done)"))})(jQuery);
(function(c){if(CTXS.isUrlParamDefined("-db")){"fail"==CTXS.getUrlParam("-db")?CTXS.debugReturnCode=CTXS.SUBSCRIPTION_FAILURE:CTXS.debugReturnCode=CTXS.SUBSCRIPTION_SUCCESS;CTXS.trace("Initializing debug environment");var f=!1;try{new window.ActiveXObject("Microsoft.XMLHTTP"),f=!0}catch(b){}c.extend(CTXS.Environment,{configurationUrl:"dummyapps/Configuration.xml",sendHttpRequest:function(a){CTXS.trace("debug environment hooked ajax call");if("undefined"===typeof a.data||""===a.data)a.data={};a.type&&
"POST"!=a.type||(a.type="GET");f&&(c.ajaxSettings.xhr=function(){return new window.ActiveXObject("Microsoft.XMLHTTP")});c.ajax(a)},installApp:function(a){CTXS.Events.publish(CTXS.Events.store.appStatusChange,a)},performSubscribe:function(a,b){CTXS.debugReturnCode==CTXS.SUBSCRIPTION_SUCCESS&&(a.subscriptionstatus="subscribed");b(CTXS.debugReturnCode)},performUnsubscribe:function(a,b){CTXS.debugReturnCode==CTXS.SUBSCRIPTION_SUCCESS&&(a.subscriptionstatus="unsubscribed");b(CTXS.debugReturnCode)},performUpdatePosition:function(a,
b){b(CTXS.debugReturnCode)},getUserDisplayName:function(a){a("User")},launchApp:function(a,b){CTXS.debugReturnCode==CTXS.SUBSCRIPTION_SUCCESS?(alert("Launch "+a.encodedName),CTXS.Events.publish(CTXS.Events.resources.launchStatus,{status:CTXS.LAUNCH_SUCCESS,res:a})):CTXS.Events.publish(CTXS.Events.resources.launchStatus,{status:CTXS.LAUNCH_FAILURE,res:a})}})}})(jQuery);CTXS.trace("ctxs.init.application.js loaded");(function(c){c(function(){CTXS.trace("ctxs.init.application ready()");CTXS.ExtensionsHead.preInitialize(function(){CTXS.Bootstrapper.initialize(function(){CTXS.Controllers.MasterController.initialise()})})})})(jQuery);
CTXS.trace("ctxs.init.application.js loaded (end)");
